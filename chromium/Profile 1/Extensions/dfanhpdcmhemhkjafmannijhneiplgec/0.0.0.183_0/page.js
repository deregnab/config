!function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/",t(t.s=15)}([function(e,t,n){e.exports=n(1)(6)},function(e,t){e.exports=shared},function(e,t,n){e.exports=n(1)(19)},function(e,t,n){e.exports=n(1)(13)},function(e,t,n){e.exports=n(1)(14)},function(e,t,n){e.exports=n(1)(2)},function(e,t,n){e.exports=n(1)(24)},function(e,t,n){e.exports=n(1)(41)},function(e,t,n){e.exports=n(1)(42)},function(e,t,n){e.exports=n(1)(9)},function(e,t,n){e.exports=n(1)(43)},function(e,t,n){e.exports=n(1)(29)},function(e,t,n){e.exports=n(1)(23)},function(e,t,n){e.exports=n(1)(47)},function(e,t,n){e.exports=n(1)(15)},function(e,t,n){n(16),n(0),n(17),n(18),n(19),n(2),n(3),n(4),n(5),n(6),n(7),n(8),n(9),n(10),n(11),n(12),n(20),n(21),n(22),n(13),n(23),n(14),function(e,t){"use strict";function n(){d.addClass(y)}function r(){d.removeClass(y),d.removeClass(b)}function o(){r(),d.addClass(b)}function i(e){return m(e)&&f(e.then)}function a(e){if(!m(e))throw new Error("Bootstrap configuration must be an object.");if(!h(e.module))throw new Error("'config.module' must be a string.");if(e.resolve&&e.moduleResolves)throw new Error("Bootstrap configuration can contain either 'resolve' or 'moduleResolves' but not both");if(e.resolve&&!m(e.resolve))throw new Error("'config.resolve' must be an object.");if(e.bootstrapConfig&&!m(e.bootstrapConfig))throw new Error("'config.bootstrapConfig' must be an object.");if(e.moduleResolves&&!g(e.moduleResolves))throw new Error("'config.moduleResolves' must be an array.");if(v(e.moduleResolves,function(e){if(!e.module)throw new Error("A 'moduleResolve' configuration item must contain a 'module' name.");if(!m(e.resolve))throw new Error("'moduleResolve.resolve' must be an object.")}),angular.isDefined(e.onError)&&!f(e.onError))throw new Error("'config.onError' must be a function.")}function s(e,t){t=angular.element(t),e.unshift(["$provide",function(e){e.value("$rootElement",t)}])}function c(e,t){var n=["ng"];return h(e)?n.push(e):g(e)&&(n=n.concat(e)),s(n,t),angular.injector(n,t)}function u(e,n,o){var i=p.defer();return angular.element(t).ready(function(){angular.bootstrap(e,[n],o),r(),i.resolve(!0)}),i.promise}function l(e){function r(e,t,n){var r;if(w.push({name:t,moduleName:n||b}),!f(e)&&!g(e))throw new Error("Resolve for '"+t+"' is not a valid dependency injection format.");if(r=m.instantiate(e),!i(r))throw new Error("Resolve function for '"+t+"' must return a promise.");C.push(r)}function s(e){return v(e,function(e,t){var n=e&&e.data?e.data:e,r=w[t].moduleName,o=w[t].name;angular.module(r).constant(o,n)}),u(y,b,_)}function l(e){o(),f(h.onError)&&h.onError(e)}var m,h=e||{},y=h.element,b=h.module,k=h.injectorModules||[],C=[],w=[],_=h.bootstrapConfig;return d=angular.element(t.body),n(),a(h),m=c(k,y),p=m.get("$q"),h.moduleResolves?v(h.moduleResolves,function(e,t){v(e.resolve,function(e,n){r(e,n,h.moduleResolves[t].module)})}):v(h.resolve,function(e,t){r(e,t)}),p.all(C).then(s,l)}var d,p,m=angular.isObject,f=angular.isFunction,g=angular.isArray,h=angular.isString,v=angular.forEach,y="deferred-bootstrap-loading",b="deferred-bootstrap-error";e.deferredBootstrapper={bootstrap:l}}(window,document),function(e){var t=function(){function e(e,t){this.treesConfig=e,this.treeProperty=t,this.storage=localStorage,this._zoom=parseFloat(this.storage.getItem("defaultZoom"))||1,this._treeLayout="true"==this.storage.getItem("defaultTreeLayout"),this._treeSort=this.storage.getItem("defaultTreeSort")||"timestamp",this._treesSort=this.storage.getItem("defaultTreesSort")||this.treeProperty[this.treeProperty.modified],this._maxTreeDepth=parseInt(this.storage.getItem("defaultMaxTreeDepth"))||6,this._maxTreeBreadth=parseInt(this.storage.getItem("defaultMaxTreeBreadth"))||4,this._session_disabled="true"==this.storage.getItem("sessionDisabled"),this._hide_pinned="true"==this.storage.getItem("hidePinned"),this._hide_bookmarks="true"==this.storage.getItem("hideBookmarks"),this._hideLastTree="true"==this.storage.getItem("hideLastTree"),this._shareUrlWarningDisabled="true"==this.storage.getItem("shareUrlWarningDisabled"),this._reportGoogleDisabled="true"==this.storage.getItem("reportGoogleDisabled"),this._contentLanguage=this.storage.getItem("contentLanguage"),this._autoplayOff="true"==this.storage.getItem("autoplayOff"),this._announcement1="true"==this.storage.getItem("announcement1")}return Object.defineProperty(e.prototype,"zoom",{get:function(){return this._zoom},set:function(e){this.storage.setItem("defaultZoom",e.toString()),this._zoom=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"treeLayout",{get:function(){return this._treeLayout},set:function(e){this.storage.setItem("defaultTreeLayout",e.toString()),this._treeLayout=e,this.treesConfig.treeCtrl.vertical=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"treeSort",{get:function(){return this._treeSort},set:function(e){this.storage.setItem("defaultTreeSort",e),this._treeSort=e,this.treesConfig.treeCtrl.sortBy=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"treesSort",{get:function(){return this._treesSort},set:function(e){this.storage.setItem("defaultTreesSort",e),this._treesSort=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxTreeDepth",{get:function(){return this._maxTreeDepth},set:function(e){this.storage.setItem("defaultMaxTreeDepth",e.toString()),this._maxTreeDepth=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxTreeBreadth",{get:function(){return this._maxTreeBreadth},set:function(e){this.storage.setItem("defaultMaxTreeBreadth",e.toString()),this._maxTreeBreadth=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sessionDisabled",{get:function(){return this._session_disabled},set:function(e){this.storage.setItem("sessionDisabled",e.toString()),this._session_disabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hidePinned",{get:function(){return this._hide_pinned},set:function(e){this.storage.setItem("hidePinned",e.toString()),this._hide_pinned=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hideBookmarks",{get:function(){return this._hide_bookmarks},set:function(e){this.storage.setItem("hideBookmarks",e.toString()),this._hide_bookmarks=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hideLastTree",{get:function(){return this._hideLastTree},set:function(e){this.storage.setItem("hideLastTree",e.toString()),this._hideLastTree=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shareUrlWarningDisabled",{get:function(){return this._shareUrlWarningDisabled},set:function(e){this.storage.setItem("shareUrlWarningDisabled",e.toString()),this._shareUrlWarningDisabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reportGoogleDisabled",{get:function(){return this._reportGoogleDisabled},set:function(e){this.storage.setItem("reportGoogleDisabled",e.toString()),this._reportGoogleDisabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contentLanguage",{get:function(){return this._contentLanguage},set:function(e){this.storage.setItem("contentLanguage",e),this._contentLanguage=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"autoplayOff",{get:function(){return this._autoplayOff},set:function(e){this.storage.setItem("autoplayOff",e.toString()),this._autoplayOff=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"announcement1",{get:function(){return this._announcement1},set:function(e){this.storage.setItem("announcement1",e.toString()),this._announcement1=e},enumerable:!0,configurable:!0}),e}();e.value("UserSettingsStatic",t),e.value("animationEase","cubic-in-out").value("animationDuration",850),e.value("debug_data",!1).value("debug_mode",!1);var n;!function(e){e[e.str=0]="str",e[e.date=1]="date",e[e.rating=2]="rating",e[e.count=3]="count"}(n||(n={})),e.value("propertyType",n),angular.module("tnConfig").factory("placeholderImage",["$rootScope","trustAsResourceUrlFilter",function(e,t){return e.placeholderImage=t("img/default-placeholder.png"),e.placeholderImage}]),angular.module("tnConfig").value("placeholderUserImage","https://thebenclark.files.wordpress.com/2014/03/facebook-default-no-profile-pic.jpg").value("analyticsDialog",{hasBackdrop:!1,disableParentScroll:!0,clickOutsideToClose:!0,templateUrl:"partials/shared/analytics-dialog.html",controller:"AnalyticsDialog",controllerAs:"analyticsDialog",onComplete:function(e){e.analyticsDialog.onload()}}),e.factory("nodesConfig",["propertyType",function(e){var t={},n=t.index={};return t.store="nodes",t.type={title:e.str,image:e.str,type:e.str,locked_image:e.str,visited:e.date,favicon:e.str,views:e.count,description:e.str,address:e.str},n[r[r.title]]={key:o[r.title],options:{unique:!1,multiEntry:!1}},n[r[r.visited]]={key:o[r.visited],options:{unique:!1,multiEntry:!1}},t.listCtrl={sortBy:r[r.visited],sortOrder:!1,searchText:"",selectedText:null,disableSort:!1,getSelectedText:function(){return this.selectedText},getSearchText:function(){var e=this.searchText;if(e&&e.length>=3)return e},getText:function(){var e=this.getSelectedText();return e?e.text:this.getSearchText()},isSearch:function(){return!(!this.getSelectedText()&&!this.getSearchText())},type:{visited:t.type.visited,title:t.type.title},clearSearch:function(){this.searchText="",this.selectedText=null}},t}]);var r;!function(e){e[e.title=0]="title",e[e.image=1]="image",e[e.type=2]="type",e[e.locked_image=3]="locked_image",e[e.visited=4]="visited",e[e.favicon=5]="favicon",e[e.description=6]="description",e[e.tags=7]="tags",e[e.rss=8]="rss",e[e.geo=9]="geo",e[e.address=10]="address",e[e.isArticle=11]="isArticle",e[e.url=12]="url",e[e.facebook_id=13]="facebook_id",e[e.color=14]="color",e[e.og_image=15]="og_image",e[e.lang=16]="lang"}(r||(r={}));var o;!function(e){e[e.n=0]="n",e[e.i=1]="i",e[e.t=2]="t",e[e.l=3]="l",e[e.v=4]="v",e[e.f=5]="f",e[e.d=6]="d",e[e.k=7]="k",e[e.r=8]="r",e[e.g=9]="g",e[e.a=10]="a",e[e.c=11]="c",e[e.u=12]="u",e[e.b=13]="b",e[e.o=14]="o",e[e.m=15]="m",e[e.e=16]="e"}(o||(o={})),angular.module("tnConfig").value("nodeDialogConfig",{hasBackdrop:!1,disableParentScroll:!0,clickOutsideToClose:!0,templateUrl:"partials/shared/node-dialog.html",controller:"NodeDialogCtrl",controllerAs:"vm",onComplete:function(e,t){t.find("#dialogContent_node-dialog").mCustomScrollbar({theme:"minimal-dark"})},onRemoving:function(e){e.find("#dialogContent_node-dialog").mCustomScrollbar("destroy")}}).value("relatedDialogConfig",{hasBackdrop:!1,disableParentScroll:!0,clickOutsideToClose:!0,controller:function(){this.loading=!0},controllerAs:"relatedDialogCtrl",bindToController:!0,templateUrl:"partials/shared/related-dialog.html",onComplete:function(e,t){t.find("md-content").mCustomScrollbar({theme:"minimal-dark"})},onRemoving:function(e){e.find("md-content").mCustomScrollbar("destroy")}}).value("nodeUrlDialogConfig",{hasBackdrop:!1,disableParentScroll:!0,clickOutsideToClose:!0,templateUrl:"partials/shared/node-url-dialog.html",controllerAs:"vm"}).value("nodesProperties",r).value("nodesShortProperties",o),e.value("SCOPES",["https://www.googleapis.com/auth/plus.me","https://www.googleapis.com/auth/plus.login","https://www.googleapis.com/auth/userinfo.email"]).value("API_KEY","AIzaSyCHbESTG-Tt_cir4j6swhSe73MmNxOMdAI").value("SECONDARY_API_KEY","AIzaSyAVFXhdstGRYa40dbjNhJmzKx4ASVrBpuA").value("DISQUS_FORUM","brancher").value("DISQUS_API_KEY","VGVs0rDj4Weg7I5d42NNgIukCqMhFv3PQQkh4WACRZJvvXEWzBXV0zUyTOfb7uMt").value("FB_ID","1099461436740953").value("FB_SCOPES",["user_friends"]).value("EBAY_CAMPID","5338007501").value("AMAZON_ID","brancher0b-20").value("ALIBABA_ID","928268164").value("ITUNES_TOKEN","").value("GOOGLE_OPTIMIZE_CODE","GTM-M56ZPVZ").factory("BUFFER_ID",["debug_mode",function(e){return e?"59c86e67aa7cc01b6bf6a1bc":"59c859ee285dcfbc478fcdee"}]).factory("BUFFER_REDIRECT_URI",["BASE_URL",function(e){return e+"/buffer"}]).constant("ANALYTICS_TRACKING_ID","UA-87007310-1").constant("GOOGLE_AD_CLIENT","ca-pub-4049546790962842").value("EXTENSION_ID","undefined"!=typeof chrome&&chrome.runtime&&chrome.runtime.id||"dfanhpdcmhemhkjafmannijhneiplgec").value("CLIENT_ID","988709185566-o0jm430od2s08urqnsujfnli5a6572is.apps.googleusercontent.com").factory("BASE_URL",["debug_mode",function(e){return e?"http://localhost:8080":"https://brancher.io"}]).factory("BASE_API_URL",["debug_mode",function(e){return e?"http://localhost:8080":"https://getbrancher.appspot.com"}]).factory("BASE",["BASE_API_URL",function(e){return e+"/_ah/api"}]).factory("EXTENSION_URL",["EXTENSION_ID",function(e){return"https://chrome.google.com/webstore/detail/"+e}]).factory("STORAGE_URL",["BASE_API_URL",function(e){return e+".storage.googleapis.com/"}]),e.factory("treesConfig",["$rootScope","UserSettingsStatic","propertyType",function(e,t,n){var r={},o=e.userSettings=new t(r,i),s=r.index={},c=localStorage;return r.store="trees",r.MAX_CHILDREN=100,r.checkOverQuota=function(){var e=c.getItem("overQuotaNotification");return!e||+new Date-+new Date(e)>864e5},r.setOverQuota=function(){c.setItem("overQuotaNotification",(new Date).toISOString())},s[i[i.children]]={key:a[i.children],options:{unique:!1,multiEntry:!0}},s[i[i.created]]={key:a[i.created],options:{unique:!0,multiEntry:!1}},s[i[i.modified]]={key:a[i.modified],options:{unique:!0,multiEntry:!1}},s[i[i.title]]={key:a[i.title],options:{unique:!1,multiEntry:!1}},e.groupCtrl=r.groupCtrl={sortBy:o.treesSort,sortOrder:!1,disableSort:!1,treesSearch:{selectedNode:null,searchText:"",getSelectedNode:function(){return this.selectedNode},getSearchText:function(){var e=this.searchText;if(e&&e.length>=3)return e},isSearch:function(){return!(!this.getSelectedNode()&&!this.getSearchText())},clear:function(){this.selectedNode=null,this.searchText=""},getText:function(){var e=this.getSelectedNode();return e?e.text:this.getSearchText()}},type:{created:n.date,modified:n.date,title:n.str,rating:n.rating,description:n.str,count:n.str,addedCount:n.count,views:n.count},updateSort:function(){var e=this,t=e.sortBy,r=e.sortOrder;switch(this.type[t]){case n.date:this.reverse=!r;break;case n.str:this.reverse=r;break;case n.rating:this.reverse=!0}}},r.treeCtrl={sortBy:o.treeSort,sortOrder:!1,vertical:o.treeLayout,isListed:!1,isExpanded:!1,type:{visited:n.date,timestamp:n.date,title:n.str},data:{visited:!0,timestamp:!1,title:!0}},e.groupCtrl.updateSort(),r}]);var i;!function(e){e[e.created=0]="created",e[e.modified=1]="modified",e[e.title=2]="title",e[e.description=3]="description",e[e.children=4]="children",e[e.parents=5]="parents",e[e.timestamps=6]="timestamps",e[e.original=7]="original",e[e.image=8]="image",e[e.favorite=9]="favorite",e[e.tags=10]="tags",e[e.seen=11]="seen",e[e.domains=12]="domains",e[e.lang=13]="lang"}(i||(i={}));var a;!function(e){e[e.t=0]="t",e[e.m=1]="m",e[e.n=2]="n",e[e.d=3]="d",e[e.c=4]="c",e[e.p=5]="p",e[e.s=6]="s",e[e.o=7]="o",e[e.i=8]="i",e[e.f=9]="f",e[e.g=10]="g",e[e.e=11]="e",e[e.a=12]="a",e[e.l=13]="l"}(a||(a={}));var s;!function(e){e[e.tree=0]="tree",e[e.link=1]="link",e[e.image=2]="image"}(s||(s={})),angular.module("tnConfig").value("treeProperty",i).value("treeShortProperty",a).value("linkEvent",s).value("dialogConfig",{hasBackdrop:!0,disableParentScroll:!0,clickOutsideToClose:!0,templateUrl:"partials/shared/tree-dialog.html",controller:"TreeDialogCtrl",controllerAs:"vm"}).value("userImagesDialogConfig",{controller:"UserImagesDialogCtrl",controllerAs:"userImagesDialog",templateUrl:"partials/shared/user-images-dialog.html",hasBackdrop:!0,disableParentScroll:!0,clickOutsideToClose:!0,onComplete:function(e,t){t.find("#dialog-container").mCustomScrollbar(e.scrollConfig)},onRemoving:function(e){e.find("#dialog-container").mCustomScrollbar("destroy")}}).value("mapDialogConfig",{hasBackdrop:!0,disableParentScroll:!0,clickOutsideToClose:!0,templateUrl:"partials/shared/map-dialog.html",controllerAs:"mapDialogCtrl",controller:["$scope","$timeout","$controller","maps","geolocation","geoNodes","title",function(e,t,n,r,o,i,a){e.mapDialogCtrl.title=a,t(function(){return n("MapDialogCtrl",{$scope:e,maps:r,geolocation:o,geoNodes:i})},850)}]}).value("reportDialogConfig",{hasBackdrop:!1,disableParentScroll:!0,clickOutsideToClose:!0,templateUrl:"partials/shared/report-dialog.html",controller:"ReportDialogCtrl",controllerAs:"vm"}).value("subscriptionsDialogConfig",{hasBackdrop:!0,disableParentScroll:!0,clickOutsideToClose:!0,templateUrl:"partials/components/subscriptions-dialog.html",controller:"SubscriptionsDialogCtrl",controllerAs:"vm",onComplete:function(e,t){e.vm.$element=t,e.vm.onload()},onRemoving:function(e){e.find("md-dialog-content").mCustomScrollbar("destroy")}}).value("treeEditorsDialogConfig",{hasBackdrop:!1,disableParentScroll:!0,clickOutsideToClose:!0,templateUrl:"partials/shared/tree-editors-dialog.html",controller:"TreeEditorsDialogCtrl",controllerAs:"vm",onComplete:function(e,t){e.vm.$element=t,e.vm.onload()},onRemoving:function(e){e.find("md-dialog-content").mCustomScrollbar("destroy")}}).value("overQuotaNotification",{type:"basic",iconUrl:"img/icon128-disabled.png",title:"Storage quota exceeded!",message:"You have reached the maximum number of trees for a free user",contextMessage:"Please, upgrade to pro-account for the unlimited storage",requireInteraction:!0}).factory("deleteTreeConfirmDialog",["$mdDialog",function(e){return function(t){return e.confirm().title("Are you sure?").textContent("This tree will be deleted.").ariaLabel("Delete tree").targetEvent(t).ok("OK").cancel("Cancel")}}])}(angular.module("tnConfig",[])),function(e){e.factory("IDB",["$q","treesConfig","nodesConfig",function(e,t,n){var r=e.defer(),o={};indexedDB||r.reject({error:"IndexedDB not found"});var i=indexedDB.open("Trees",1);return o.IDBRange=IDBKeyRange,i.onupgradeneeded=function(e){var r=e.target,o=r.result,i=o.createObjectStore(t.store,{autoIncrement:!0}),a=o.createObjectStore(n.store);angular.forEach(t.index,function(e,t){return i.createIndex(t,e.key,e.options)}),angular.forEach(n.index,function(e,t){return a.createIndex(t,e.key,e.options)})},i.onsuccess=function(e){var t=e.target;o.IndexedDB=t.result,r.resolve(o)},i.onerror=function(){r.reject({error:"IndexedDB error"})},i.onblocked=function(){r.reject({error:"IndexedDB blocked"})},r.promise}])}(angular.module("tnIndexedDB",["tnConfig"])),function(e){e.factory("BaseEditOneCommand",["Class","BaseCommand","Link","Nodes","util",function(e,t,n,r,o){var i={};return i.initialize=function(e,t,n){var r=this;r.subtree=t,n.stack=e,r.callSuper(n)},i.getCount=function(){return 1},i.merge=function(){var e=this,t=e.getTree(),r=e.subtree,o=r.child;t&&(t.put(o,new n(r.parent,r.timestamp)),r.children.forEach(function(e){var n=t.get(e);n&&(n.parent=o)}))},i.remove=function(){var e=this,t=e.getTree(),n=e.subtree,r=n.parent;t&&t.remove(n.child)&&n.children.forEach(function(e){var n=t.get(e);n&&(n.parent=r)})},i.toJSON=function(e){var t=this,n=angular.copy(t.subtree);return angular.merge(n,e),n.timestamp=o.parseDate(n.timestamp).toISOString(),t.isMerge&&(n.nodes=r.getByKeys([n.child])),n},new e(t,i)}]),e.factory("BaseEditRootCommand",["Class","BaseCommand","Nodes","Link","util",function(e,t,n,r,o){var i={};return i.initialize=function(e,t,n){var r=this;r.subtree=t,n.stack=e,r.callSuper(n)},i.getCount=function(){return 1},i.merge=function(){var e=this,t=e.getTree(),n=e.subtree,o=n.child;if(t&&!t.hasKey(o)){var i=t.get(t.root);i.isRoot=!1,i.parent=o,t.put(o,new r("ROOT",n.timestamp)),t.root=o}},i.remove=function(){var e=this,t=e.getTree(),n=e.subtree,o=n.child;if(t&&t.remove(o)){var i=t.rassoc(new r(o));i.value.isRoot=!0,i.value.parent=null,t.root=i.key}},i.toJSON=function(e){var t=this,r=angular.copy(t.subtree);return angular.merge(r,e),r.timestamp=o.parseDate(r.timestamp).toISOString(),t.isMerge&&(r.nodes=n.getByKeys([r.child])),r},new e(t,i)}]),e.factory("BaseCommand",["Class","Command",function(e,t){var n={};return n.getTree=function(){return this._stack.tree},new e(t,n)}]),angular.module("tnCommands").factory("BaseEditCommand",["Class","BaseCommand","Nodes",function(e,t,n){var r={};return r.initialize=function(e,t,n){var r=this;r.subtree=t,n.stack=e,r.callSuper(n)},r.getCount=function(){return this.subtree.size},r.merge=function(){var e=this,t=e.getTree();t&&t.update(e.subtree.getTreeCopy(),function(e,t){return t})},r.remove=function(){var e=this,t=e.getTree();if(t){var n=e.subtree;t.removeIf(function(e){return n.hasKey(e.key)})}},r.toJSON=function(e){var t=this,r=t.subtree.toJSON(!0),o=r.children,i=r.parents,a=r.timestamps,s=r.modified,c={children:o,parents:i,timestamps:a,modified:s};return t.isMerge&&(c.nodes=n.getByKeys(o)),angular.merge(c,e),c},new e(t,r)}]),e.factory("MergeOne",["Class","BaseEditOneCommand",function(e,t){var n={};return n.initialize=function(e,t){var n=this;n.isMerge=!0,n.callSuper(e,t,{execute:function(){this.merge()},undo:function(){this.remove()}})},n.getAPIMethod=function(e){return e?"remove.link":"store.link"},new e(t,n)}]),e.factory("MergeRoot",["Class","BaseEditRootCommand",function(e,t){var n={};return n.initialize=function(e,t){var n=this;n.isMerge=!0,n.callSuper(e,t,{execute:function(){this.merge()},undo:function(){this.remove()}})},n.getAPIMethod=function(e){return e?"remove.root":"store.root"},new e(t,n)}]),e.factory("Merge",["Class","BaseEditCommand",function(e,t){var n={};return n.initialize=function(e,t){var n=this;n.isMerge=!0,n.callSuper(e,t,{execute:function(){this.merge()},undo:function(){this.remove()}})},n.getAPIMethod=function(e){return e?"remove.links":"store.links"},new e(t,n)}]),e.factory("RemoveOne",["Class","BaseEditOneCommand",function(e,t){var n={};return n.initialize=function(e,t){var n=this;n.isRemove=!0,n.callSuper(e,t,{execute:function(){this.remove()},undo:function(){this.merge()}})},n.getAPIMethod=function(e){return e?"store.link":"remove.link"},new e(t,n)}]),e.factory("RemoveRoot",["Class","BaseEditRootCommand",function(e,t){var n={};return n.initialize=function(e,t){var n=this;n.isRemove=!0,n.callSuper(e,t,{execute:function(){this.remove()},undo:function(){this.merge()}})},n.getAPIMethod=function(e){return e?"store.root":"remove.root"},new e(t,n)}]),e.factory("Remove",["Class","BaseEditCommand",function(e,t){var n={};return n.initialize=function(e,t){var n=this;n.isRemove=!0,n.callSuper(e,t,{execute:function(){this.remove()},undo:function(){this.merge()}})},n.getAPIMethod=function(e){return e?"store.links":"remove.links"},new e(t,n)}])}(angular.module("tnCommands",["tnConfig"])),function(e){e.service("util",["$rootScope",function(e){var t=this,n={sameDay:"[Today,] DD/MM/YYYY",nextDay:"[Tomorrow]",nextWeek:"dddd",lastDay:"[Yesterday,] DD/MM/YYYY",lastWeek:"[Last] dddd, DD/MM/YYYY",sameElse:"DD/MM/YYYY"};t.parseDate=function(e){if(angular.isDate(e))return e;if(angular.isString(e)){var t=new Date(e.replace("Z",""));return new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds()))}return new Date},t.formatDateCalendar=function(e){return moment(e).calendar(null,n)},t.translate=function(e,t){return"translate("+e+"px, "+t+"px) "},t.scale=function(e,t){return angular.isUndefined(t)?"scale("+e+") ":"scale("+e+", "+t+") "},t.replaceProperties=function(e,t,n){angular.forEach(n,function(n){var r=t[n];r?e[n]=r:delete e[n]})},t.renameProperties=function(e,t,n){return angular.forEach(Object.keys(n),function(r){var o=n[r];if(delete n[r],o){var i=e[r];angular.isNumber(i)&&(n[t[i]]=o)}}),n},t.isPdf=function(e){return".pdf"==e.slice(e.length-4)},t.getUserLanguage=function(){return e.userSettings.contentLanguage?e.userSettings.contentLanguage:"undefined"==typeof navigator?"en":(navigator.language||"").split("-")[0]||"en"}}])}(angular.module("tnUtil",[])),function(e){var t=n(5),r=n(6),o=n(7),i=n(8),a=n(9),s=n(10),c=n(11),u=n(12);e.config(["$provide",function(e){var n=new t.Class({include:a.Enumerable,extend:s.Forwardable,initialize:function(e){this.list=e},forEach:function(e,t){if(!e)return this.enumFor("forEach");for(var n=0,r=this.list.length;n<r;n++)e.call(t,this.list[n]);return this}});n.defineDelegators("list","push","splice"),e.value("Container",n),e.value("Command",i.Command),e.value("Stack",i.Command.Stack),e.value("Module",t.Module),e.value("Class",t.Class),e.value("Hash",r.Hash),e.value("OrderedHash",r.OrderedHash),e.value("Set",o.Set),e.value("OrderedSet",o.OrderedSet),e.value("Comparable",c.Comparable),e.value("Observable",u.Observable)}]),e.factory("buffer",["toastObserver",function(e){var t,n={};return n.get=function(){return t.getTreeCopy()},n.set=function(n){t=n,e.notifyObservers("Copied "+n.size+" node(s)")},n.isEmpty=function(){return!t},n}]),e.factory("Nodes",["Observable","Hash",function(e,t){var n=new t;return n.setDefault(function(e,t){return{title:"Not Found",url:"https://goo.gl/"+t}}),n.extend(e),n.extend({getByKeys:function(e){var t=this;return t.valuesAt.apply(t,e)},addNode:function(e,t){var n=this;n.hasKey(e)?angular.merge(n.get(e),t):t.title&&n.put(e,t),t.value||(t.value=e)}}),n}]),e.factory("OrderedContainer",["Module","Observable","propertyType",function(e,t,n){var r={};return r.include=t,r.addNew=function(e,t,r){var o=this,i=!0;if(!o.isEmpty())switch(t){case n.date:i=!r;break;case n.str:var a=this.forEachValue();i=r?e.gte(a.min()):e.lte(a.max())}return i},r.updateContainer=function(e,t,n,r,o,i){var a=this;if(a.size>1&&a.hasKey(e))for(var s=0;s<t.length;s+=1)if(n==t[s]){var c=a.remove(e);a.addNew(c,r,o)&&(a.put(e,c),a.resort(i)),a.notifyObservers();break}},r.resort=function(e){var t=this,n=t.sortBy(function(e){return e.value});t.clear(),e&&n.reverse(),n.forEach(function(e){return t.put(e.key,e.value)})},new e(r)}]),e.factory("Stacks",["Class","Hash","TreeStack",function(e,t,n){var r={};return r.registerTree=function(e,t){var r=this,o=r.get(e);o?o.tree=t:(o=new n,o.tree=t,r.put(e,o)),t.stack=o},r.unregisterTree=function(e){var t=this,n=t.get(e);n&&(n.tree=null)},new e(t,r)}]),e.factory("TreesMeta",["Class","OrderedHash","OrderedContainer","TreesMetaContainer",function(e,t,n,r){var o={};return o.include=[n],o.toTreesMetaArray=function(){return this.map(function(e){return r.assoc(e.key)})},o.groupTrees=function(e){var t=this,n=t.toTreesMetaArray(),r=[];return angular.isString(e)?[{key:e,value:n}]:(n.forEach(function(t){var n=e(t.value),o=r[r.length-1];o&&o.key==n?o.value.push(t):r.push({key:n,value:[t]})}),r)},o.deleteMeta=function(e){var t=this;r.remove(e),t.remove(e)&&t.notifyObservers()},new e(t,o)}]),angular.module("tnClasses").factory("TreesMetaContainer",["Hash",function(e){return new e}]),e.factory("Trees",["Class","Observable","OrderedHash","Tree","Stacks","Link","buffer",function(e,t,n,r,o,i,a){var s,c={},u=new o,l=new i;return c.include=t,c.put=function(e,t){var n=this;return u.registerTree(e,t),n.callSuper(e,t)},c.remove=function(e){var t=this;return u.unregisterTree(e),t.callSuper(e)},c.clear=function(){var e=this;return e.forEachKey(function(t){return e.remove(t)}),e.callSuper()},c.deleteTree=function(e){var t=this;t.hasKey(e)&&(t.remove(e),u.remove(e))},c.add=function(e,t){var n=this,o=t.id;if(o&&!n.hasKey(o)){var i=new r(e,t);n.put(o,i)}},c.getTree=function(e){var t=this;if(t.hasKey(e))return t.get(e)},c.hasNode=function(e,t){return e&&e.hasKey(t)},c.bufferTree=function(e){var t=this,n=t.getTree(e);angular.isDefined(n)&&a.set(n.getTreeCopy())},c.buffer=function(e,t){var n=this,r=n.getTree(e);n.hasNode(r,t)&&a.set(r.getBranchCopy(t))},c.paste=function(e,t,n){var r=this;if(!a.isEmpty()||n){var o=r.getTree(e);if(r.hasNode(o,t)){n=n||a.get();var s=n.rassoc(l);if(s){var c=s.key;return c!=t&&n.put(c,new i(t,s.value.timestamp)),o.getMerge(n)}}}},c.pasteBranch=function(e,t,n){return this.paste(e,t,n)},c.deleteBranch=function(e,t){var n=this,r=n.getTree(e);if(n.hasNode(r,t))return r.getRemove(t)},c.deleteOne=function(e,t){var n=this,r=n.getTree(e);if(n.hasNode(r,t))return r.getRemoveOne(t)},c.deleteRoot=function(e){var t=this,n=t.getTree(e);if(angular.isDefined(n))return n.getRemoveRoot()},c.storeLinks=function(e){var t=this,n=e.id,o=t.getTree(n),i=new r(e),a=o.stack,c=r.mergeCommand(a,i);s.execute(a,c,o)},c.removeLinks=function(e){var t=this,n=e.id,o=t.getTree(n),i=new r(e),a=o.stack,c=r.removeCommand(a,i);s.execute(a,c,o)},c.storeLink=function(e){var t=this,n=e.id,o=t.getTree(n),i=o.stack,a=r.mergeOneCommand(i,e);s.execute(i,a,o)},c.removeLink=function(e){var t=this,n=e.id,o=t.getTree(n),i=o.stack,a=r.removeOneCommand(i,e);s.execute(i,a,o)},c.storeRoot=function(e){var t=this,n=e.id,o=t.getTree(n),i=o.stack,a=r.mergeRootCommand(i,e);s.execute(i,a,o)},c.removeRoot=function(e){var t=this,n=e.id,o=t.getTree(n),i=o.stack,a=r.removeRootCommand(i,e);s.execute(i,a,o)},s=new e(n,c),s.extend({bufferNode:function(e){var t=new r([e,new i]);a.set(t)},newLink:function(e,t,n){return new r([t,new i(e,n)])},getStack:function(e){return u.get(e)},execute:function(e,t,n){e.clear(),t.execute(),n.meta.domains=n.getDomains()}}),s}]),e.factory("Users",["Class","Observable","OrderedHash",function(e,t,n){var r={};return r.include=t,r.initialize=function(){var e=this;e.more=!0,e.pageToken="",e.loading=!1,e.callSuper()},r.clear=function(){var e=this;return e.pageToken="",e.more=!0,e.callSuper()},new e(n,r)}]),e.factory("Link",["Class","util",function(e,t){var n={};return n.isRoot=!1,n.initialize=function(e,n,r){void 0===r&&(r=!1);var o=this;o.page=0,o.timestamp=t.parseDate(n),o.related=r,o.collapsed=!1,o.expanded=!1,"ROOT"!=e&&e?o.parent=e:o.isRoot=!0},n.hash=function(){var e=this;return e.isRoot?"ROOT":e.parent},n.equals=function(e){var t=this;return t.isRoot&&e.isRoot||!t.isRoot&&t.parent==e.parent},new e(n)}]),e.factory("NodeMeta",["Class","Comparable","Nodes","nodesConfig",function(e,t,n,r){var o=r.listCtrl,i={};return i.include=t,i.initialize=function(e,t,n){void 0===t&&(t=!1),this.data={key:e,value:{related:t,timestamp:n}}},i.compareTo=function(e){var t=this,n=t.getCurrentSortValue(),r=e.getCurrentSortValue();return n<r?-1:n>r?1:0},i.getCurrentSortValue=function(){var e=this,t=n.get(e.data.key)[o.sortBy];return t||""},new e(i)}]),e.factory("TreeStack",["Class","Stack","Merge",function(e,t,n){var r={};return r.getCurrent=function(){var e=this;return e.getCommand(e.pointer-1)},r.getCommand=function(e){return this._stack[e]},r.getCount=function(){var e=this,t=e.getCurrent();if(t)return t.getCount()},r.newLink=function(e){return new n(this,e)},new e(t,r)}]),e.factory("TreeMeta",["Class","Comparable","ObservableClass","treesConfig","util",function(e,t,n,r,o){var i={},a=r.groupCtrl;return i.include=t,i.initialize=function(e,t){var r=this;r.id=e,r.editable=t.editable,r.created=o.parseDate(t.created),r.observer=n(),r.update(t),r.published=t.published,r.favorite=t.favorite,r.sync=parseInt(t.sync||"0"),r.loading=!1,r.userId=t.userId,r.plusId=t.plusId,r.newLinks=0,r.shortUrl=t.shortUrl,r.original=t.original,r.selectedPage=t.selectedPage,r.lang=t.lang},i.toJSON=function(){var e=this;return{id:e.id,title:e.title,description:e.description,image:e.image,created:e.created.toISOString(),modified:e.modified.toISOString(),published:e.published,favorite:e.favorite,tags:e.tags,domains:e.domains,editable:e.editable,limitedEdit:e.limitedEdit,seen:e.seen,userId:e.userId,plusId:e.plusId,shortUrl:e.shortUrl,original:e.original,count:e.count,views:e.views,addedCount:e.addedCount,lang:e.lang}},i.update=function(e){var t=this;t.modified=o.parseDate(e.modified),t.title=e.title||t.title||"Untitled",t.description=e.description,t.tags=e.tags||[],t.addedCount=parseInt(e.addedCount),t.count=e.count||t.count,t.views=parseInt(e.views),t.image=e.image,t.seen=e.seen,t.domains=e.domains,t.datePublished=o.parseDate(e.datePublished),t.dateFavorite=o.parseDate(e.dateFavorite),t.observer.notifyObservers()},i.compareTo=function(e){var t=this,n=t.getCurrentSortValue(),r=e.getCurrentSortValue();return n<r?-1:n>r?1:0},i.getCurrentSortValue=function(){var e=this,t=e[a.sortBy];return t||""},i.getKeywords=function(){var e=this,t=e.title.split(" ").slice(0,4).join(" ");return e.tags.length&&(t=e.tags.slice(0,3).join(" ")),t},i.getEbayKeywords=function(){return"("+this.getKeywords().split(" ").join(",")+")"},new e(i)}]),angular.module("tnClasses").factory("TreeMetaProxy",["Class","Comparable","TreesMetaContainer",function(e,t,n){var r={};return r.include=t,r.initialize=function(e){this.key=e},r.compareTo=function(e){var t=this;return n.get(t.key).compareTo(n.get(e.key))},new e(r)}]),e.factory("Tree",["Class","Comparable","URI","Nodes","Hash","Set","Link","Container","Merge","Remove","MergeOne","RemoveOne","MergeRoot","RemoveRoot","treesConfig","propertyType",function(e,t,n,r,o,i,a,s,c,u,l,d,p,m,f,g){function h(e){return!(!e.locked_image&&!e.image)}function v(e){return!!e.geo}function y(e){var t=n(e.url||"");if("www.youtube.com"==t.host())return!!t.query(!0).v}var b,k={},C=f.MAX_CHILDREN,w=new a;return k.include=t,k.initialize=function(e,t){var n=this;if(angular.isArray(e))return void n.callSuper(e,null);if(!angular.isObject(e))throw new Error;var o=e.children,i=e.parents,c=e.timestamps,u=e.nodes,l=[];if(!(o&&i&&c))throw new Error;if(o.length!=i.length||i.length!=c.length)throw new Error;n.meta=t,new s(o).zip(i,c,function(e){l.push(e[0]),l.push(new a(e[1],e[2]))}),n.callSuper(l,null),n.root=n.key(w),angular.isArray(u)&&angular.forEach(u,function(e){var t=e&&e.value;t&&(r.addNode(t,e),angular.isArray(e.related)&&n.hasKey(t)&&e.related.forEach(function(e){if(!n.hasKey(e)){var r=new a(t,null,!0);n.put(e,r)}}))})},k.forEachPairWithObject=function(e,t){return this.forEachPair().forEachWithObject(e,t)},k.compareTo=function(e){return this.meta.compareTo(e.meta)},k.getCurrentSortValue=function(){return this.meta.getCurrentSortValue()},k.toJSON=function(e){var t=this,n={},r=t.meta,o=n.children=[],i=n.parents=[],a=n.timestamps=[],s=function(e){return e};return r&&angular.extend(n,r.toJSON()),e?(s=function(e){return e.toISOString()},r&&(n.created=r.created.toISOString(),n.modified=r.modified.toISOString())):(n.created=r.created,n.modified=r.modified),t.forEachPair(function(e){return function(t,n){n.related||(o.push(t),i.push(n.hash()),a.push(e(n.timestamp)))}}(s)),n},k.getTreeCopy=function(){var e=this,t=new e.klass([]);return e.forEachPairWithObject(t,function(e,t,n){n.related||e.put(t,new a(n.parent,n.timestamp))})},k.getBranchCopy=function(e){var t=this;return t.root==e?t.getTreeCopy():t.getBranch(e)},k.groupByParent=function(){return this.groupBy(function(e){return e.value})},k.getBranch=function(e){var t=this,n=t.get(e);if(n){var r=t.groupByParent(),o=[e,new a(null,n.timestamp)];return function e(t){r.fetch(new a(t),[]).forEach(function(t){var n=t.value,r=t.key;n.related||(o.push(r),o.push(new a(n.parent,n.timestamp)),e(r))})}(e),new t.klass(o)}},k.getCompareFunction=function(e){var t,n,o=e.sortBy,i=e.reverse;switch(t=e.data[o]?function(e){return r.get(e.key)[o]||""}:function(e){return e.value[o]||""},e.type[o]){case g.date:n=function(e,t){return e>t?1:e<t?-1:0};break;case g.str:n=function(e,t){return e.localeCompare(t)}}return i?function(e,r){return-n(t(e),t(r))}:function(e,r){return n(t(e),t(r))}},k.getMerge=function(e){var t=this,n=new i(t.keys()),r=new i(e.keys());if(!r.isSubset(n)){var o=r.difference(n);if(o.size>0&&o.size+t.size<=C)return e.keepIf(function(e){return o.contains(e.key)}),new c(t.stack,e)}},k.getRemove=function(e){var t=this,n=t.getBranch(e);return n.put(e,t.get(e)),new u(t.stack,n)},k.getRemoveOne=function(e){var t=this,n={},r=n.children=[],o=t.get(e);return n.parent=o.parent,n.child=e,n.timestamp=o.timestamp,t.forEach(function(t){t.value.parent!=e||t.value.related||r.push(t.key)}),new d(t.stack,n)},k.getRemoveRoot=function(){var e=this,t={},n=e.root,r=e.get(n);if(r&&1==e.count(function(e){return e.value.parent==n}))return t.child=n,t.timestamp=r.timestamp,new m(e.stack,t)},k.getImages=function(){var e=this;return r.getByKeys(e.keys()).filter(h)},k.getGeo=function(){var e=this;return r.getByKeys(e.keys()).filter(v)},k.getYoutubeVideos=function(){var e=this;return r.getByKeys(e.keys()).filter(y)},k.getDomains=function(){var e=this,t=e.keys(),o=r.getByKeys(t).filter(function(e,n){return r.hasKey(t[n])}).map(function(e){return n(e.url).host()});return new i(o).toArray()},b=new e(o,k),b.extend({mergeCommand:function(e,t){return new c(e,t)},removeCommand:function(e,t){return new u(e,t)},mergeOneCommand:function(e,t){return new l(e,t)},removeOneCommand:function(e,t){return new d(e,t)},mergeRootCommand:function(e,t){return new p(e,t)},removeRootCommand:function(e,t){return new m(e,t)}}),b}])}(angular.module("tnClasses",["tnCommands","tnUtil"])),function(e){var t=function(){function e(e,t,n,r,o){this.$q=e,this.$http=n,this.GApi=r,this.GData=o,this.status=!1,this.storage=localStorage,this.logoutURL="https://www.facebook.com/logout.php",this.serviceURL="https://graph.facebook.com/v2.8/",t.facebook=this}return e.prototype.getAccessToken=function(){return this.access_token},e.prototype.removeAccessToken=function(){this.access_token=null,this.updateStatus()},e.prototype.setAccessToken=function(e){var t=e&&(e.access_token||e.accessToken);t?(this.access_token=t,this.updateStatus()):this.removeAccessToken()},e.prototype.fetchAccessToken=function(){return this.$q.when()},e.prototype.facebookLogin=function(e){return this.$q.when()},e.prototype.facebookLogout=function(){return this.$q.when()},e.prototype.publisherLogin=function(e){return this.$q.when([])},e.prototype.updateStatus=function(){this.status=!!this.getAccessToken()},e.prototype.getUser=function(t,n){return void 0===n&&(n="id,name,picture"),this.GApi.execute("user","get.node.facebook",{value:t}).then(function(t){return e.makeNodeUserObject(t)})},e.prototype.listUserPhotos=function(t,n,r){var o=this;return void 0===r&&(r="images,name"),this.execute(function(n,i){var a=e.fbCallback(i);o.$http.get(o.serviceURL+t+"/photos",{params:{access_token:n,fields:r}}).then(a,a)},n)},e.prototype.publish=function(e,t){var n=this.serviceURL+e.id+"/feed?access_token="+e.access_token;return this.$http.post(n,"link="+t).then(angular.noop)},e.fbCallback=function(e){return function(t){return e(t.data)}},e.makeNodeUserObject=function(e){var t=e.image;return{name:e.title,picture:{data:{url:t}},id:e.facebook_id}},e.prototype.listFriends=function(e){return this.$q.when({})},e.prototype.userSetup=function(){return this.$q.reject()},e.prototype.login=function(){var e=this;return this.simple_login().then(function(t){return e.facebookLogin(t)},function(){return e.removeAccessToken()})},e.prototype.simple_login=function(e){return this.$q.when("")},e.prototype.logout=function(){return this.$q.when()},e.prototype.getToken=function(e){return this.$q.when("")},e.prototype.getUsers=function(e,t){return this.$q.when([])},e.prototype.executeAPIMethod=function(e){var t=this,n=function(){return e().then(function(e){return e},function(n){return n&&401==n.code?t.getToken().then(e):t.$q.reject(n)})};return this.status?n():this.login().then(n)},e.prototype.execute=function(e,t,n,r){var o=this;void 0===t&&(t=""),void 0===n&&(n=this.$q.defer()),void 0===r&&(r=0);var i=this.getAccessToken(),a=function(e){var t=e.error;if(t)if(r<2)switch(t.type){case"OAuthException":o.GData.isLogin()?r<1?o.fetchAccessToken().then(function(){var e=o.getAccessToken();e&&e!=i?u():c()}):c():r<1?c():s(t);break;default:n.reject()}else s(t);else n.resolve(e)},s=function(e){o.removeAccessToken(),n.reject(),!e||"connected"==e.status&&"OAuthException"!=e.type||o.login()},c=function(){return o.getToken(!0).then(u,s)},u=function(){return o.execute(e,t,n,r+1)};return i?t?this.$http.get(t,{params:{access_token:i}}).then(function(e){return a(e.data)}):e(i,a):this.login().then(function(){o.status?u():n.reject()}),n.promise},e}();e.value("facebookSharedStatic",t);var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();e.factory("facebookAPIStatic",["$q","$rootScope","$window","$http","GApi","GData","GApiApp","firebaseService","URI","toastObserver","FB_SCOPES","BASE_URL","facebookSharedStatic",function(e,t,r,o,i,a,s,c,u,l,d,p,m){function f(e){return function(t){"connected"===t.status?e.resolve(t.authResponse.accessToken):e.reject(t)}}return function(m){function g(){return m.call(this,e,t,o,i,a)||this}return n(g,m),g.prototype.fetchAccessToken=function(){var t=this;return a.isLogin()?s.execute(function(){return i.executeAuth("user","facebook.token")}).then(function(e){return t.setAccessToken(e)},function(){return t.removeAccessToken()}):e.reject()},g.prototype.facebookLogin=function(e){var t=this;if(!e)return this.removeAccessToken(),this.$q.reject();var n,r={access_token:e};return a.isLogin()?n=s.execute(function(){return i.executeAuth("user","facebook.login",r)}).then(function(e){return t.setAccessToken(e)},function(){return t.setAccessToken(r)}).then(function(){return c.loginFacebook(t.getAccessToken())}):(this.setAccessToken(r),n=c.loginFacebook(e).then(function(n){return t.GApi.execute("user","facebook.user",{firebase_token:n,access_token:e})})),n},g.prototype.publisherLogin=function(e){var t=this;return s.execute(function(){return i.executeAuth("user","facebook.publisher",{access_token:e})}).then(function(e){return t.groups=e.groups,e.groups})},g.prototype.publish=function(e,t){return m.prototype.publish.call(this,e,t).then(function(){return l.notifyObservers("Successfully posted to "+e.name)})},g.prototype.facebookLogout=function(){var e=this.$q.when();return this.removeAccessToken(),a.isLogin()&&(e=s.execute(function(){return i.executeAuth("user","facebook.logout")})),e.then(function(){return c.logoutFacebook()})},g.prototype.getToken=function(){var e=this,t=this.$q.defer();return FB.getLoginStatus(f(t)),t.promise.then(function(t){return e.setAccessToken({access_token:t}),t})},g.prototype.simple_login=function(e){void 0===e&&(e=d);var t=this.$q.defer();return FB.login(f(t),{scope:e.join(",")}),t.promise},g.prototype.userSetup=function(){var t=e.when(this.getAccessToken());return this.status||(t=this.getToken()),t.then(function(e){return c.loginFacebook(e)}).then(angular.noop)},g.prototype.logout=function(){var e=this.logoutURL,t=this.getAccessToken();return this.facebookLogout().then(function(){var n=u(e).query({next:p+"/",access_token:t});r.location.href=n.toString()})},g.prototype.getUsers=function(e){if(e.length)return this.GApi.execute("user","get.nodes.facebook",{nodes:e}).then(function(e){return e.nodes&&e.nodes.map(g.makeNodeUserObject)})},g.prototype.listFriends=function(e,t){var n=this;return void 0===t&&(t="id,name,picture"),this.execute(function(e,r){var o=g.fbCallback(r);n.$http.get(n.serviceURL+"me/friends",{params:{access_token:e,fields:t}}).then(o,o)},e)},g}(m)}])}(angular.module("tnDataFacebook",["tnConfig"])),function(e){e.config(["$provide",function(e){e.factory("ObservableClass",["Class","Observable",function(e,t){return function(){var n=new e;return n.extend(t),n}}]),e.factory("timestampObserver",["$interval","ObservableClass",function(e,t){var n=t();return e(function(){return n.notifyObservers()},6e4,0,!1),n}])}]);var t=function(){function e(e,t,n,r,o,i,a){this.$httpParamSerializerJQLike=e,this.GApi=t,this.GApiApp=n,this.users=r,this.URI=o,this.BUFFER_ID=i,this.BUFFER_REDIRECT_URI=a}return e.prototype.login=function(){location.href=this.URI("https://bufferapp.com/oauth2/authorize").query({client_id:this.BUFFER_ID,redirect_uri:this.BUFFER_REDIRECT_URI,response_type:"code"}).toString()},e.prototype.isLogin=function(){return this.users.isBufferLogin},e.prototype.getProfiles=function(){var e=this;return this.GApiApp.execute(function(){return e.GApi.execute("user","buffer.profiles")}).then(function(e){return e.profiles})},e.prototype.createUpdate=function(e){var t=this;return this.GApiApp.execute(function(){return t.GApi.execute("user","buffer.create",{update:t.$httpParamSerializerJQLike(e)})})},e}();e.value("bufferSharedStatic",t);var n=function(){function e(e,t,n,r,o,i,a,s,c,u,l,d,p,m){this.$q=e,this.$cacheFactory=t,this.GApi=n,this.GApiApp=r,this.URI=o,this.uriParser=i,this.OrderedHash=a,this.NodeMeta=s,this.Nodes=c,this.ObservableClass=u,this.util=d,this.listCtrl=p,this.BASE_URL=m,this.openedTabsObserver=this.ObservableClass(),this.windowCloseObserver=this.ObservableClass(),this.articleLinkClickObserver=this.ObservableClass(),this.state={more:!0,moreLocal:!0,pageToken:"",loading:!1,loadingLocal:!1,offset:0},(this.container=new this.OrderedHash).extend(l),this.$cacheFactory.get("relatedNodes")||(this.relatedCache=this.$cacheFactory("relatedNodes",{capacity:8}))}return e.prototype.upadteLoadState=function(){var e=this.state;if(!e.more||e.loading)return!0;e.loading=!0},e.prototype.cleanLoadState=function(){this.state.loading=!1},e.prototype.addNodes=function(e,t){var n=this;void 0===t&&(t=!1);var r=this.state,o=this.container;r.pageToken=e.pageToken,r.more=e.more,this.addNodesShared(e.nodes),angular.forEach(e.nodes,function(e){var r=e.value;o.hasKey(r)||o.put(r,new n.NodeMeta(r,t))})},e.prototype.clearNodes=function(e){void 0===e&&(e=!1);var t=this.state;this.container.clear(),t.more=!0,t.moreLocal=e,t.pageToken="",t.loading=!1,t.offset=0},e.prototype.newNode=function(e){var t=new this.NodeMeta(e),n=this.listCtrl,r=n.sortBy,o=n.reverse,i=n.sortOrder,a=this.listCtrl.type[r],s=this.container;s.remove(e),s.addNew(t,a,i)&&(s.put(e,t),s.resort(o),s.notifyObservers())},e.prototype.getNode=function(e){return this.Nodes.get(e)},e.prototype.getYoutubeVideoId=function(e){if(e.url){var t=this.URI(e.url);if("www.youtube.com"==t.host())return t.query(!0).v}},e.prototype.getNodePreview=function(e,t){void 0===t&&(t=!1);var n=this.getNode(e);return{title:n.title,image:n.image,url:t?this.BASE_URL:n.url,description:n.description,targetUrl:this.getShortUrl(e,t),tags:n.tags,type:"node"}},e.prototype.getShortUrl=function(e,t){return void 0===t&&(t=!1),t?this.BASE_URL+"/article/?key="+e:"https://goo.gl/"+e},e.prototype.getNodesPreview=function(e,t){var n=this;return void 0===t&&(t=!1),e.filter(function(e){return"web search"!=n.getNode(e).type}).map(function(e){return n.getNodePreview(e)},t)},e.prototype.getNodesShared=function(e){return this.Nodes.getByKeys(e)},e.prototype.addNodesShared=function(e){var t=this,n=this.Nodes;e&&e.forEach(function(e){e.visited&&angular.isString(e.visited)&&(e.visited=t.util.parseDate(e.visited)),n.addNode(e.value,e)})},e.prototype.getNodeArticle=function(e){return this.GApi.execute("user","get.article",{value:e})},e.prototype.report=function(e,t){var n=this;return this.GApi.execute("user","report",{url:e,reason:t}).then(function(t){return t.isBlocked&&n.Nodes.remove(e),t})},e.prototype.search=function(e,t,n,r){var o=this;void 0===n&&(n=10),void 0===r&&(r=!1);var i=this.state;if(!this.upadteLoadState()){var a={query:e,pageToken:i.pageToken,geo:t?t.latitude+","+t.longitude:""};return this.GApi.execute("user","search.nodes",a).then(function(e){return o.addNodes(e,r)}).finally(function(){return o.cleanLoadState()})}},e.prototype.getNodeRequest=function(e,t){var n=this;void 0===t&&(t=!1);var r,o=this,i=o.$q,a=o.GApi,s=o.URI,c=o.Nodes,u=o.uriParser;e?(r=s(e),r.protocol()||r.protocol("http")):r=s("");var l=u.parse(r),d=l.toString();if(d){if(!t)for(var p=0,m=c.toArray();p<m.length;p++){var f=m[p];if(f.value.url==d)return i.when(c.get(f.key))}if("www.facebook.com"==l.host()){var g=u.getFacebookId(l);return a.execute("user","get.node.facebook",{value:g})}return a.execute("user","get.node",{url:d,isArticle:t}).then(function(e){return n.addNodesShared([e]),e})}return i.reject()},e.prototype.searchGlobal=function(e){var t=this;return this.search(e).then(function(){return t.container.notifyObservers()})},e.prototype.load=function(){return this.loadFunction("list.nodes")},e.prototype.loadRecommended=function(){var e=this;if(this.upadteLoadState())return this.$q.reject();var t=this.container.keys();return this.execute("list.nodes.recommended",{nodes:t}).then(function(t){e.addNodes(t),e.container.notifyObservers()}).finally(function(){return e.cleanLoadState()})},e.prototype.loadGlobal=function(){return this.loadFunction("list.nodes.rating")},e.prototype.loadFavorites=function(){return this.loadFunction("list.nodes.favorites")},e.prototype.loadDomain=function(e){return this.loadFunction("list.nodes.domain",e)},e.prototype.loadTag=function(e){return this.loadFunction("list.nodes.tag",e)},e.prototype.remove=function(e){return this.execute("remove.node",{value:e})},e.prototype.addFavorite=function(e){return this.execute("add.node.favorites",{value:e})},e.prototype.hasFavorite=function(e){return this.execute("has.node.favorites",{value:e}).then(function(e){return e.more})},e.prototype.removeFavorite=function(e){return this.execute("remove.node.favorites",{value:e})},e.prototype.addNodeVisit=function(e){return this.execute("add.nodes.visits",{nodes:[{visited:(new Date).toISOString(),value:e}]})},e.prototype.related=function(e,t){var n=this;void 0===t&&(t=!1);var r=this.relatedCache.get(e);return r?this.$q.when(r):this.GApi.execute("user","nodes.related",{query:e,limit:20,isArticle:t}).then(function(t){if(t&&t.nodes)return n.addNodesShared(t.nodes),r=n.mapNodesShared(t.nodes,!1),n.relatedCache.put(e,r),r})},e.prototype.googleSearch=function(e){var t=this;return this.GApi.execute("user","google.search",{query:e}).then(function(e){return t.nodesResponseShared(e)})},e.prototype.linkedNodes=function(e){var t=this;return this.GApi.execute("user","nodes.linked",{value:e}).then(function(e){return t.nodesResponseShared(e)})},e.prototype.mapNodesShared=function(e,t){var n=this;return void 0===t&&(t=!0),e.map(function(e){return new n.NodeMeta(e.value,t)})},e.prototype.nodesResponseShared=function(e){if(e&&e.nodes)return this.addNodesShared(e.nodes),this.mapNodesShared(e.nodes,!1)},e.prototype.getNodes=function(e){return this.$q.when()},e.prototype.execute=function(e,t){var n=this,r=n.GApi;return n.GApiApp.execute(function(){return r.executeAuth("user",e,t)})},e.prototype.loadFunction=function(e,t){var n=this,r=this,o=r.$q,i=r.GApi;r.util;if(this.upadteLoadState())return o.reject();var a=this.state.pageToken,s=this.util.getUserLanguage();return i.execute("user",e,{pageToken:a,query:t,lang:s}).then(function(e){return n.addNodes(e),n.container.notifyObservers(),e.modified}).finally(function(){return n.cleanLoadState()})},e}();e.value("nodesSharedStatic",n);var r=function(){function e(e,t,n,r,o,i){this.$rootScope=e,this.GApi=t,this.GData=n,this.GApiApp=r,this.toastObserver=o,this.BASE_URL=i}return e.prototype.login=function(){var e=this;return this.GApiApp.execute(function(){return e.GApi.executeAuth("user","pocket.login")}).then(function(t){location.href="https://getpocket.com/auth/authorize?request_token="+t.access_token+"&redirect_uri="+encodeURIComponent(e.BASE_URL)})},e.prototype.add=function(e){var t=this,n=function(){return t.GApiApp.execute(function(){return t.GApi.executeAuth("user","pocket.add",{value:e})}).then(function(){return t.toastObserver.notifyObservers("Added to Pocket")},function(e){if(e&&403==e.code)return t.login()})};return this.GData.isLogin()?n():this.$rootScope.login().then(n)},e}();e.value("pocketSharedStatic",r);var o=function(){function e(e,t,n,r,o,i,a,s,c,u,l,d){this.$q=e,this.GApi=t,this.$queueFactory=n,this.TreesMetaContainer=r,this.OrderedHash=o,this.Trees=i,this.TreeMeta=a,this.TreeMetaProxy=s,this.TreesMeta=c,this.ObservableClass=u,this.groupCtrl=l,this.util=d,this.treesContainer=new this.Trees,this.treesMetaContainer=new this.TreesMeta,this.pinnedTreesContainer=new this.OrderedHash,this.quotaObserver=this.ObservableClass(),this.pinnedTreesObserver=this.ObservableClass(),this.commandQueue=this.$queueFactory(),this.MAX_PINNED=100,this.isOverQuota=!1,this.state={more:!0,pageToken:"",loading:!1,offset:0,treeLoading:!1,nodes:[],noNodesFound:!1,treesPageToken:"",treesMore:!1,viewState:{session:0,favorites:0,published:0,feed:0}}}return e.prototype.updateContainer=function(e,t){if(!this.groupCtrl.treesSearch.isSearch()&&!this.groupCtrl.disableSort){var n=this.groupCtrl,r=n.sortBy,o=n.sortOrder,i=n.reverse,a=this.groupCtrl.type[r];this.treesMetaContainer.updateContainer(e,t,r,a,o,i)}},e.prototype.getTreeMeta=function(e){return this.TreesMetaContainer.get(e)},e.prototype.addToContainer=function(e,t){var n=this;t.forEach(function(t){var r=t.id,o=new n.TreeMeta(r,t);o.pinned=!0,n.TreesMetaContainer.put(r,o),e.put(r,new n.TreeMetaProxy(r))})},e.prototype.addPinned=function(e){var t=e&&e.trees;t&&this.addToContainer(this.pinnedTreesContainer,t),this.pinnedTreesObserver.notifyObservers()},e.prototype.addTree=function(e,t){void 0===t&&(t=e.id);var n=this,r=n.TreesMetaContainer,o=n.treesMetaContainer;if(t){var i=new this.TreeMeta(t,e);o.hasKey(t)||o.put(t,new this.TreeMetaProxy(t)),r.hasKey(t)?this.getTreeMeta(t).update(i):r.put(t,i)}},e.prototype.addTrees=function(e){var t=this;if(e){var n=this.state;n.pageToken=e.pageToken,n.treesPageToken=e.treesPageToken,n.more=e.more,n.treesMore=e.treesMore,n.nodes=e.nodes,n.noNodesFound=e.noNodesFound,angular.forEach(e.trees,function(e){return t.addTree(e)})}},e.prototype.addTreeObject=function(e,t){var n=this.treesContainer;n.hasKey(e.id)||(e.sync=parseInt(t.sync||"0"),e.userId=t.userId,e.plusId=t.plusId,e.isReposted=t.isReposted,e.editors=t.editors||[],e.limitedEdit=t.limitedEdit,e.editable=t.editable,n.add(t,e))},e.prototype.newTree=function(e){var t=this,n=t.TreesMetaContainer,r=t.treesMetaContainer,o=this.groupCtrl,i=o.sortBy,a=o.sortOrder,s=o.reverse,c=this.groupCtrl.type[i],u=e.id,l=new this.TreeMeta(u,e),d=r.addNew(l,c,a);d&&!r.hasKey(u)&&(n.put(u,l),r.put(u,new this.TreeMetaProxy(u)),r.resort(s),r.notifyObservers()),d||(this.state.more=!0)},e.prototype.newLink=function(e,t,n){void 0===n&&(n=!0);var r=e.link,o=e.tree,i=e.timestamp,a=o.id,s=new Date(i),c=this.treesContainer.getTree(a);if(!(c&&c.isOpened)){t&&this.addTree(o,a);var u=this.getTreeMeta(a);if(u&&(u.newLinks+=1,u.modified=s),n){var l=this.Trees.getStack(a);if(l){var d=this.Trees.newLink(r.parent,r.child,s);l.newLink(d).execute()}}this.updateContainer(a,["modified"])}},e.prototype.clearTrees=function(){var e=this,t=this,n=t.state,r=t.pinnedTreesContainer;n.more=!0,n.pageToken="",n.treesPageToken="",n.treesMore=!1,n.nodes=[],n.noNodesFound=!1,n.loading=!1,n.offset=0,this.treesMetaContainer.clear(),this.TreesMetaContainer.keepIf(function(t){var n=t.key;return r.hasKey(n)||n==e.linkedTreeKey})},e.prototype.updateViewState=function(e,t){void 0===t&&(t=!0);var n=t?1:-1;this.state.viewState[e]+=n},e.prototype.requestTrees=function(e,t,n){var r=this.state;return{userId:e.userId,plusId:e.plusId,query:n,reverse:t.reverse,sortBy:t.sortBy,pageToken:r.pageToken,favorite:e.favorite,published:e.published,treesPageToken:r.treesPageToken,more:r.more,treesMore:r.treesMore,nodes:r.nodes,noNodesFound:r.noNodesFound,lang:this.util.getUserLanguage()}},e.prototype.addTreeCallback=function(e){var t=this;return function(){e.loading=!1,e.seen=!0,t.state.treeLoading=!1}},e.prototype.addTreePrecall=function(e){e.loading=!0,this.state.treeLoading=!0},e.prototype.loadCallback=function(e){this.addTrees(e),this.treesMetaContainer.notifyObservers()},e.prototype.report=function(e,t){return this.GApi.execute("user","report",{tree:e,reason:t})},e.prototype.isPinDisabled=function(){return this.pinnedTreesContainer.size>=this.MAX_PINNED},e.prototype.pinTree=function(e){var t=this.pinnedTreesContainer,n=t.values(),r=this.getTreeMeta(e);r.pinned=!0,r.loading=!1,t.clear(),t.put(e,new this.TreeMetaProxy(e)),n.forEach(function(e){return t.put(e.key,e)}),this.pinnedTreesObserver.notifyObservers()},e.prototype.unpinTree=function(e){var t=this.getTreeMeta(e);t.pinned=!1,t.loading=!1,this.pinnedTreesContainer.remove(e),this.pinnedTreesObserver.notifyObservers()},e.prototype.moveTree=function(e,t){var n=this.pinnedTreesContainer,r=n.values(),o=n.findIndex(function(t){return t.key==e});n.clear(),r.splice(t,0,r.splice(o,1)[0]),r.forEach(function(e){return n.put(e.key,e)}),this.pinnedTreesObserver.notifyObservers()},e.prototype.pin=function(e){return this.$q.when()},e.prototype.unpin=function(e){return this.$q.when()},e.prototype.move=function(e,t){return this.$q.when()},e.prototype.getTree=function(e,t){return this.$q.when()},e.prototype.searchTreesByMeta=function(e,t,n){return this.$q.when()},e.prototype.load=function(e,t){return this.$q.when()},e.prototype.loadDomain=function(e){return this.$q.when()},e.prototype.loadTag=function(e){return this.$q.when()},e.prototype.add=function(e,t){return this.$q.when()},e.prototype.updateTree=function(e,t,n,r){return this.$q.when()},e.prototype.removeTree=function(e){return this.$q.when()},e.prototype.editTree=function(e){return this.$q.when()},e.prototype.editImage=function(e){return this.$q.when()},e.prototype.sync=function(e){return this.$q.when()},e.prototype.togglePublished=function(e){return this.$q.when()},e.prototype.toggleFavorite=function(e){return this.$q.when()},e.prototype.addTag=function(e,t){return this.$q.when()},e.prototype.removeTag=function(e,t){return this.$q.when()},e.prototype.addEditor=function(e,t){return this.$q.when()},e.prototype.removeEditor=function(e,t){return this.$q.when()},e.prototype.loadFeed=function(){return this.$q.when([])},e.prototype.loadShared=function(){return this.$q.when()},e.prototype.loadRecommended=function(){return this.$q.when()},e.prototype.upadteLoadState=function(){var e=this.state;if(e.loading)return!0;e.loading=!0},e.prototype.cleanLoadState=function(){this.state.loading=!1},e.prototype.createUpdateCommandObject=function(e,t,n,r,o,i){return void 0===r&&(r=!1),void 0===o&&(o=!0),void 0===i&&(i=""),{type:t.getAPIMethod(r),value:t.toJSON({id:e,modified:n.toISOString(),updateCount:o,token:i,domains:this.treesContainer.getTree(e).getDomains()})}},e.createEditCommandObject=function(e,t,n){return void 0===n&&(n=""),{type:"edit.tree",value:{id:e,title:t.title,description:t.description,modified:(new Date).toISOString(),token:n}}},e.createPublishCommandObject=function(e,t){return{type:"publish.tree",value:{id:e,published:t.published,modified:(new Date).toISOString()}}},e.createFavoriteCommandObject=function(e,t){return{type:"favorite.tree",value:{id:e,favorite:t.favorite,modified:(new Date).toISOString()}}},e}();e.value("treesSharedStatic",o);var i=function(){function e(e,t,n,r,o,i,a,s,c,u,l,d,p,m,f,g,h){this.$rootScope=e,this.$cacheFactory=t,this.$q=n,this.$window=r,this.$interval=o,this.GApi=i,this.GApiApp=a,this.facebook=s,this.pocket=c,this.itunes=u,this.Users=l,this.OrderedSet=d,this.ObservableClass=p,this.util=m,this.FB_ID=f,this.API_KEY=g,this.placeholderImage=h,this.usersContainer=new this.Users,this.usersCache=this.$cacheFactory("users",{capacity:100}),this.recentUserIds=new this.OrderedSet,this.recentUsers={},this.userLoginObserver=this.ObservableClass(),this.bookmarksObserver=this.ObservableClass(),this.maxRecentUsers=5,this.hasRatedApp=!1,this.userSubscriptions={subscribers:0,subscriptions:0},this.userCollections={},this.userPublishedDomains={pageToken:"",more:!0,loading:!1},this.plus_share="https://plus.google.com/share?url=",this.facebook_share="https://www.facebook.com/dialog/share?",this.twitter_share="https://twitter.com/intent/tweet?"}return e.prototype.login=function(e){var t=this;return this.simple_login().then(function(e){return t.loginUser(e),t.userInfo()})},e.prototype.load=function(){var e=this,t=this.usersContainer;return t.loading?this.$q.when():(t.loading=!0,this.facebook.listFriends(t.pageToken).then(function(t){return e.store(t)}).finally(function(){return t.loading=!1}))},e.prototype.storeSubscriptions=function(e){var t=this.usersContainer;if(t.pageToken=e.pageToken,t.more=e.more,e.users)return this.getUsers(e.users).then(function(e){e.forEach(function(e){return t.put(e.id||e.plusId,e)}),t.notifyObservers()})},e.prototype.store=function(e){var t=this.usersContainer,n=e.paging&&e.paging.next;t.pageToken=n,t.more=!!n,e.data.forEach(function(e){t.put(e.id,e)}),t.notifyObservers()},e.prototype.loginUser=function(e){this.$rootScope.user=e,this.userLoginObserver.notifyObservers()},e.prototype.logoutUser=function(){this.$rootScope.user=null,this.userLoginObserver.notifyObservers()},e.prototype.addRecent=function(e){var t=e&&(e.id||e.plusId),n=this.recentUserIds,r=this.recentUsers;if(t&&!n.contains(t)){if(n.add(t),r[t]=e,n.size>this.maxRecentUsers){var o=n.toArray()[0];n.remove(o),r[o]=null}return n.map(function(e){return r[e]}).reverse()}},e.prototype.getTrending=function(){var e=this;return this.GApi.execute("user","get.trending",{lang:this.util.getUserLanguage()}).then(function(t){return e.$rootScope.trending=t})},e.prototype.getPlusUser=function(t){return this.GApi.execute("plus","people.get",{userId:t,key:this.API_KEY}).then(e.makePlusUserObject)},e.prototype.getPlusUsers=function(t){var n=this;if(t.length){var r=gapi.client.newBatch(),o=this.$q.defer();return t.forEach(function(e){r.add(gapi.client.request({path:"plus/v1/people/get",params:{userId:e,key:n.API_KEY}}))}),r.execute(function(t){var n=Object.values(t).map(function(t){return e.makePlusUserObject(t.result)});o.resolve(n)}),o.promise}},e.prototype.getUsers=function(e){var t=this,n={},r={},o=[],i=[],a=[];return e.forEach(function(e,s){var c=e.userId,u=e.plusId;if(u){var l=t.usersCache.get(u);return void(l?a[s]=l:(r[u]=s,-1==i.indexOf(u)&&i.push(u)))}if(c){var l=t.usersCache.get(c);l?a[s]=l:(n[c]=s,-1==o.indexOf(c)&&o.push(c))}}),this.$q.all({fb:this.facebook.getUsers(o),plus:this.getPlusUsers(i)}).then(function(e){return e.fb&&e.fb.forEach(function(e){if(e){var r=n[e.id];a[r]=e,t.usersCache.put(e.id,e)}}),e.plus&&e.plus.forEach(function(e){if(e){var n=r[e.plusId];a[n]=e,t.usersCache.put(e.plusId,e)}}),a})},e.prototype.getUser=function(e){var t=this,n=e.userId,r=e.plusId,o=e.user;if(o)return this.$q.when(o);var i,a={id:n,plusId:r,name:"Error",picture:{data:{url:this.placeholderImage}}};return n&&(o=this.usersCache.get(n)),!o&&r&&(o=this.usersCache.get(r)),o?this.$q.when(o):(n?i=this.facebook.getUser(n).then(function(e){return e},function(){return r?t.getPlusUser(r):t.$q.reject()}):r&&(i=this.getPlusUser(r)),i?i.then(function(e){return e},function(){return a}).then(function(e){return t.usersCache.put(e.id||e.plusId,e),e}):this.$q.reject())},e.prototype.getAmazonProducts=function(e){return this.GApi.execute("user","amazon.search",{query:e.getKeywords()}).then(function(e){return e.products})},e.prototype.getEbayProducts=function(e){return this.GApi.execute("user","ebay.search",{query:e.getEbayKeywords()}).then(function(e){return e.products})},e.prototype.getITunesProducts=function(e){return this.itunes.search(e.getKeywords())},e.prototype.sharePocket=function(e){this.pocket.add(e)},e.prototype.shareGoogle=function(e){this.$window.open(this.plus_share+encodeURI(e),"_blank","menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600")},e.prototype.shareFacebook=function(e){this.$window.open(this.facebook_share+"app_id="+this.FB_ID+"&display=popup&href="+encodeURI(e),"_blank","menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600")},e.prototype.shareTwitter=function(e){this.$window.open(this.twitter_share+"via=getbrancher&url="+encodeURI(e),"_blank","menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600")},e.prototype.subscribeUser=function(e){var t=this;return this.GApiApp.execute(function(){return t.GApi.executeAuth("user","subscribe.user",{plusId:e.plusId,userId:e.id})})},e.prototype.unsubscribeUser=function(e){var t=this;return this.GApiApp.execute(function(){return t.GApi.executeAuth("user","unsubscribe.user",{plusId:e.plusId,userId:e.id})})},e.prototype.isSubscribed=function(e){var t=this;return this.GApiApp.execute(function(){return t.GApi.executeAuth("user","subscribe.info",{plusId:e.plusId,userId:e.id})})},e.prototype.loadSubscribers=function(e){var t=this,n=this.usersContainer;return n.loading?this.$q.when():(n.loading=!0,this.GApiApp.execute(function(){return t.GApi.executeAuth("user","list.subscribers",{pageToken:n.pageToken,user:e})}).then(function(e){return t.storeSubscriptions(e)}).finally(function(){return n.loading=!1}))},e.prototype.loadSubscriptions=function(e){var t=this,n=this.usersContainer;return n.loading?this.$q.when():(n.loading=!0,this.GApiApp.execute(function(){return t.GApi.executeAuth("user","list.subscriptions",{pageToken:n.pageToken,user:e})}).then(function(e){return t.storeSubscriptions(e)}).finally(function(){return n.loading=!1}))},e.prototype.publishDomain=function(e){var t=this;return this.GApiApp.execute(function(){return t.GApi.executeAuth("user","add.publish.domain",{url:e})})},e.prototype.unpublishDomain=function(e){var t=this;return this.GApiApp.execute(function(){return t.GApi.executeAuth("user","remove.publish.domain",{url:e})})},e.prototype.listPublishDomains=function(){var e=this,t=this.userPublishedDomains;return t.loading?this.$q.when([]):(t.loading=!0,this.GApiApp.execute(function(){return e.GApi.executeAuth("user","list.publish.domain",{pageToken:t.pageToken})}).then(function(e){return t.more=e.more,t.pageToken=e.pageToken,e.nodes}).finally(function(){return t.loading=!1}))},e.prototype.clearPublishDomains=function(){var e=this.userPublishedDomains;e.loading=!1,e.pageToken="",e.more=!0},e.prototype.complain=function(e,t){var n=this;return this.GApiApp.execute(function(){return n.GApi.executeAuth("user","complain",{rating:e,complaint:t})})},e.prototype.addTag=function(e){var t=this;return this.GApiApp.execute(function(){return t.GApi.executeAuth("user","add.tag",{name:e.name})})},e.prototype.addDomian=function(e){var t=this;return this.GApiApp.execute(function(){return t.GApi.executeAuth("user","add.domain",{name:e.name})})},e.prototype.showInvite=function(){return this.usersContainer.isEmpty()&&!this.usersContainer.more&&this.facebook.status},e.prototype.logout=function(){return this.$q.when()},e.prototype.logoutShared=function(e){return this.$q.when()},e.prototype.simple_login=function(){return this.$q.when({})},e.prototype.userInfo=function(e){return this.$q.when()},e.prototype.userSetup=function(){return this.$q.when()},e.prototype.loginFirebase=function(e){return this.$q.when()},e.prototype.loginYoutube=function(){return this.$q.when("")},e.prototype.onLinks=function(e){return angular.noop},e.prototype.onFeed=function(e){return angular.noop},e.makePlusUserObject=function(e){if(e&&e.id)return e.name=e.displayName,e.picture={data:{url:e.image&&e.image.url}},e.plusId=e.id,e.id=null,e},e}();e.value("usersSharedStatic",i);var a=function(){function e(e){this.BASE_URL=e}return e.prototype.createPlayer=function(e,t,n){this.player=new YT.Player(e,{events:{onError:n,onStateChange:function(e){return t(e.data)}}})},e.prototype.getFrameUrl=function(e){return"https://www.youtube.com/embed/"+e+"?enablejsapi=1&autoplay=1&origin="+this.BASE_URL},e.prototype.destroy=function(){this.player&&this.player.destroy(),this.player=null},e.prototype.loadVideoById=function(e){this.player.loadVideoById({videoId:e})},e}();e.value("youtubeIFrameSharedStatic",a)}(angular.module("tnDataShared",["tnClasses","tnConfig","tnDataFacebook"])),function(e){"use strict";e.factory("GApi",["$q","GClient","GData","$window",function(e,t,n,r){function o(e,t,n,r,o){var i={};i.api=e,i.apiLoad=!1,i.method=t,i.params=n,i.auth=r,i.deferred=o,p.push(i)}function i(n,o,i){var s=e.defer();return t.get().then(function(){r.gapi.client.load(n,o,void 0,i).then(function(e){var t={api:n,version:o,url:i};e&&e.hasOwnProperty("error")?(console.log(o),s.reject(t)):(s.resolve(t),d.push(n),a(n))})}),s.promise}function a(e){for(var t=e,r=0;r<p.length;r++){var o=p[r];o.api!=t&&!o.apiLoad||0!=o.auth&&1!=n.isLogin()?o.api==t&&(p[r].apiLoad=!0):(c(o.api,o.method,o.params,o.deferred),r>-1&&p.splice(r--,1))}}function s(e,t,n){for(var o=t.split("."),e=r.gapi.client[e],i=0;i<o.length;i++)e=e[o[i]];return e(n)}function c(e,t,n,r){s(e,t,n).execute(function(e){e.error?r.reject(e):r.resolve(e)})}function u(t,n,r,i){var a=e.defer();return d.indexOf(t)>-1?c(t,n,r,a):o(t,n,r,i,a),a.promise}function l(t,n){function r(e,t){e.apply(this,n).then(function(e){o.resolve(e)}).catch(function(n){if(403==n.code&&n.message.toLowerCase().indexOf("limit exceeded")>-1||503==n.code){var i=Math.floor(1e3*Math.random()+1);t<5?setTimeout(function(){r(e,++t)},1e3*Math.pow(2,t)+i):o.reject(n)}else o.reject(n)})}var o=e.defer();return r(t,0),o.promise}var d=[],p=[];return{executeCallbacks:function(){a()},load:i,createRequest:s,execute:function(e,t,n){return 3==arguments.length?u(e,t,n,!1):2==arguments.length?u(e,t,null,!1):void 0},executeAuth:function(e,t,n){return 3==arguments.length?l(u,arguments):2==arguments.length?l(u,arguments):void 0}}}]),e.factory("GAuth",["$rootScope","$q","GClient","GApi","GData","$interval","$window","$location",function(e,t,n,r,o,i,a,s){function c(){var e=t.defer();return 0==m?n.get().then(function(){a.gapi.client.load("oauth2","v2",function(){m=!0,e.resolve()})}):e.resolve(),e.promise}function u(e,t){function n(e,t){var n={client_id:p,scope:g,immediate:!1,response_type:h};e&&(n.user_id=o.getUserId(),n.immediate=!0),void 0!=f&&(n.hd=f),a.gapi.auth.authorize(n,t)}e||!0!==m?c().then(function(){n(e,t)}):n(e,t)}function l(){function e(t){if("https://accounts.google.com"===t.origin){var o=JSON.parse(t.data);a.removeEventListener("message",e),o=n(o.a[0],"code"),void 0==o?r.reject():r.resolve(o)}}function n(e,t){t=t.replace(/[[]/,"[").replace(/[]]/,"]");var n=t+"=([^&#]*)",r=new RegExp(n),o=r.exec(e);return null==o?void 0:o[1]}var r=t.defer(),o=s.protocol()+"//"+s.hostname();(""!=s.port()||443!=s.port()&&"https"==s.protocol())&&(o=o+":"+s.port());a.open("https://accounts.google.com/o/oauth2/auth?scope="+encodeURI(g)+"&redirect_uri=postmessage&response_type=code&client_id="+p+"&access_type=offline&approval_prompt=force&origin="+o,null,"width=800, height=600");return a.addEventListener("message",e),r.promise}function d(){var e=t.defer();return a.gapi.client.oauth2.userinfo.get().execute(function(t){t.code?e.reject():(o.isLogin(!0),r.executeCallbacks(),t.name&&0!==t.name.length||(t.name=t.email),o.getUser(t),e.resolve(t))}),e.promise}var p,m=!1,f=void 0,g="https://www.googleapis.com/auth/userinfo.email",h="token id_token";return{setClient:function(e){p=e},setDomain:function(e){f=e},setScope:function(e){g=e},load:c,checkAuth:function(){var e=t.defer();return u(!0,function(){d().then(function(t){e.resolve(t)},function(){e.reject()})}),e.promise},login:function(){var e=t.defer();return u(!1,function(){d().then(function(t){e.resolve(t)},function(){e.reject()})}),e.promise},setToken:function(e){var n=t.defer();return c().then(function(){a.gapi.auth.setToken(e),d().then(function(){n.resolve()},function(){n.reject()})}),n.promise},getToken:function(){var e=t.defer();return c().then(function(){e.resolve(a.gapi.auth.getToken())}),e.promise},logout:function(){var e=t.defer();return c().then(function(){a.gapi.auth.setToken(null),o.isLogin(!1),o.getUser(null),e.resolve()}),e.promise},offline:function(){var e=t.defer();return l().then(function(t){e.resolve(t)},function(){e.reject()}),e.promise}}}]),e.factory("GClient",["$document","$q","$window","$timeout",function(e,t,n,r){function o(o){var i=t.defer();n._gapiOnLoad=function(){i.resolve()};var a=e[0].createElement("script");return a.onerror=function(e){r(function(){i.reject(e)})},a.src=o,e[0].body.appendChild(a),i.promise}var i=!1,a=!1,s=null,c=[];return{get:function(){var e=t.defer();return i?e.resolve():a?c.push(e):(a=!0,o("https://apis.google.com/js/client.js?onload=_gapiOnLoad").then(function(){n.gapi.client.setApiKey(s),i=!0,a=!1,e.resolve();for(var t=0;t<c.length;t++)c[t].resolve()})),e.promise},setApiKey:function(e){s=e,i&&n.gapi.client.setApiKey(s)},getApiKey:function(){return s}}}]),e.factory("GData",["$rootScope",function(e){e.gapi={};var t=!1,n=null,r=null;return{getUserId:function(){return r},setUserId:function(e){r=e},isLogin:function(n){if(0==arguments.length)return t;t=n,e.gapi.login=n},getUser:function(e){if(0==arguments.length)return n;n=e,null!==e&&(r=e.id)}}}])}(angular.module("angular-google-gapi",[])),function(e){e.value("URI",n(14)),e.factory("uriParser",["URI","AMAZON_ID","EBAY_CAMPID","ITUNES_TOKEN",function(e,t,n,r){function o(e){return"amazon"==e}function i(e){return"ebay"==e}function a(e){return"itunes.apple.com"==e||"geo.itunes.apple.com"==e}var s={},c=e("http://rover.ebay.com/rover/1/711-53200-19255-0/1"),u={google:"q",yahoo:"p",bing:"q",yandex:"text",duckduckgo:"q"},l={google:"/search",yahoo:"/search",bing:"/search",yandex:"/search/",duckduckgo:""},d={google:"www.google.com",yahoo:"www.yahoo.com",bing:"www.bing.com",yandex:"www.yandex.com",duckduckgo:"www.duckduckgo.com"},p={google:"https://www.google.com.ua/images/branding/product/ico/googleg_lodp.ico",yahoo:"https://www.google.com/s2/favicons?domain=www.yahoo.com",bing:"https://www.google.com/s2/favicons?domain=www.bing.com",yandex:"https://www.google.com/s2/favicons?domain=www.yandex.com",duckduckgo:"https://www.google.com/s2/favicons?domain=www.duckduckgo.com"},m=["/","/feed/subscriptions","/feed/trending","/feed/history","/dashboard","/my_videos","/view_all_playlists","/live_dashboard_splash","/my_live_events","/analytics","/timedtext_cs_queue","/upload"];return s.parseSERP=function(t){var n,r=t.domain(),o=t.host(),i={};if(i.isSERP=!1,-1!=r.indexOf("google")&&-1!=o.indexOf("www.google")?i.SE="google":-1!=r.indexOf("yahoo.com")?"www.yahoo.com"!=o&&-1==o.indexOf("search")||(i.SE="yahoo"):-1!=r.indexOf("bing.com")?i.SE="bing":-1!=o.indexOf("www.yandex")?i.SE="yandex":-1!=r.indexOf("duckduckgo")&&(i.SE="duckduckgo"),n=i.SE){var a=t.query(!0),s=t.fragment(),c=u[n];i.isSERP=!0,i.favicon=p[n],angular.merge(a,e.parseQuery(s));var m=a[c];if(m){i.title=e.decodeQuery(m);(i.query={})[c]=m,i.path=l[n],i.hostname=d[n]}}return i},s.parseImg=function(t,n){if(t){if("data:image"==t.slice(0,10))return t;var r=e(t.trim());return r.protocol()?t:(r.is("absolute")?r.protocol(n.protocol()):r.is("relative")&&(r=n.clone().path(t)),r.toString())}},s.applySERP=function(t,n,r){var o=r&&r.value;if(n.isSERP){if(!n.query)return e("");r&&(r.value={type:"web search",title:n.title.charAt(0).toUpperCase()+n.title.substring(1),image:o&&o.image,favicon:n.favicon,description:o&&o.description}),t.fragment("").hostname(n.hostname).search(n.query).path(n.path)}return t},s.sortQuery=function(e){var t=e.search(!0);e.search(""),angular.forEach(Object.keys(t).sort(),function(n){e.addSearch(n,t[n])})},s.isAffiliate=function(e){var t=e.domain().split(".")[0];return o(t)||i(t)||a(e.host())},s.makeAffiliateLink=function(e){var s=e.domain().split(".")[0],u=e;if(o(s)){var l=e.path().split("/"),d=e.query(!0);"s"==l[1]?e.path("/s").fragment("").query({url:"search-alias=aps","field-keywords":d["field-keywords"]}):(e.query("").fragment(""),"ref"==l[l.length-1].slice(0,3)&&e.path(l.slice(0,l.length-1).join("/"))),u=e.removeSearch("tag").addSearch("tag",t)}else if(i(s)){var p=e.host().split(".");u="rover"==p[0]?e.setSearch("campid",n).setSearch("toolid","10001"):c.clone().query({mpre:e.toString(),campid:n,toolid:"10001"})}else if(a(e.host())){var d=e.query(!0),m=d.i,f=d.mt,g={at:r};m&&(g.i=m),f&&(g.mt=f),u=e.host("geo.itunes.apple.com").query(g).fragment("")}return u},s.parseFacebook=function(t){if("www.facebook.com"==t.host()){var n=t.path(),r=n.split("/").filter(function(e){return!!e});if(!n||"/"==n||"/dialog/share"==n||"/photo.php"==n||"feed"==r[0]||"photos"==r[1])return e("");var o=t.query(!0),i=o.id,a=o.q;if(t.query(""),i&&t.addSearch("id",i),a&&t.addSearch("q",a),!i&&!a){var s="pg"==r[0];if("groups"==r[0]||"events"==r[0]||s)if(s)t.path("/"+r[1]);else{if(!r[1])return e("");t.path("/"+r[0]+"/"+r[1])}else t.path("/"+r[0])}}return t},s.parseYoutube=function(t){if("www.youtube.com"==t.host()){var n=t.path(),r=n.split("/").filter(function(e){return!!e});if(!n||m.indexOf(n)>-1)return e("");var o=t.query(!0),i=o.v,a=o.list,s=o.search_query||o.q;t.query(""),i&&t.addSearch("v",i),!i&&a&&t.addSearch("list",a),s&&t.addSearch("search_query",s),("user"==r[0]||"channel"==r[0])&&r.length>2&&t.path("/"+r[0]+"/"+r[1])}return t},s.parse=function(t,n){if("http"!=t.protocol().slice(0,4)||"jpg"==t.suffix()||"plus.google.com"==t.host()&&"/share"==t.path())return e("");var r=s.parseSERP(t);return t.removeSearch("brancher.io").normalize(),t=s.parseFacebook(t),t=s.parseYoutube(t),t=s.applySERP(t,r,n),s.sortQuery(t),t},s.getFacebookId=function(e){var t=e.path().split("/").filter(function(e){return!!e}),n="search"!=t[0]&&t[t.length-1];return e.query(!0).id||n},s}])}(angular.module("URIjs",[])),function(e){e.service("urlShortener",["$q","$http","$cacheFactory","$timeout","URI","API_KEY","SECONDARY_API_KEY",function(e,t,n,r,o,i,a){var s=this,c=s.cache=n("shortURL"),u="https://www.googleapis.com/urlshortener/v1/url",l=["AIzaSyDZ55puWPWIO2zobjnTKOCqBGgPaAy4Z84","AIzaSyCjEGKTgmYGTXI3NpLlo3Mf1dBqoryXdLI","AIzaSyBcHHVlKWr86BZKMoV4jkkn5n8FmKVWvYM","AIzaSyAJmJFAc0MrjNHK0Nolqwc0gxYX68gAUkk","AIzaSyDFSHG8nWrzCpW5U1dzj54WrfUPk9nfIZY","AIzaSyCkAIvQSBjLy_7Bm1tzbMGyXg_5mSeM1Zc","AIzaSyC24Zk19799bLRiiroB0_gy09uETSa2ADo","AIzaSyCGPK41uA6eb0LG0ahnV0qO98dcZlMTTMk","AIzaSyCyFGi0QfAMj4gNu9T4-1n5SOVSVfnRmEk","AIzaSyD_Po1pyDxSooiBMDuxCX9G68M1bOaXaaQ","AIzaSyCtExBA-lGdpKX1CeklHeHOprk4SrOdi-g","AIzaSyDlN44efeKER1U0DB0QCssiQacfrga6xy4"];s.shortenUrl=function(n,a,d){void 0===a&&(a=i),void 0===d&&(d=[]);var p=c.get(n);return p?e.when(p):t.post(u+"?key="+a,{longUrl:n}).then(function(t){return t.data&&t.data.id?(p=o(t.data.id).path().slice(1),c.put(n,p),p):e.reject()},function(t){if(403==t.status){var o=l.filter(function(e){return-1===d.indexOf(e)});if(o.length){var i=Math.floor(Math.random()*o.length),a=o[i];return d.push(a),r(1e3).then(function(){return s.shortenUrl(n,a,d)})}}return e.reject()})},s.analytics=function(e){return t.get(u,{params:{key:a,shortUrl:"http://goo.gl/"+e,projection:"FULL"}}).then(function(e){return e.data})}}])}(angular.module("tnUrlShortener",["tnConfig","angular-google-gapi","URIjs"])),function(e){e.config(["$provide",function(e){e.factory("GApiApp",["$q","GAuth",function(e,t){var n={};return n.execute=function(n){return n().then(function(e){return e},function(r){return 401==r.code?t.checkAuth().then(n):e.reject()})},n}]),e.factory("trees",["treesAPIStatic",function(e){return new e}]),e.factory("nodes",["nodesAPIStatic",function(e){return new e}]),e.factory("users",["usersAPIStatic",function(e){return new e}]),e.factory("facebook",["facebookAPIStatic",function(e){return new e}]),e.factory("pocket",["pocketAPIStatic",function(e){return new e}]),e.factory("bufferService",["bufferAPIStatic",function(e){return new e}]),e.factory("youtubeIFrame",["youtubeIFrameAPIStatic",function(e){return new e}])}]).run(["GApi",function(e){e.load("kgsearch","v1"),e.load("plus","v1")}]);var t=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();e.factory("bufferAPIStatic",["$httpParamSerializerJQLike","GApi","GApiApp","users","URI","BUFFER_ID","BUFFER_REDIRECT_URI","bufferSharedStatic",function(e,n,r,o,i,a,s,c){return function(c){function u(){return c.call(this,e,n,r,o,i,a,s)||this}return t(u,c),u}(c)}]);var t=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();e.factory("nodesAPIStatic",["$q","$cacheFactory","GApi","GApiApp","URI","OrderedHash","NodeMeta","ObservableClass","Nodes","OrderedContainer","uriParser","util","nodesConfig","BASE_URL","nodesSharedStatic",function(e,n,r,o,i,a,s,c,u,l,d,p,m,f,g){return function(g){function h(){return g.call(this,e,n,r,o,i,d,a,s,u,c,l,p,m.listCtrl,f)||this}return t(h,g),h}(g)}]);var t=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();e.factory("pocketAPIStatic",["$rootScope","GApi","GData","GApiApp","toastObserver","BASE_URL","pocketSharedStatic",function(e,n,r,o,i,a,s){return function(s){function c(){return s.call(this,e,n,r,o,i,a)||this}return t(c,s),c}(s)}]);var t=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();e.factory("treesAPIStatic",["$q","$rootScope","$queueFactory","GApi","GData","GApiApp","firebaseService","nodes","facebook","OrderedHash","TreesMetaContainer","TreeMetaProxy","Trees","TreesMeta","Tree","TreeMeta","ObservableClass","util","linkEvent","treesSharedStatic",function(e,n,r,o,i,a,s,c,u,l,d,p,m,f,g,h,v,y,b,k){function C(e){var t=e.type,n=e.value;return i.isLogin()?a.execute(function(){return o.executeAuth("user",t,n)}):o.execute("user",t,n)}function w(e){var t=e.type,n=e.value;return i.isLogin()?a.execute(function(){return o.executeAuth("tree",t,n)}):o.execute("tree",t,n)}var _=n.groupCtrl;return function(n){function c(){return n.call(this,e,o,r,d,l,m,h,p,f,v,_,y)||this}return t(c,n),c.prototype.getTree=function(t,n){var r=this,o=n.id,i=this.state;if(n.loading||this.treesContainer.hasKey(o)||i.treeLoading)return e.reject();var a=function(){return w({type:"get.tree",value:{id:o,token:t.shared?u.getAccessToken():"",pinned:t.pinned}}).then(function(e){return r.addTreeObject(n,e)}).finally(r.addTreeCallback(n))};return this.addTreePrecall(n),t.shared?u.executeAPIMethod(a):a()},c.prototype.searchTreesByMeta=function(t,n){var r=this;return this.upadteLoadState()?e.reject():C({type:"search.meta",value:this.requestTrees(t,_,n)}).then(function(e){return r.loadCallback(e)}).finally(function(){return r.cleanLoadState()})},c.prototype.load=function(t){var n=this;return this.upadteLoadState()?e.reject():C({type:"list.trees",value:this.requestTrees(t,_)}).then(function(e){return n.loadCallback(e)}).finally(function(){return n.cleanLoadState()})},c.prototype.loadFunction=function(t,n){var r=this;if(this.upadteLoadState())return e.reject();var i=this.state.pageToken;return o.execute("user",t,{pageToken:i,query:n}).then(function(e){return r.loadCallback(e)}).finally(function(){return r.cleanLoadState()})},c.prototype.loadDomain=function(e){return this.loadFunction("list.trees.domain",e)},c.prototype.loadTag=function(e){return this.loadFunction("list.trees.tag",e)},c.prototype.loadFeed=function(){var t=this,n=this.state;if(this.upadteLoadState())return e.reject();var r=n.pageToken;return a.execute(function(){return o.executeAuth("user","list.feed",{pageToken:r})}).then(function(e){return t.addTrees(e),e.trees&&e.trees.map(function(e){return e.id})}).finally(function(){return t.cleanLoadState()})},c.prototype.loadShared=function(){var t=this,n=this.state;return this.upadteLoadState()?e.reject():u.executeAPIMethod(function(){return o.execute("user","list.shared",{pageToken:n.pageToken,accessToken:u.getAccessToken()})}).then(function(e){return t.loadCallback(e)}).finally(function(){return t.cleanLoadState()})},c.prototype.loadRecommended=function(){var t=this;this.state;if(this.upadteLoadState())return e.reject();var n=this.treesMetaContainer.toTreesMetaArray().map(function(e){return e.value.shortUrl});return a.execute(function(){return o.executeAuth("user","list.trees.recommended",{nodes:n})}).then(function(e){return t.loadCallback(e)}).finally(function(){return t.cleanLoadState()})},c.prototype.add=function(t,n){var r=this,c=new Date;if(!t)return e.reject();var u=t.toJSON(!0);return u.modified=u.created=c.toISOString(),u.original=u.original||t.meta.id,u.token=n,this.isOverQuota&&this.quotaObserver.notifyObservers(),a.execute(function(){return o.executeAuth("tree","store.tree",u)}).then(function(e){u.id=e.tree.id,u.shortUrl=e.tree.shortUrl,u.editable=!0,r.isOverQuota=e.overQuota,r.isOverQuota&&r.quotaObserver.notifyObservers(),delete u.token,s.push("users/"+i.getUser().id+"/links",{type:"link",value:{linkType:b.tree,timestamp:c.toISOString(),tree:u}})})},c.prototype.updateTree=function(t,n,r,o){void 0===r&&(r=!1),void 0===o&&(o=!0);var i=this.treesContainer.getTree(t);if(!i)return e.reject();var a=i.meta.limitedEdit;i.meta.modified=new Date;var c=this.createUpdateCommandObject(t,n,i.meta.modified,r,o,a?u.getAccessToken():""),l=c.value.nodes,d=function(){return w(c).then(function(){return c.value.nodes=l,delete c.value.token,s.push("trees/"+i.meta.shortUrl+"/commands",c)})};return delete c.value.nodes,a?u.executeAPIMethod(d):d()},c.prototype.removeTree=function(e){return a.execute(function(){return o.executeAuth("tree","remove.tree",{id:e})}).then(function(){return s.push("users/"+i.getUser().id+"/links",{type:"remove",value:{timestamp:(new Date).toISOString(),tree:e}})})},c.prototype.editTree=function(t){var n=this.getTreeMeta(t);this.treesContainer.getTree(t);if(!n)return e.reject();var r=c.createEditCommandObject(t,n);return a.execute(function(){return o.executeAuth("tree","edit.tree",r.value)}).then(function(){return s.push("trees/"+n.shortUrl+"/commands",r).catch(angular.noop)})},c.prototype.editImage=function(t){var n=this.getTreeMeta(t);return n?a.execute(function(){return o.executeAuth("tree","edit.image",{id:t,image:n.image})}):e.reject()},c.prototype.togglePublished=function(t){var n=this,r=this.treesContainer.get(t);if(!r)return e.reject();var i=c.createPublishCommandObject(t,r.meta);return a.execute(function(){return o.executeAuth("tree",i.type,i.value)}).then(function(){return n.updateViewState("published",i.value.published),s.push("trees/"+r.meta.shortUrl+"/commands",i)})},c.prototype.toggleFavorite=function(t){var n=this,r=this.treesContainer.get(t);if(!r)return e.reject();var i=c.createFavoriteCommandObject(t,r.meta);return a.execute(function(){return o.executeAuth("tree",i.type,i.value)}).then(function(){return n.updateViewState("favorites",i.value.favorite),s.push("trees/"+r.meta.shortUrl+"/commands",i)})},c.prototype.addTag=function(t,n){return this.getTreeMeta(t)?a.execute(function(){return o.executeAuth("tree","add.tag",{id:t,tags:[n]})}):e.reject()},c.prototype.removeTag=function(t,n){return this.getTreeMeta(t)?a.execute(function(){return o.executeAuth("tree","remove.tag",{id:t,tags:[n]})}):e.reject()},c.prototype.sync=function(t){var n=this,r=this.treesContainer.getTree(t);return r?w({type:"get.tree",value:{id:r.meta.original}}).then(function(e){var o=new g(e),i=r.getMerge(o);if(i)return i.execute(),n.updateTree(t,i)}):e.reject()},c.prototype.pin=function(t){var n=this.getTreeMeta(t);return n?a.execute(function(){return o.executeAuth("tree","pin.tree",{id:n.id})}).then(function(){return s.push("users/"+i.getUser().id+"/links",{type:"pin",value:{timestamp:(new Date).toISOString(),tree:n.toJSON()}})}):e.reject()},c.prototype.unpin=function(e){return a.execute(function(){return o.executeAuth("tree","unpin.tree",{id:e})}).then(function(){return s.push("users/"+i.getUser().id+"/links",{type:"unpin",value:{timestamp:(new Date).toISOString(),tree:e}})})},c.prototype.move=function(t,n){return this.pinnedTreesContainer.hasKey(t)?a.execute(function(){return o.executeAuth("tree","move.tree",{id:t,count:n})}).then(function(){return s.push("users/"+i.getUser().id+"/links",{type:"move",value:{timestamp:(new Date).toISOString(),tree:t,index:n}})}):e.reject()},c.prototype.addEditor=function(e,t){return a.execute(function(){return o.executeAuth("tree","add.editor",{userId:e,id:t})})},c.prototype.removeEditor=function(e,t){return a.execute(function(){return o.executeAuth("tree","remove.editor",{userId:e,id:t})})},c}(k)}]);var t=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();e.factory("usersAPIStatic",["$q","$rootScope","$cacheFactory","$window","$interval","$http","$sce","GAuth","GApi","GData","GApiApp","GApiShared","firebaseService","facebook","pocket","itunes","nodes","trees","OrderedSet","Users","ObservableClass","util","FB_ID","API_KEY","SCOPES","placeholderUserImage","usersSharedStatic",function(e,n,r,o,i,a,s,c,u,l,d,p,m,f,g,h,v,y,b,k,C,w,_,S,x,T,A){return function(v){function x(){return v.call(this,n,r,e,o,i,u,d,f,g,h,k,b,C,w,_,S,T)||this}return t(x,v),x.prototype.simple_login=function(){var e=this;return c.login().then(function(){return e.$rootScope.isLoggingIn=!0,p.loginUser()})},x.prototype.logout=function(){var e=this;return c.getToken().then(function(t){return e.logoutShared(t.access_token)}).then(angular.noop)},x.prototype.logoutShared=function(e){var t=this,n={jsonpCallbackParam:"callback",params:{token:e}};return y.pinnedTreesContainer.clear(),y.pinnedTreesObserver.notifyObservers(),this.userCollections.tags=[],this.userCollections.domains=[],f.groups=[],a.jsonp(s.trustAsResourceUrl("https://accounts.google.com/o/oauth2/revoke"),n).then(function(){return m.logoutGoogle()}).then(function(){return c.logout()}).then(function(){return t.logoutUser()}).then(angular.noop)},x.prototype.loginFirebase=function(e){var t=this;return e?c.getToken().then(function(e){return m.loginGoogle(e.access_token)}).then(function(){return t.loginUser(e)}):(this.logoutUser(),this.$q.when())},x.prototype.loginYoutube=function(){function e(){return c.getToken().then(function(e){return e.access_token})}return c.setScope(p.getYoutubeScope().join(" ")),c.checkAuth().then(e,function(){return c.login().then(e)})},x.prototype.userSetup=function(){var e=this;return c.checkAuth().then(function(t){return e.loginFirebase(t)},angular.noop).finally(function(){return angular.element("#init-load").remove()})},x.prototype.userInfo=function(t){var r=this;return void 0===t&&(t=!1),l.isLogin()?u.executeAuth("user","user.info",{small:t}).then(function(e){var t=e.subscription,o=e.pinned,i=y.linkedTreeKey;r.hasRatedApp=e.has_rated_app,r.isBufferLogin=e.is_buffer_login,t&&(r.userSubscriptions.subscribers=parseInt(t.subscribers),r.userSubscriptions.subscriptions=parseInt(t.subscriptions)),r.userCollections.tags=e.tags||[],r.userCollections.domains=e.domains||[],r.lastVisit=e.last_visit?new Date(e.last_visit):new Date,f.setAccessToken(e.facebook),f.groups=e.facebook_groups&&e.facebook_groups.groups,y.addPinned(o),n.pinning.disabled=y.isPinDisabled(),i&&(y.getTreeMeta(i).pinned=y.pinnedTreesContainer.hasKey(i))}):e.when()},x.prototype.onLinks=function(e){var t="users/"+l.getUser().id+"/links";return m.on(t,"child_added",function(t,r){var o=new Date(t.value.timestamp);m.onDataWithRemove(o,e,function(){return n.$emit(t.type,t)},r)}),function(){return m.off(t,"child_added")}},x.prototype.onFeed=function(e){var t="users/"+l.getUser().id+"/feed";return m.on(t,"child_added",function(t,r){var o=new Date(t.timestamp);m.onDataWithRemove(o,e,function(){return n.$emit("feed",t)},r)}),function(){return m.off(t,"child_added")}},x}(A)}]);var t=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();e.factory("youtubeIFrameAPIStatic",["BASE_URL","youtubeIFrameSharedStatic",function(e,n){return function(n){function r(){var t=document.createElement("script");return t.src="https://www.youtube.com/iframe_api",document.body.appendChild(t),n.call(this,e)||this}return t(r,n),r}(n)}])}(angular.module("tnDataApp",["tnDataShared","tnUrlShortener","tnUtil","tnClasses"])),function(e){e.config(["$provide","IndexedDBConfig",function(e,t){e.value("IndexedDB",t.IndexedDB),e.value("IDBRange",t.IDBRange)}]);var t=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();e.factory("bufferControlStatic",["GApiExtension","bufferAPIStatic",function(e,n){return function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return t(r,n),r.prototype.getProfiles=function(){var t=this;return e.execute(function(){return n.prototype.getProfiles.call(t)})},r.prototype.createUpdate=function(t){var r=this;return e.execute(function(){return n.prototype.createUpdate.call(r,t)})},r}(n)}]);var t=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();e.factory("nodesControlStatic",["$q","GData","GApiExtension","filterFilter","IndexedDB","IDBRange","NodeMeta","Nodes","nodesConfig","dataUtil","nodesAPIStatic",function(e,n,r,o,i,a,s,c,u,l,d){var p=u.store;return function(u){function d(){return null!==u&&u.apply(this,arguments)||this}return t(d,u),d.prototype.getNodes=function(t){var n=e.defer(),r=i.transaction([p],"readonly"),o=r.objectStore(p);return r.oncomplete=function(){return n.resolve()},r.onerror=function(e){return n.reject(e)},angular.forEach(t,function(e){o.get(a.only(e)).onsuccess=function(){var t=event.target,n=t.result;n&&(l.renameNodeFromShort(n),n.value=e,c.addNode(e,n))}}),n.promise},d.prototype.getNodesRequest=function(e){var t=this;return this.GApi.execute("user","get.nodes",{nodes:e}).then(function(e){t.addNodesShared(e.nodes)})},d.prototype.loadLocal=function(t,n){void 0===n&&(n=10);var r,o=e.defer(),u=this.state,d=this.container,m=i.transaction([p],"readonly"),f=m.objectStore(p),g=t.sortBy,h=t.reverse,v=f.index(g),y=d.forEachValue(),b=h?y.min():y.max();u.loading=!0,u.more=!1,n+=d.size,b&&(r=b.getCurrentSortValue());var k,C=null;return h?(k="prev",r&&(C=a.upperBound(r,v.unique))):(k="next",r&&(C=a.lowerBound(r,v.unique))),m.oncomplete=function(){return o.resolve()},m.onerror=function(e){return o.reject(e)},v.openCursor(C,k).onsuccess=function(e){var t=e.target,r=t.result;if(r){if(d.size<n){var o=r.value,i=r.primaryKey;d.hasKey(i)||(l.renameNodeFromShort(o),c.addNode(i,o),d.put(i,new s(i))),r.continue()}}else u.moreLocal=!1},o.promise.finally(function(){return u.loading=!1})},d.prototype.searchLocal=function(t,n,r){function a(e){if(o([e],t).length){if(m){var n=e.geo;if(n){var r=n.split(",");return m(parseFloat(r[0]),parseFloat(r[1]))<5e3}return!1}return!0}}void 0===r&&(r=10);var u=e.defer(),d=this.state;if(d.moreLocal&&!d.loadingLocal){var m,f=this.container,g=i.transaction([p],"readonly"),h=g.objectStore(p),v=d.offset,y=v>0;return n&&(m=angular.bind(l,l.distance,n.latitude,n.longitude)),r+=f.size,g.oncomplete=function(){return u.resolve()},g.onerror=function(e){return u.reject(e)},d.loadingLocal=!0,h.openCursor().onsuccess=function(e){var t=e.target,n=t.result;if(n){if(f.size<r)if(y)y=!1,n.advance(v);else{var o=n.primaryKey,i=l.renameNodeFromShort(n.value);v++,!f.hasKey(o)&&a(i)&&(c.addNode(o,i),f.put(o,new s(o))),n.continue()}}else d.moreLocal=!1},u.promise.then(function(){d.offset=v}).finally(function(){return d.loadingLocal=!1})}},d.prototype.search=function(e,t,n){var r=this;void 0===n&&(n=10);var o=this.state,i=function(){return u.prototype.search.call(r,e,t,n,!0)};return o.moreLocal?this.searchLocal(e,t,n).then(function(){if(r.container.length<n)return i()}):o.more?i():void 0},d.prototype.searchGlobal=function(e){var t=this;return u.prototype.search.call(this,e).then(function(){return t.container.notifyObservers()})},d.prototype.load=function(){var e=this;return r.execute(function(){return u.prototype.load.call(e)})},d.prototype.loadRecommended=function(){var e=this;return r.execute(function(){return u.prototype.loadRecommended.call(e)})},d.prototype.remove=function(t){var o=this,a=e.defer(),s=i.transaction([p],"readwrite"),c=s.objectStore(p);return s.oncomplete=function(){return a.resolve()},s.onerror=function(e){return a.reject(e)},c.delete(t),a.promise.then(function(){if(n.isLogin())return r.execute(function(){return u.prototype.remove.call(o,t)})})},d.prototype.loadFavorites=function(){var e=this;return r.execute(function(){return u.prototype.loadFavorites.call(e)})},d.prototype.addFavorite=function(e){var t=this;return r.execute(function(){return u.prototype.addFavorite.call(t,e)})},d.prototype.hasFavorite=function(e){var t=this;return r.execute(function(){return u.prototype.hasFavorite.call(t,e)})},d.prototype.removeFavorite=function(e){var t=this;return r.execute(function(){return u.prototype.removeFavorite.call(t,e)})},d.prototype.clearNodes=function(){u.prototype.clearNodes.call(this,!0)},d}(d)}]);var t=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();e.factory("pocketControlStatic",["GApiExtension","pocketAPIStatic",function(e,n){return function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return t(r,n),r.prototype.add=function(t){var r=this;return e.execute(function(){return n.prototype.add.call(r,t)})},r}(n)}]);var t=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();e.factory("treesControlStatic",["$q","$rootScope","$timeout","GApi","GData","GAuth","GApiExtension","filterFilter","chromeRuntime","Tree","TreeMeta","IndexedDB","IDBRange","treesConfig","dataUtil","linkEvent","treesAPIStatic","nodesControlStatic",function(e,n,r,o,i,a,s,c,u,l,d,p,m,f,g,h,v,y){var b=f.store,k=f.groupCtrl,C=new y;return function(f){function v(){return null!==f&&f.apply(this,arguments)||this}return t(v,f),v.prototype.count=function(t){void 0===t&&(t="created");var n=e.defer(),r=p.transaction([b],"readonly"),o=r.objectStore(b).index(t);return r.onerror=function(e){return n.reject(e)},o.count().onsuccess=function(e){var t=e.target,r=t.result;n.resolve(r)},n.promise},v.prototype.getTree=function(t,n){var r=this,o=this.state,a=n.id;if(n.loading||this.treesContainer.hasKey(a)||o.treeLoading)return e.reject();var c;if(t.local){var u=e.defer(),l=m.only(a),d=p.transaction([b],"readwrite"),h=d.objectStore(b);this.addTreePrecall(n),d.onerror=function(e){return u.reject(e)},h.openCursor(l).onsuccess=function(e){var t=e.target,o=t.result;if(o){var i=o.value;g.renameTreeFromShort(i),i.seen=!0,i.editable=!0,r.addTreeObject(n,i),g.renameTreeToShort(i),o.update(i).onsuccess=function(){return u.resolve()}}else u.reject()},c=u.promise.finally(this.addTreeCallback(n))}else c=s.execute(function(){if(i.isLogin())return f.prototype.getTree.call(r,t,n);var o=p.transaction([b],"readonly"),s=o.objectStore(b),c=e.defer();return o.onerror=function(e){return c.reject(e)},s.openCursor().onsuccess=function(e){var t=e.target,n=t.result;if(n){var r=n.value;g.renameTreeFromShort(r),r.original==a?c.resolve(!0):n.continue()}else c.resolve(!1)},c.promise.then(function(e){return f.prototype.getTree.call(r,t,n).then(function(){return n.isReposted=e})}).then(angular.noop)});return c},v.prototype.searchTreesByMeta=function(t,n,r){var o=this;void 0===r&&(r=10);var i,a=this.treesMetaContainer,u=this.state;if(t.local){if(u.loading)return e.reject();var l=k.sortBy,d=k.reverse,m=e.defer(),h=p.transaction([b],"readonly"),v=h.objectStore(b).index(l),y=u.offset,w=y>0,_=d?"prev":"next",S=t.favorite?function(e){return e.favorite}:function(e){return!0};u.loading=!0,i=m.promise.then(function(){u.offset=y,a.notifyObservers()}).finally(function(){return u.loading=!1}),r+=a.size,h.oncomplete=function(){return m.resolve()},h.onerror=function(e){return m.reject(e)},v.openCursor(null,_).onsuccess=function(e){var t=e.target,i=t.result;if(i){if(a.size<r)if(w)w=!1,i.advance(y);else{var s=i.primaryKey,l=i.value;y++,g.renameTreeFromShort(l),S(l)&&c([l],n).length&&(l.count=l.children.length,l.editable=!0,o.addTree(l,s)),i.continue()}}else u.more=!1}}else{var x=function(){return s.execute(function(){return f.prototype.searchTreesByMeta.call(o,t,n)})};i=this.state.noNodesFound?x():C.searchLocal(n).then(function(){return o.state.nodes=C.container.keys(),o.state.noNodesFound=!o.state.nodes.length,o.state.treesMore=!o.state.noNodesFound,C.clearNodes(),x()})}return i},v.prototype.load=function(t,n){var r=this;void 0===n&&(n=10);var o,i=this.treesMetaContainer,a=this.state,c=k.sortBy,u=k.reverse;if(t.local){if(a.loading)return e.reject();a.loading=!0,o=this.count(c).then(function(o){var s=i.size;if(s>=o)return a.more=!1,e.when();var l,d,f=p.transaction([b],"readonly"),h=f.objectStore(b).index(c),v=i.forEachValue(),y=e.defer(),k=t.favorite?function(e){return e.favorite}:function(e){return!0},C=null;return u?(l="prev",(d=v.min())&&(C=m.upperBound(d.getCurrentSortValue(),h.unique))):(l="next",(d=v.max())&&(C=m.lowerBound(d.getCurrentSortValue(),h.unique))),f.oncomplete=function(){return y.resolve()},f.onerror=function(e){return y.reject(e)},n+=s,h.openCursor(C,l).onsuccess=function(e){var t=e.target,o=t.result;if(o){if(i.size<n){var s=o.primaryKey,c=o.value;g.renameTreeFromShort(c),k(c)&&(c.count=c.children.length,c.editable=!0,r.addTree(c,s)),o.continue()}}else a.more=!1},y.promise.then(function(){return i.notifyObservers()})}).finally(function(){return a.loading=!1})}else o=s.execute(function(){return f.prototype.load.call(r,t)});return o},v.prototype.loadFeed=function(){var e=this;return s.execute(function(){return f.prototype.loadFeed.call(e)})},v.prototype.loadRecommended=function(){var e=this;return s.execute(function(){return f.prototype.loadRecommended.call(e)})},v.prototype.add=function(t){var r,o,c=this,u=new Date;if(!t)return e.reject();if(i.isLogin())r=s.execute(function(){return a.getToken().then(function(e){return f.prototype.add.call(c,t,e.access_token)})});else{var l=e.defer(),d=p.transaction([b],"readwrite"),m=d.objectStore(b),v=function(){g.renameTreeToShort(o),m.add(o).onsuccess=function(e){g.renameTreeFromShort(o),o.id=e.target.result,o.count=o.children.length}};o=t.toJSON(),o.created=o.modified=u,o.original=o.original||t.meta.id,d.oncomplete=function(){return l.resolve()},d.onerror=function(e){return l.reject(e)},d.onabort=function(e){return l.reject(e)},r=l.promise.then(function(){n.$emit("link",{value:{linkType:h.tree,timestamp:u,tree:o}})}),o.original?m.openCursor().onsuccess=function(e){var t=e.target,n=t.result;if(n){var r=n.value;g.renameTreeFromShort(r),r.original!=o.original?n.continue():d.abort()}else v()}:v()}return r},v.prototype.updateTree=function(t,n,r,o){var a=this;void 0===r&&(r=!1),void 0===o&&(o=!0);var c,u=this.treesContainer.getTree(t);if(!u)return e.reject();if(u.meta.modified=new Date,i.isLogin()||u.meta.limitedEdit)c=s.execute(function(){return f.prototype.updateTree.call(a,t,n,r,o)});else{var l=e.defer(),d=p.transaction([b],"readwrite"),m=d.objectStore(b),h=u.toJSON();c=l.promise.then(function(){var e=a.createUpdateCommandObject(t,n,u.meta.modified,r,o);return a.sendMessage(t,e)}),d.oncomplete=function(){return l.resolve()},d.onerror=function(e){return l.reject(e)},g.renameTreeToShort(h),m.put(h,t)}return c},v.prototype.removeTree=function(t){var n,r=this,o=this.treesContainer,a=this.treesMetaContainer;if(i.isLogin())n=s.execute(function(){return f.prototype.removeTree.call(r,t)});else{var c=e.defer(),u=m.only(t),l=p.transaction([b],"readwrite"),d=l.objectStore(b);n=c.promise.then(function(){a.deleteMeta(t),o.deleteTree(t)}),l.oncomplete=function(){return c.resolve()},l.onerror=function(e){return c.reject(e)},d.delete(u)}return n},v.prototype.editTree=function(t){var n,r=this,o=this.getTreeMeta(t);this.treesContainer.getTree(t);if(!o)return e.reject();if(i.isLogin())n=s.execute(function(){return f.prototype.editTree.call(r,t)});else{var a=e.defer(),c=p.transaction([b],"readwrite"),u=c.objectStore(b);n=a.promise.then(function(){var e=v.createEditCommandObject(t,o);return r.sendMessage(t,e)}),c.oncomplete=function(){return a.resolve()},c.onerror=function(e){return a.reject(e)},u.openCursor(m.only(t)).onsuccess=function(e){var t=e.target,n=t.result;if(n){var r=n.value;g.renameTreeFromShort(r),r.title=o.title,r.description=o.description,g.renameTreeToShort(r),n.update(r)}else a.reject()}}return n},v.prototype.editImage=function(t){var n,r=this,o=this.getTreeMeta(t);if(!o)return e.reject();if(i.isLogin())n=s.execute(function(){return f.prototype.editImage.call(r,t)});else{var a=e.defer(),c=p.transaction([b],"readwrite"),u=c.objectStore(b);n=a.promise,c.oncomplete=function(){return a.resolve()},c.onerror=function(e){return a.reject(e)},u.openCursor(m.only(t)).onsuccess=function(e){var t=e.target,n=t.result;if(n){var r=n.value;g.renameTreeFromShort(r),r.image=o.image,g.renameTreeToShort(r),n.update(r)}else a.reject()}}return n},v.prototype.togglePublished=function(e){var t=this;return s.execute(function(){return f.prototype.togglePublished.call(t,e)})},v.prototype.toggleFavorite=function(t){var n,r=this,o=this.treesContainer.get(t);if(!o)return e.reject();if(i.isLogin())n=s.execute(function(){return f.prototype.toggleFavorite.call(r,t)});else{var a=e.defer(),c=p.transaction([b],"readwrite"),u=c.objectStore(b),l=v.createFavoriteCommandObject(t,o.meta);n=a.promise.then(function(){return r.updateViewState("favorites",l.value.favorite),r.sendMessage(t,l)}),c.oncomplete=function(){return a.resolve()},c.onerror=function(e){return a.reject(e)},u.openCursor(m.only(t)).onsuccess=function(e){var t=e.target,n=t.result;if(n){var r=n.value;g.renameTreeFromShort(r),r.favorite=l.value.favorite,g.renameTreeToShort(r),n.update(r)}else a.reject()}}return n},v.prototype.addTag=function(t,n){var r,o=this,a=this.getTreeMeta(t);if(!a)return e.reject();if(i.isLogin())r=s.execute(function(){return f.prototype.addTag.call(o,t,n)});else{var c=e.defer(),u=p.transaction([b],"readwrite"),l=u.objectStore(b);r=c.promise,u.oncomplete=function(){return c.resolve()},u.onerror=function(e){c.reject(e)},l.openCursor(m.only(t)).onsuccess=function(e){var t=e.target,r=t.result;if(r){var o=r.value;g.renameTreeFromShort(o),o.tags=o.tags||[],-1===o.tags.indexOf(n)&&(o.tags.push(n),g.renameTreeToShort(o),r.update(o))}else c.reject()}}return r},v.prototype.removeTag=function(t,n){var r,o=this,a=this.getTreeMeta(t);if(!a)return e.reject();if(i.isLogin())r=s.execute(function(){return f.prototype.removeTag.call(o,t,n)});else{var c=e.defer(),u=p.transaction([b],"readwrite"),l=u.objectStore(b);r=c.promise,u.oncomplete=function(){return c.resolve()},u.onerror=function(e){return c.reject(e)},l.openCursor(m.only(t)).onsuccess=function(e){var t=e.target,r=t.result;if(r){var o=r.value;g.renameTreeFromShort(o),o.tags=o.tags||[];var i=o.tags.indexOf(n);-1!==i&&(o.tags.splice(i,1),g.renameTreeToShort(o),r.update(o))}else c.reject()}}return r},v.prototype.sync=function(e){var t=this;return s.execute(function(){return f.prototype.sync.call(t,e)})},v.prototype.pin=function(e){var t=this;return s.execute(function(){return f.prototype.pin.call(t,e)})},v.prototype.unpin=function(e){var t=this;return s.execute(function(){return f.prototype.unpin.call(t,e)})},v.prototype.move=function(e,t){var n=this;return s.execute(function(){return f.prototype.move.call(n,e,t)})},v.prototype.addEditor=function(e,t){var n=this;return s.execute(function(){return f.prototype.addEditor.call(n,e,t)})},v.prototype.removeEditor=function(e,t){var n=this;return s.execute(function(){return f.prototype.removeEditor.call(n,e,t)})},v.prototype.getLast=function(){var t;if(i.isLogin())t=s.execute(function(){return o.executeAuth("user","get.last.tree")});else{var n=p.transaction([b],"readwrite"),r=n.objectStore(b).index("modified"),a=e.defer();n.onerror=function(){return a.reject()},t=a.promise,r.openCursor(null,"prev").onsuccess=function(e){var t=e.target,n=t.result;if(n){var r=n.value;g.renameTreeFromShort(r),r.id=n.primaryKey,r.count=r.children.length,r.editable=!0,r.seen=!0;var o=angular.copy(r);g.renameTreeToShort(o),n.update(o).onsuccess=function(){return a.resolve(r)}}else a.reject()}}return t},v.prototype.syncLocal=function(){var t=this;return i.isLogin()?this.count().then(function(t){if(t){var n=e.defer(),r=p.transaction([b],"readonly"),o=r.objectStore(b).index("modified"),i=[];return r.oncomplete=function(){return n.resolve(i)},r.onerror=function(e){return n.reject(e)},o.openCursor(null,"prev").onsuccess=function(e){var t=e.target,n=t.result;if(n&&i.length<100){var r=n.value;g.renameTreeFromShort(r),i.push(new l(r,new d("",r)).toJSON(!0)),n.continue()}},n.promise}}).then(function(e){if(e)return s.execute(function(){return a.getToken().then(function(t){return o.executeAuth("tree","store.trees",{token:t.access_token,trees:e})})}).then(function(e){e.overQuota&&t.quotaObserver.notifyObservers()},angular.noop).then(function(){return r(function(){return u.sendMessage({type:"clear:trees"})},3e3)}).then(angular.noop)}):e.when()},v.prototype.sendMessage=function(e,t){return u.sendMessage({type:"command",value:t}).then(function(){u.sendMessage({type:"command:"+e,value:t})})},v}(v)}]);var t=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();e.factory("usersControlStatic",["$timeout","trees","GApiShared","GApiExtension","chromeRuntime","chromeIdentity","usersAPIStatic",function(e,n,r,o,i,a,s){return function(s){function c(){return null!==s&&s.apply(this,arguments)||this}return t(c,s),c.prototype.simple_login=function(){var t=this;return o.login(!0).then(function(){return t.$rootScope.isLoggingIn=!0,i.sendMessage({type:"GAuth:token"})}).then(function(){return o.execute(function(){return r.loginUser(!0)})}).then(function(t){return e(1e3).then(function(){return n.syncLocal()}).then(function(){return e(1e3)}).then(function(){return t})})},c.prototype.loginYoutube=function(){var e=r.getYoutubeScope();return a.getAuthToken(!1,e).then(function(e){return e},function(){return a.getAuthToken(!0,e)})},c.prototype.logout=function(){var e=this;return a.getAuthToken().then(function(t){return e.logoutShared(t).then(function(){return a.removeCachedAuthToken(t)})}).then(function(){return i.sendMessage({type:"GAuth:logout"})})},c.prototype.userSetup=function(){var e=this;return o.login().then(function(t){return e.loginFirebase(t).then(function(){if(t)return n.syncLocal()})}).finally(function(){return angular.element("#init-load").remove()})},c.prototype.subscribeUser=function(e){var t=this;return o.execute(function(){return s.prototype.subscribeUser.call(t,e)})},c.prototype.unsubscribeUser=function(e){var t=this;return o.execute(function(){return s.prototype.unsubscribeUser.call(t,e)})},c.prototype.isSubscribed=function(e){var t=this;return o.execute(function(){return s.prototype.isSubscribed.call(t,e)})},c.prototype.loadSubscribers=function(e){var t=this;return o.execute(function(){return s.prototype.loadSubscribers.call(t,e)})},c.prototype.loadSubscriptions=function(e){var t=this;return o.execute(function(){return s.prototype.loadSubscriptions.call(t,e)})},c.prototype.publishDomain=function(e){var t=this;return o.execute(function(){return s.prototype.publishDomain.call(t,e)})},c.prototype.unpublishDomain=function(e){var t=this;return o.execute(function(){return s.prototype.unpublishDomain.call(t,e)})},c.prototype.listPublishDomains=function(){var e=this;return o.execute(function(){return s.prototype.listPublishDomains.call(e)})},c.prototype.complain=function(e,t){var n=this;return o.execute(function(){return s.prototype.complain.call(n,e,t)})},c}(s)}]);var t=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();e.factory("youtubeIFrameControlStatic",["BASE_URL","youtubeIFrameSharedStatic",function(e,n){return function(n){function r(){return n.call(this,e)||this}return t(r,n),r.prototype.getFrameUrl=function(e){return this.BASE_URL+"/youtube_iframe?videoId="+e},r.prototype.createPlayer=function(e,t,n){var r=this;this.element=e,this.onMessage=function(e){if(e.origin==r.BASE_URL)return e.data.error?n():void t(e.data.data)},window.addEventListener("message",this.onMessage,!1)},r.prototype.destroy=function(){this.onMessage&&window.removeEventListener("message",this.onMessage),this.element=this.onMessage=null},r.prototype.loadVideoById=function(e){this.element.contentWindow.postMessage(e,this.BASE_URL)},r}(n)}])}(angular.module("tnDataControl",["tnIndexedDB","tnDataApp"])),function(e){e.config(["$provide",function(e){e.value("GApiApp",{execute:function(e){return e()}})}])}(angular.module("tnDataControlExtension",["tnDataControl"])),function(e){var t=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();e.factory("facebookControlStatic",["GApiExtension","chromeIdentity","URI","facebookExtensionRedirectURL","facebookAPIStatic",function(e,n,r,o,i){return function(i){function a(){return null!==i&&i.apply(this,arguments)||this}return t(a,i),a.prototype.getToken=function(){var e=this;return n.launchWebAuthFlow(o()).then(function(t){return e.setAccessToken(t),t.access_token})},a.prototype.simple_login=function(e){return n.launchWebAuthFlow(o(e),!0).then(function(e){return e.access_token})},a.prototype.logout=function(){var e=this,t=r(this.logoutURL).query({next:"https://www.facebook.com",access_token:this.getAccessToken()});return n.logout(t.toString()).then(function(){return e.facebookLogout()})},a.prototype.fetchAccessToken=function(){var t=this;return e.execute(function(){return i.prototype.fetchAccessToken.call(t)})},a.prototype.facebookLogin=function(t){var n=this;return e.execute(function(){return i.prototype.facebookLogin.call(n,t)})},a.prototype.facebookLogout=function(){var t=this;return e.execute(function(){return i.prototype.facebookLogout.call(t)})},a}(i)}])}(angular.module("tnDataFacebookExtension",["tnDataFacebook"])),function(e){var t=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();e.factory("treesPageStatic",["chromeRuntime","treesControlStatic",function(e,n){return function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return t(r,n),r.prototype.removeTree=function(t){return n.prototype.removeTree.call(this,t).then(function(){return e.sendMessage({type:"page:close"})})},r.prototype.registerTree=function(t){var n=this;t.$on("tree:init",function(){e.sendMessage({type:"page:init",id:n.treesContainer.keys()[0]})})},r}(n)}])}(angular.module("tnDataPageShared",[])),function(e){e.service("chromeRuntime",["$rootScope","$q","EXTENSION_ID",function(e,t,n){var r=this,o=chrome.runtime;o.onMessage.addListener(function(t,n,r){return e.$emit(t.type,t,n,r),!0}),r.sendMessage=function(e){var r=t.defer();return o.sendMessage(n,e,function(e){var t=o.lastError||e&&e.error;t?r.reject(t):r.resolve(e)}),r.promise}}])}(angular.module("tnChromeShared",["tnConfig"])),function(e){e.service("dataUtil",["util","treeProperty","treeShortProperty","nodesProperties","nodesShortProperties",function(e,t,n,r,o){void 0===Number.prototype.toRad&&(Number.prototype.toRad=function(){return this*Math.PI/180}),this.renameTreeFromShort=angular.bind(e,e.renameProperties,n,t),this.renameTreeToShort=angular.bind(e,e.renameProperties,t,n),this.renameNodeFromShort=angular.bind(e,e.renameProperties,o,r),this.renameNodeToShort=angular.bind(e,e.renameProperties,r,o),this.distance=function(e,t,n,r){var o=(r-t).toRad(),i=(n-e).toRad(),a=Math.sin(o/2)*Math.sin(o/2)+Math.cos(t.toRad())*Math.cos(r.toRad())*Math.sin(i/2)*Math.sin(i/2);return 2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))*6371}}])}(angular.module("tnDataUtil",["tnConfig","tnUtil"])),function(e){var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();e.factory("facebookPageStatic",["$q","chromeRuntime","facebookControlStatic",function(e,t,n){return function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return r(i,n),i.prototype.getToken=function(n){var r=this;return void 0===n&&(n=!1),t.sendMessage({type:"auth:facebook",interactive:n}).then(function(t){return t?(r.setAccessToken({access_token:t}),t):e.reject()})},i.prototype.login=function(){var e=this;return this.getToken(!0).then(o.noop,function(){return e.removeAccessToken()})},i}(n)}]);var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=n(0);e.factory("usersPageStatic",["$q","$rootScope","$compile","$timeout","GAuth","GData","TreeMeta","chromeRuntime","trees","usersControlStatic",function(e,t,n,i,a,s,c,u,l,d){return function(c){function d(){return null!==c&&c.apply(this,arguments)||this}return r(d,c),d.prototype.login=function(r){var c=this;return void 0===r&&(r=!0),s.isLogin()?e.when():u.sendMessage({type:"GAuth:get",interactive:r}).then(function(e){if(e)return a.setToken(e)}).then(function(){if(s.isLogin()&&r)return l.syncLocal().then(function(){return i(1e3)}).then(function(){return u.sendMessage({type:"page:tree"})}).then(function(e){if(!e||!o.isDefined(e.id))return u.sendMessage({type:"page:close"});t.embedTreeScope.$destroy();var r=t.embedTreeScope=t.$new();l.treesContainer.clear(),l.registerTree(r),t.addTree(e),r.tree=l.treesContainer.assoc(e.id),n("<tn-tree></tn-tree>")(r,function(e){r.$applyAsync(function(){return o.element("tn-tree").replaceWith(e)})})})}).then(function(){return c.loginUser(s.getUser())})},d.prototype.userSetup=function(){return this.login(!1)},d.prototype.loginYoutube=function(){return u.sendMessage({type:"GAuth:youtube"}).then(function(e){if(e)return a.setToken(e).then(function(){return e.access_token})})},d}(d)}])}(angular.module("tnDataPage",["tnDataControlExtension","tnDataFacebookExtension","tnDataPageShared","tnChromeShared","tnDataUtil"])),function(e){"use strict";function t(){this.defaults={scrollButtons:{enable:!0},axis:"yx"},$.mCustomScrollbar.defaults.scrollButtons=this.defaults.scrollButtons,$.mCustomScrollbar.defaults.axis=this.defaults.axis,this.$get=function(){return{defaults:this.defaults}}}function n(e,t,n,r){n.mCustomScrollbar("destroy");var o={};r.ngScrollbarsConfig&&(o=r.ngScrollbarsConfig);for(var i in e)if(e.hasOwnProperty(i))switch(i){case"scrollButtons":o.hasOwnProperty(i)||(t.scrollButtons=e[i]);break;case"axis":o.hasOwnProperty(i)||(t.axis=e[i]);break;default:o.hasOwnProperty(i)||(o[i]=e[i])}n.mCustomScrollbar(o)}function r(e){return{scope:{ngScrollbarsConfig:"=?",ngScrollbarsUpdate:"=?",element:"=?"},link:function(t,r,o){t.elem=r;var i=e.defaults,a=$.mCustomScrollbar.defaults;t.ngScrollbarsUpdate=function(){r.mCustomScrollbar.apply(r,arguments)},t.$watch("ngScrollbarsConfig",function(e,o){void 0!==e&&n(i,a,r,t)}),n(i,a,r,t)}}}e.provider("ScrollBars",t).directive("ngScrollbars",r),t.$inject=[],r.$inject=["ScrollBars"]}(angular.module("ngScrollbars",[])),function(e){e.factory("$queueFactory",["$q","$window","$timeout","$rootScope",function(e,t,n,r){var o=function(e){this.init(e)},i=o.prototype;return i._limit=null,i._queue=null,i._deferFunc=null,i.init=function(e){this._limit=e.limit,this._queue=[],e.deferred&&(t.setImmediate?this._deferFunc=function(e){t.setImmediate(function(){e(),r.$apply()})}:this._deferFunc=function(e){n(e)})},i.enqueue=function(e,t,n){var r=[e,t,n];return this._queue.push([e,t,n]),this.dequeue(),r},i.remove=function(e){var t=this._queue.indexOf(e);return this._queue.splice(t,1)[0]},i.dequeue=function(){if(!(this._limit<=0||0===this._queue.length)){this._limit--;var t,n,r=this._queue.shift(),o=r[0],i=r[1],a=r[2],s=this;t=n=function(){s._limit++,s._deferFunc?s._deferFunc(function(){s.dequeue()}):s.dequeue()},e.when(o.apply(i||null,a||null)).then(t,n)}},i.clear=function(){this._queue.length=0},function(e,t){var n;return angular.isObject(e)?n=e:(e=e||1,angular.isUndefined(t)&&(t=!1),n={limit:e,deferred:!!t}),new o(n)}}])}(angular.module("ngQueue",[])),function(e){"use strict";e.service("debounce",["$timeout",function(e){return function(t,n,r,o){function i(){c=this,s=arguments;var i=function(){a=null,r||(u=t.apply(c,s))},l=r&&!a;return a&&e.cancel(a),a=e(i,n,o),l&&(u=t.apply(c,s)),u}var a,s,c,u;return i.cancel=function(){e.cancel(a),a=null},i}}]).directive("debounce",["debounce","$parse",function(e,t){return{require:"ngModel",priority:999,link:function(n,r,o,i){var a,s,c=t(o.debounce)(n),u=!!t(o.immediate)(n),l=i.$render.bind(i),d=e(function(e){s=!0,i.$$lastCommittedViewValue=a,i.$setViewValue(e),s=!1},parseInt(c,10),u);i.$render=function(){l(),d.cancel(),a=this.$viewValue},i.$parsers.unshift(function(e){return s?(a=e,e):(d(i.$viewValue),a)})}}}])}(angular.module("debounce",[])),function(e){e.provider("Analytics",function(){var e,t,n,r,o,i=!0,a="auto",s=!1,c=!1,u="USD",l=!1,d=!1,p=!1,m=!1,f=!1,g=!1,h=!1,v=!1,y=!1,b=!1,k=!1,C="$routeChangeSuccess",w=!1,_=!1,S=!1,x="",T=!0,A=!1;this.log=[],this.offlineQueue=[],this.setAccount=function(t){return e=angular.isUndefined(t)||!1===t?void 0:angular.isArray(t)?t:angular.isObject(t)?[t]:[{tracker:t,trackEvent:!0}],this},this.trackPages=function(e){return T=!!e,this},this.trackPrefix=function(e){return x=e,this},this.setDomainName=function(e){return n=e,this},this.useDisplayFeatures=function(e){return p=!!e,this},this.useAnalytics=function(e){return i=!!e,this},this.useEnhancedLinkAttribution=function(e){return h=!!e,this},this.useCrossDomainLinker=function(e){return c=!!e,this},this.setCrossLinkDomains=function(e){return t=e,this},this.setPageEvent=function(e){return C=e,this},this.setCookieConfig=function(e){return a=e,this},this.useECommerce=function(e,t){return f=!!e,g=!!t,this},this.setCurrency=function(e){return u=e,this},this.setRemoveRegExp=function(e){return e instanceof RegExp&&(o=e),this},this.setExperimentId=function(e){return r=e,this},this.ignoreFirstPageLoad=function(e){return v=!!e,this},this.trackUrlParams=function(e){return A=!!e,this},this.disableAnalytics=function(e){return m=!!e,this},this.setHybridMobileSupport=function(e){return b=!!e,this},this.startOffline=function(e){return k=!!e,!0===k&&this.delayScriptTag(!0),this},this.delayScriptTag=function(e){return d=!!e,this},this.logAllCalls=function(e){return y=!!e,this},this.enterTestMode=function(){return _=!0,this},this.enterDebugMode=function(e){return l=!0,S=!!e,this},this.readFromRoute=function(e){return w=!!e,this},this.$get=["$document","$location","$log","$rootScope","$window","$injector",function(D,M,E,P,$,I){var O=this,U=function(e,t){return angular.isObject(t)&&angular.isDefined(t[e])},L=function(e,t,n){return U(e,t)&&t[e]===n},N=function(e,t){return angular.isString(t)?t+"."+e:U("name",t)?t.name+"."+e:e},R={};w&&(I.has("$route")?R=I.get("$route"):E.warn("$route service is not available. Make sure you have included ng-route in your application dependencies."));var j=function(){if(w&&R.current&&"pageTrack"in R.current)return R.current.pageTrack;var e=A?M.url():M.path();return o?e.replace(o,""):e},B=function(){var e={utm_source:"campaignSource",utm_medium:"campaignMedium",utm_term:"campaignTerm",utm_content:"campaignContent",utm_campaign:"campaignName"},t={};return angular.forEach(M.search(),function(n,r){var o=e[r];angular.isDefined(o)&&(t[o]=n)}),t},F=function(e,t,n,r,o,i,a,s,c){var u={};return e&&(u.id=e),t&&(u.affiliation=t),n&&(u.revenue=n),r&&(u.tax=r),o&&(u.shipping=o),i&&(u.coupon=i),a&&(u.list=a),s&&(u.step=s),c&&(u.option=c),u},q=function(e){!i&&$._gaq&&"function"==typeof e&&e()},G=function(){var e=Array.prototype.slice.call(arguments);if(!0===k)return void O.offlineQueue.push([G,e]);$._gaq||($._gaq=[]),!0===y&&O._log.apply(O,e),$._gaq.push(e)},z=function(e){i&&$.ga&&"function"==typeof e&&e()},K=function(){var e=Array.prototype.slice.call(arguments);return!0===k?void O.offlineQueue.push([K,e]):"function"!=typeof $.ga?void O._log("warn","ga function not set on window"):(!0===y&&O._log.apply(O,e),void $.ga.apply(null,e))},V=function(t){var n=Array.prototype.slice.call(arguments,1),r=n[0],o=[];if("function"==typeof t?e.forEach(function(e){t(e)&&o.push(e)}):o=e,0===o.length)return void K.apply(O,n);o.forEach(function(e){U("select",e)&&"function"==typeof e.select&&!e.select(n)||(n[0]=N(r,e),K.apply(O,n))})};return this._log=function(){var e=Array.prototype.slice.call(arguments);if(e.length>0){if(e.length>1)switch(e[0]){case"debug":case"error":case"info":case"log":case"warn":E[e[0]](e.slice(1))}O.log.push(e)}},this._createScriptTag=function(){if(!e||e.length<1)return void O._log("warn","No account id set to create script tag");if(e.length>1&&(O._log("warn","Multiple trackers are not supported with ga.js. Using first tracker only"),e=e.slice(0,1)),!0===s)return void O._log("warn","ga.js or analytics.js script tag already created");!0===m&&(O._log("info","Analytics disabled: "+e[0].tracker),$["ga-disable-"+e[0].tracker]=!0),G("_setAccount",e[0].tracker),n&&G("_setDomainName",n),h&&G("_require","inpage_linkid","//www.google-analytics.com/plugins/ga/inpage_linkid.js"),T&&!v&&(o?G("_trackPageview",j()):G("_trackPageview"));var t,r=D[0];return t=!0===p?("https:"===r.location.protocol?"https://":"http://")+"stats.g.doubleclick.net/dc.js":("https:"===r.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js",!0!==_?function(){var e=r.createElement("script");e.type="text/javascript",e.async=!0,e.src=t;var n=r.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)}():O._log("inject",t),s=!0,!0},this._createAnalyticsScriptTag=function(){if(!e)return void O._log("warn","No account id set to create analytics script tag");if(!0===s)return void O._log("warn","ga.js or analytics.js script tag already created");!0===m&&e.forEach(function(e){O._log("info","Analytics disabled: "+e.tracker),$["ga-disable-"+e.tracker]=!0});var n=D[0],o=!0===b?"https:":"",i=o+"//www.google-analytics.com/"+(l?"analytics_debug.js":"analytics.js");if(!0!==_?function(e,t,n,r,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=r,a.parentNode.insertBefore(i,a)}(window,n,"script",i,"ga"):("function"!=typeof $.ga&&($.ga=function(){O._log("debug","ga("+Array.prototype.slice.call(arguments).join()+")")}),O._log("inject",i)),S&&($.ga_debug={trace:!0}),e.forEach(function(e){e.crossDomainLinker=U("crossDomainLinker",e)?e.crossDomainLinker:c,e.crossLinkDomains=U("crossLinkDomains",e)?e.crossLinkDomains:t,e.displayFeatures=U("displayFeatures",e)?e.displayFeatures:p,e.enhancedLinkAttribution=U("enhancedLinkAttribution",e)?e.enhancedLinkAttribution:h,e.set=U("set",e)?e.set:{},e.trackEcommerce=U("trackEcommerce",e)?e.trackEcommerce:f,e.trackEvent=!!U("trackEvent",e)&&e.trackEvent;var n={};U("fields",e)?n=e.fields:U("cookieConfig",e)?angular.isString(e.cookieConfig)?n.cookieDomain=e.cookieConfig:n=e.cookieConfig:angular.isString(a)?n.cookieDomain=a:a&&(n=a),!0===e.crossDomainLinker&&(n.allowLinker=!0),U("name",e)&&(n.name=e.name),e.fields=n,K("create",e.tracker,e.fields),!0===b&&K(N("set",e),"checkProtocolTask",null);for(var r in e.set)e.set.hasOwnProperty(r)&&K(N("set",e),r,e.set[r]);!0===e.crossDomainLinker&&(K(N("require",e),"linker"),angular.isDefined(e.crossLinkDomains)&&K(N("linker:autoLink",e),e.crossLinkDomains)),e.displayFeatures&&K(N("require",e),"displayfeatures"),e.trackEcommerce&&(g?(K(N("require",e),"ec"),K(N("set",e),"&cu",u)):K(N("require",e),"ecommerce")),e.enhancedLinkAttribution&&K(N("require",e),"linkid"),T&&!v&&K(N("send",e),"pageview",x+j())}),r){var d=n.createElement("script"),y=n.getElementsByTagName("script")[0];d.src=o+"//www.google-analytics.com/cx/api.js?experiment="+r,y.parentNode.insertBefore(d,y)}return s=!0,!0},this._ecommerceEnabled=function(e,t){var n=f&&!g;return!0===e&&!1===n&&(f&&g?O._log("warn",t+" is not available when Enhanced Ecommerce is enabled with analytics.js"):O._log("warn","Ecommerce must be enabled to use "+t+" with analytics.js")),n},this._enhancedEcommerceEnabled=function(e,t){var n=f&&g;return!0===e&&!1===n&&O._log("warn","Enhanced Ecommerce must be enabled to use "+t+" with analytics.js"),n},this._trackPage=function(e,t,n){e=e||j(),t=t||D[0].title,q(function(){G("_set","title",t),G("_trackPageview",x+e)}),z(function(){var r={page:x+e,title:t};angular.extend(r,B()),angular.isObject(n)&&angular.extend(r,n),V(void 0,"send","pageview",r)})},this._trackEvent=function(e,t,n,r,o,i){q(function(){G("_trackEvent",e,t,n,r,!!o)}),z(function(){var a={},s=function(e){return L("trackEvent",e,!0)};angular.isDefined(o)&&(a.nonInteraction=!!o),angular.isObject(i)&&angular.extend(a,i),angular.isDefined(a.page)||(a.page=j()),V(s,"send","event",e,t,n,r,a)})},this._addTrans=function(e,t,n,r,o,i,a,s,c){q(function(){G("_addTrans",e,t,n,r,o,i,a,s)}),z(function(){if(O._ecommerceEnabled(!0,"addTrans")){V(function(e){return L("trackEcommerce",e,!0)},"ecommerce:addTransaction",{id:e,affiliation:t,revenue:n,tax:r,shipping:o,currency:c||"USD"})}})},this._addItem=function(e,t,n,r,o,i){q(function(){G("_addItem",e,t,n,r,o,i)}),z(function(){if(O._ecommerceEnabled(!0,"addItem")){V(function(e){return L("trackEcommerce",e,!0)},"ecommerce:addItem",{id:e,name:n,sku:t,category:r,price:o,quantity:i})}})},this._trackTrans=function(){q(function(){G("_trackTrans")}),z(function(){if(O._ecommerceEnabled(!0,"trackTrans")){V(function(e){return L("trackEcommerce",e,!0)},"ecommerce:send")}})},this._clearTrans=function(){z(function(){if(O._ecommerceEnabled(!0,"clearTrans")){V(function(e){return L("trackEcommerce",e,!0)},"ecommerce:clear")}})},this._addProduct=function(e,t,n,r,o,i,a,s,c,u){q(function(){G("_addProduct",e,t,n,r,o,i,a,s,c)}),z(function(){if(O._enhancedEcommerceEnabled(!0,"addProduct")){var l=function(e){return L("trackEcommerce",e,!0)},d={id:e,name:t,category:n,brand:r,variant:o,price:i,quantity:a,coupon:s,position:c};angular.isObject(u)&&angular.extend(d,u),V(l,"ec:addProduct",d)}})},this._addImpression=function(e,t,n,r,o,i,a,s){q(function(){G("_addImpression",e,t,n,r,o,i,a,s)}),z(function(){if(O._enhancedEcommerceEnabled(!0,"addImpression")){V(function(e){return L("trackEcommerce",e,!0)},"ec:addImpression",{id:e,name:t,category:o,brand:r,variant:i,list:n,position:a,price:s})}})},this._addPromo=function(e,t,n,r){q(function(){G("_addPromo",e,t,n,r)}),z(function(){if(O._enhancedEcommerceEnabled(!0,"addPromo")){V(function(e){return L("trackEcommerce",e,!0)},"ec:addPromo",{id:e,name:t,creative:n,position:r})}})},this._setAction=function(e,t){q(function(){G("_setAction",e,t)}),z(function(){if(O._enhancedEcommerceEnabled(!0,"setAction")){V(function(e){return L("trackEcommerce",e,!0)},"ec:setAction",e,t)}})},this._trackTransaction=function(e,t,n,r,o,i,a,s,c){this._setAction("purchase",F(e,t,n,r,o,i,a,s,c))},this._trackRefund=function(e){this._setAction("refund",F(e))},this._trackCheckOut=function(e,t){this._setAction("checkout",F(null,null,null,null,null,null,null,e,t))},this._trackDetail=function(){this._setAction("detail"),this._pageView()},this._trackCart=function(e,t){-1!==["add","remove"].indexOf(e)&&(this._setAction(e,{list:t}),this._trackEvent("UX","click",e+("add"===e?" to cart":" from cart")))},this._promoClick=function(e){this._setAction("promo_click"),this._trackEvent("Internal Promotions","click",e)},this._productClick=function(e){this._setAction("click",F(null,null,null,null,null,null,e,null,null)),this._trackEvent("UX","click",e)},this._pageView=function(e){z(function(){K(N("send",e),"pageview")})},this._send=function(){var e=Array.prototype.slice.call(arguments);e.unshift("send"),z(function(){K.apply(O,e)})},this._set=function(e,t,n){z(function(){K(N("set",n),e,t)})},this._trackTimings=function(e,t,n,r){z(function(){V(void 0,"send","timing",e,t,n,r)})},this._trackException=function(e,t){z(function(){V(void 0,"send","exception",{exDescription:e,exFatal:!!t})})},d||(i?this._createAnalyticsScriptTag():this._createScriptTag()),T&&P.$on(C,function(){(!w||R.current&&R.current.templateUrl&&!R.current.doNotTrack)&&O._trackPage()}),{log:O.log,offlineQueue:O.offlineQueue,configuration:{accounts:e,universalAnalytics:i,crossDomainLinker:c,crossLinkDomains:t,currency:u,debugMode:l,delayScriptTag:d,disableAnalytics:m,displayFeatures:p,domainName:n,ecommerce:O._ecommerceEnabled(),enhancedEcommerce:O._enhancedEcommerceEnabled(),enhancedLinkAttribution:h,experimentId:r,hybridMobileSupport:b,ignoreFirstPageLoad:v,logAllCalls:y,pageEvent:C,readFromRoute:w,removeRegExp:o,testMode:_,traceDebuggingMode:S,trackPrefix:x,trackRoutes:T,trackUrlParams:A},getUrl:j,setCookieConfig:O._setCookieConfig,getCookieConfig:function(){return a},createAnalyticsScriptTag:function(e){return e&&(a=e),O._createAnalyticsScriptTag()},createScriptTag:function(){return O._createScriptTag()},offline:function(e){if(!0===e&&!1===k&&(k=!0),!1===e&&!0===k)for(k=!1;O.offlineQueue.length>0;){var t=O.offlineQueue.shift();t[0].apply(O,t[1])}return k},trackPage:function(e,t,n){O._trackPage.apply(O,arguments)},trackEvent:function(e,t,n,r,o,i){O._trackEvent.apply(O,arguments)},addTrans:function(e,t,n,r,o,i,a,s,c){O._addTrans.apply(O,arguments)},addItem:function(e,t,n,r,o,i){O._addItem.apply(O,arguments)},trackTrans:function(){O._trackTrans.apply(O,arguments)},clearTrans:function(){O._clearTrans.apply(O,arguments)},addProduct:function(e,t,n,r,o,i,a,s,c,u){O._addProduct.apply(O,arguments)},addPromo:function(e,t,n,r){O._addPromo.apply(O,arguments)},addImpression:function(e,t,n,r,o,i,a,s){O._addImpression.apply(O,arguments)},productClick:function(e){O._productClick.apply(O,arguments)},promoClick:function(e){O._promoClick.apply(O,arguments)},trackDetail:function(){O._trackDetail.apply(O,arguments)},trackCart:function(e,t){O._trackCart.apply(O,arguments)},trackCheckout:function(e,t){O._trackCheckOut.apply(O,arguments)},trackTimings:function(e,t,n,r){O._trackTimings.apply(O,arguments)},trackTransaction:function(e,t,n,r,o,i,a,s,c){O._trackTransaction.apply(O,arguments)},trackException:function(e,t){O._trackException.apply(O,arguments)},setAction:function(e,t){O._setAction.apply(O,arguments)},pageView:function(){O._pageView.apply(O,arguments)},send:function(e){O._send.apply(O,arguments)},set:function(e,t,n){O._set.apply(O,arguments)}}}]}).directive("gaTrackEvent",["Analytics","$parse",function(e,t){return{restrict:"A",link:function(n,r,o){var i=t(o.gaTrackEvent);r.bind("click",function(){o.gaTrackEventIf&&!n.$eval(o.gaTrackEventIf)||i.length>1&&e.trackEvent.apply(e,i(n))})}}}])}(angular.module("angular-google-analytics",[])),function(e){e.config(["AnalyticsProvider","ANALYTICS_TRACKING_ID",function(e,t){e.setAccount(t).trackPages(!1).useDisplayFeatures(!1).useCrossDomainLinker(!1).useECommerce(!1,!1).useEnhancedLinkAttribution(!1)}])}(angular.module("tnAnalytics",["angular-google-analytics","tnConfig"])),function(e){e.directive("bricklayer",["$timeout",function(e){return{restrict:"C",link:function(t,r,o){var i=n(24),a=n(25),s=new i(r[0]);a(r[0],function(){s.redraw()}),e(function(){s.redraw()}),t.$on("bricklayer.append",function(e,t){s.append(t[0]),s.redraw(),a(t,function(){s.redraw()})}),t.$on("bricklayer.prepend",function(e,t){s.prepend(t[0]),s.redraw(),a(t,function(){s.redraw()})}),t.$on("bricklayer.redraw",function(){s.redraw()})},controller:angular.noop}}]).directive("bricklayerAppend",function(){return{require:"^^bricklayer",restrict:"ACE",link:function(e,t,n){e.$emit("bricklayer.append",t)}}}).directive("bricklayerPrepend",function(){return{require:"^^bricklayer",restrict:"ACE",link:function(e,t,n){e.$emit("bricklayer.prepend",t)}}})}(angular.module("tnBricklayer",[])),function(e){e.value("nodeSize",{width:180,height:200,margin:{left:40,top:80},listed:72}),e.factory("layoutObservers",["ObservableClass",function(e){var t=e(),n=e(),r=e();return{widthObserver:t,scrollObserver:n,nodeDragObserver:e(),scrollEndObserver:r}}]),e.value("treeMargin",50).value("treeMetaHeight",50).value("treesContainerSidesPadding",60).value("treesToolbarHeight",44).value("treeBodyHorizontalPadding",50).value("treeBodyVerticalPadding",16).value("treeLegendHeight",76)}(angular.module("tnLayout",["tnConfig"])),function(e){e.config(["$animateProvider",function(e){e.classNameFilter(/is-animated/)}]),Object.defineProperty(t,"__esModule",{value:!0});n(0);e.factory("linkTransition",["Tab","treeLayout","animationUtil","animationDuration","animationEase",function(e,t,n,r,o){return function(i,a){var s=t.diagonal(a);if(e.active){var c=t.diagonalPrev(a),u=n.transformDiagonal(d3.interpolate(c,s));i.style("opacity",a.target.enter?0:null).transition().ease(o).duration(r).style("opacity",1).tween("d",function(){return u})}else i.attr("d",s)}}]),Object.defineProperty(t,"__esModule",{value:!0});n(0);e.animation(".link",["Tab","treeLayout","animationUtil","animationDuration","animationEase",function(e,t,n,r,o){var i={};return i.leave=function(n,i){var a=d3.select(n[0]),s=a.datum().link,c=t.diagonalPrev(s),u=a.selectAll("path");!e.active||s.source.exit&&!s.target.exit||!s.source.pageExit&&s.target.pageExit?i():u.transition().ease(o).duration(r).attr("d",c).style("opacity",0).each("end",i)},i}]),Object.defineProperty(t,"__esModule",{value:!0});n(0);e.factory("nodeListedLeaveTransition",["Tab","nodeSize","util","animationUtil","animationDuration",function(e,t,n,r,o){var i=t.listed;return function(e,t){var a=n.translate(0,t*i),s=n.translate(0,(t-2)*i),c=r.transformTween(d3.interpolateString(a,s));e.style("will-change","transform").style("z-index",1).transition().duration(o).tween("transform",function(){return c})}}]),Object.defineProperty(t,"__esModule",{value:!0});n(0);e.factory("nodeListedMoveTransition",["Tab","nodeSize","util","animationUtil","animationDuration",function(e,t,n,r,o){var i=t.listed;return function(t,a,s,c){var u=n.translate(0,s*i);if(e.active&&s!=c){var l=n.translate(0,c*i),d=r.transformTween(d3.interpolateString(l,u));t.style("will-change","transform").transition().duration(o).tween("transform",function(){return d}).each("end",function(){t.style("will-change",null).style("z-index",null)})}else t.style("transform",u)}}]),Object.defineProperty(t,"__esModule",{value:!0});n(0);e.factory("nodeMoveTransition",["Tab","util","animationUtil","animationDuration","animationEase",function(e,t,n,r,o){return function(i,a){var s=t.translate(a.x0,a.y0),c=t.translate(a.x,a.y);if(e.active&&s!=c){var u=n.transformTween(d3.interpolateString(s,c));if(i.style("will-change","transform").style("z-index",a.enter?2:null).transition().ease(o).duration(r).tween("transform",function(){return u}).each("end",function(){i.style("will-change",null).style("z-index",null)}),a.enter){var l=i.select(".node__container").style("will-change","opacity").style("opacity",0);l.transition().ease(o).duration(r).style("opacity",1).each("end",function(){l.style("will-change",null).style("opacity",null)})}}else i.style("transform",c)}}]),Object.defineProperty(t,"__esModule",{value:!0});n(0);e.animation(".tree-node",["Tab","util","animationUtil","animationDuration","animationEase",function(e,t,n,r,o){var i={};return i.leave=function(i,a){var s=d3.select(i[0]).select(".node"),c=s.datum().node,u=t.translate(c.x,c.y);if(c.exit=!1,e.active){var l=t.translate(c.x0,c.y0),d=n.transformTween(d3.interpolateString(u,l));s.style("will-change","transform").style("z-index",1).transition().ease(o).duration(r).tween("transform",function(){return d}).style("box-shadow","none").each("end",a),s.select(".node__container").style("will-change","opacity").transition().ease(o).duration(r).style("opacity",0)}else a()},i}]),Object.defineProperty(t,"__esModule",{value:!0});n(0);e.factory("animationUtil",function(){var e={},t=d3.interpolateNumber(0,1),n=d3.interpolateNumber(1,0);return e.opacityInterpolatorEnter=function(){return t},e.opacityInterpolatorExit=function(){return n},e.distance=function(e){return Math.sqrt(Math.pow(e.x-e.x0,2)+Math.pow(e.y-e.y0,2))},e.transformTween=function(e){return function(t){this.style.setProperty("transform",e(t))}},e.transformDiagonal=function(e){return function(t){this.setAttribute("d",e(t))}},e})}(angular.module("tnAnimation",["tnLayout","tnConfig","ngAnimate"])),function(e){e.filter("listedTreeFilter",["filterFilter","Nodes",function(e,t){return function(n,r){if(!r)return n;var o=[];return angular.forEach(n,function(n){var i=n.data.key,a=t.get(i);e([a],r).length&&o.push(n)}),o}}]),e.filter("listedTreeSort",["Nodes","Container",function(e,t){return function(n,r){var o=new t(n),i=r.sortBy,a=r.reverse,s=r.data[i]?function(t){return e.get(t.data.key)[i]||""}:function(e){return e.data.value[i]||""},c=o.sortBy(s);return a&&c.reverse(),c}}]),e.filter("relativeTimestamp",function(){return function(e){return moment(new Date(e)).fromNow()}}).filter("absoluteTimestamp",function(){return function(e){return moment(e).format("MMM DD, YYYY [at] h:mm a")}}),e.filter("numberAbbreviate",function(){var e=new NumberAbbreviate;return function(t){return e.abbreviate(t,1)}}),e.filter("trustAsResourceUrl",["$sce",function(e){return function(t){return e.trustAsResourceUrl(t)}}]),e.filter("treeNodeFilter",["filterFilter","Nodes",function(e,t){return function(n,r){if(!r)return!1;var o=n.data.key,i=t.get(o);return!!e([i],r).length}}]),e.filter("www",function(){return function(e){return e&&"www"==e.slice(0,3)?e.slice(4):e}})}(angular.module("tnFilters",[])),function(e){e.directive("tnActiveChip",function(){return{restrict:"A",link:function(e,t,n){"true"==n.tnActiveChip&&t.parent().parent().addClass("tn-active")}}}),e.directive("tnClipboard",["toastObserver",function(e){return{restrict:"A",link:function(t,r){var o=n(26),i=new o(r[0]);i.on("success",function(){return e.notifyObservers("URL copied")}),t.$on("$destroy",function(){return i.destroy()})}}}]),e.directive("tnDomain",["BASE_URL",function(e){return{restrict:"A",templateUrl:"partials/shared/domain.html"}}]),e.directive("tnImageError",["placeholderImage",function(e){return{restrict:"A",link:function(t,n){var r=n[0];r.onerror=function(){n.addClass("image-error"),r.src=e}}}}]),e.directive("tnInviteFriends",["users",function(e){return{scope:!0,controller:function(){var t=this;t.users=e,t.inviteUrl="https://goo.gl/Wj6Z8f"},controllerAs:"inviteFriendsCtrl",templateUrl:"partials/shared/invite-friends.html",restrict:"E"}}]),e.directive("tnLike",["facebookSDK","URI","FB_ID","BASE_URL",function(e,t,n,r){return{scope:{url:"@",likeLayout:"@",action:"@",size:"@",width:"@",height:"@",share:"@"},restrict:"E",link:function(o,i){var a=o.url,s={href:a,action:o.action||"like",layout:o.likeLayout||"box_count",share:o.share||!1,size:o.size||"small",width:o.width||"89",height:o.height||"48",show_faces:!1,appId:n};e.then(function(){if("undefined"==typeof FB){var e=t(r+"/fblike_iframe").query(s).toString(),n=angular.element("<iframe/>").attr("src",e).attr("width",s.width).attr("height",s.height).attr("style","border:none;overflow:hidden").attr("scrolling","no").attr("frameborder","0").attr("allowTransparency","true");i.append(n)}else{var o=angular.element("<div/>").addClass("fb-like").attr("data-href",s.href).attr("data-show-faces",s.show_faces).attr("data-size",s.size).attr("data-share",s.share).attr("data-action",s.action).attr("data-layout",s.layout);i.append(o),FB.XFBML.parse(i[0])}})}}}]),e.directive("tnShareMenu",function(){return{scope:{category:"@",url:"@",shareUrl:"&",close:"&",publish:"&",preview:"&",container:"&",containerPreview:"&"},controller:"ShareMenuCtrl",controllerAs:"shareMenuCtrl",bindToController:!0,templateUrl:"partials/shared/share-menu.html",restrict:"E"}}),e.directive("tnSvg",["$mdIcon","$parse",function(e,t){return{restrict:"A",link:function(n,r,o){e(o.tnSvg).then(function(e){var n=t(o.tnSvgAttrs)(null)||{};angular.forEach(n,function(t,n){e.setAttribute(n,t)}),r.append(e)})}}}]),e.directive("tnTag",["BASE_URL",function(e){return{restrict:"A",link:function(t){t.linkHref=e+"/tag/"+t.$chip},templateUrl:"partials/shared/tag.html"}}])}(angular.module("tnSharedDirectives",["tnFilters","tnConfig"])),function(e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);e.directive("tnImage",["nodes","placeholderImage",function(e,t){return{restrict:"A",link:function(n,r){function o(){function o(){i.hasNoImage=!0,u.src=t.toString()}var s=e.getNode(a),c=s.locked_image||s.image,u=r[0];if(!c)return void o();u.src=c,u.onerror=function(){return n.$applyAsync(o)},u.alt=s.title}var i=n.nodeCtrl,a=i.node.data.key,s=i.dataObserver;s.subscribe(o),o(),n.$on("$destroy",function(){return s.unsubscribe(o)})}}}]),Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);e.directive("tnListItem",["$animate","nodeListedMoveTransition","nodeListedLeaveTransition",function(e,t,n){return{priority:1,restrict:"A",link:function(r,o){var i=d3.select(o[0]).select(".node-listed");r.$watch("$index",function(e,n){i.call(t,r.node,e,n)}),e.on("leave",o,function(e,t){"start"==t&&i.call(n,r.$index)})}}}]),Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);e.directive("tnNodeDrag",["$q","$interval","trees","Trees","Link","nodeSize","layoutObservers","util",function(e,t,n,o,i,a,s,c){var u={scrollInertia:100,timeout:0,scrollEasing:"linear"};return{priority:1,require:"tnNode",restrict:"A",link:function(l,d){function p(){var e=d3.event,t=e.sourceEvent;if(t.stopPropagation(),t.preventDefault(),3==t.which||2==t.button)return void(g=null);C.node=l.node,g=r.element(v.node()).clone().addClass("node--dragged").removeClass("node--is-open").css("visibility","hidden").css("pointer-events","none").prependTo(document.body)}function m(){if(h&&(t.cancel(h),h=null),g){var e=d3.event,n=e.sourceEvent,r=n.pageX,o=n.pageY,i=C.size,a=C.position;g.css("visibility","visible").css("transform",c.translate(r-.5*i.width,o-.5*i.height));var s=g[0].getBoundingClientRect();a.x=s.left,a.y=s.top,s.top<100?h=t(function(){return l.updateTabScroll("scrollTo","+=50",u)},100):s.bottom>k[0].offsetHeight&&(h=t(function(){return l.updateTabScroll("scrollTo","-=50",u)},100)),b.notifyObservers(C)}}function f(){h&&(t.cancel(h),h=null),g&&(g.remove(),g=null,C.isDragEnd=!0,b.notifyObservers(C),C.isDragEnd=!1,C.node=null)}var g,h,v=d3.select(d[0]).select(".node"),y=l.node.data.key,b=s.nodeDragObserver,k=r.element("#trees-containers"),C={key:y,node:null,isDragEnd:!1,position:{x:0,y:0},size:{width:a.width,height:a.height},callback:function(t){if(n.treesContainer.getTree(t.tree).hasKey(y))return e.reject();var r=o.newLink(t.key,y,new Date),a=e.when(r);return r.put(t.key,new i),a}};v.classed("node--draggable",!0).call(d3.behavior.drag().on("dragstart",p).on("drag",m).on("dragend",f)),v.selectAll(".node__tools, .node__site-container").call(d3.behavior.drag().on("dragstart",function(){var e=d3.event;e.sourceEvent.stopPropagation(),e.sourceEvent.preventDefault()})),l.$on("$destroy",function(){v.on(".drag",null).on(".click",null),v.selectAll(".node__tools, .node__site-container").on(".drag",null)})}}}]),Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=e;o.directive("tnListNodeMenu",function(){return{scope:!0,restrict:"A",require:["?^tnNode","?^tnNodeListed"],link:function(e,t,n,r,o){var i=e.nodeMenuCtrl;i.nodeCtrl=r[0]||r[1],i.template="partials/components/list-node-menu.html",i.includeShare=!!n.includeShare,o(e,function(e){return t.append(e)})},template:"",controller:"NodeMenuCtrl",controllerAs:"nodeMenuCtrl",transclude:!0}}),o.directive("tnNodeMainAction",function(){return{scope:!0,restrict:"A",link:function(e,t,n,r){e.nodeMenuCtrl.nodeCtrl=r},require:"^tnNode",controller:r.noop,templateUrl:"partials/shared/node-main-action.html",controllerAs:"nodeMenuCtrl"}}),o.directive("tnShareNodeMenu",function(){return{scope:!0,restrict:"A",require:"^tnNode",link:function(e,t,n,r,o){var i=e.nodeMenuCtrl;i.nodeCtrl=r,i.template="partials/shared/node-share-menu.html",o(e,function(e){return t.append(e)})},template:"",controller:"MenuCtrl",controllerAs:"nodeMenuCtrl",transclude:!0}}),Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);e.directive("tnNodeTooltip",["nodes","timestampObserver","uppercaseFilter","relativeTimestampFilter","absoluteTimestampFilter",function(e,t,n,r,o){return{restrict:"A",link:function(i,a){function s(){var t=e.getNode(u),i=t.title,s=t.description,c=t.visited,d=t.type,p=t.tags,m=t.address,f=t.url,g=n(i)+"\n\n";f&&(g+=f+"\n\n"),d&&(g+="Type: "+d+"\n\n"),s&&(g+="Description: "+s+"\n\n"),p&&p.length&&(g+="Tags: "+p.join(", ")+"\n\n"),m&&(g+="Address: "+m+"\n\n"),c&&(g+="Visited: "+r(c)+" ("+o(c)+")\n"),l&&(g+="Added: "+r(l)+" ("+o(l)+")\n"),a.attr("title",g)}var c=i.nodeCtrl,u=c.node.data.key,l=c.node.data.value.timestamp,d=c.dataObserver;t.subscribe(s),d.subscribe(s),i.$on("$destroy",function(){d.unsubscribe(s),t.unsubscribe(s)}),s()}}}]),Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);e.directive("tnNodeType",["nodes",function(e){return{restrict:"A",link:function(t,n){var r=e.getNode(t.nodeCtrl.node.data.key).type;r&&n.attr("data-node-type"," ("+r+")")}}}]);var o=e;o.directive("tnNode",function(){return{priority:2,restrict:"E",scope:{node:"=",openUrl:"&",container:"&",containerPreview:"&",scroll:"&"},templateUrl:"partials/shared/node.html",controller:"NodeCtrl",controllerAs:"nodeCtrl",bindToController:!0,transclude:{menu:"?nodeMenu",tools:"?nodeTools",main:"?nodeMain",share:"?nodeShare"}}}),o.directive("tnNodeListed",["$rootScope",function(e){return{priority:2,restrict:"E",scope:{node:"=",openUrl:"&",showVisited:"=",container:"&",containerPreview:"&",scroll:"&"},templateUrl:function(){return e.isMobile?"partials/mobile/node-listed.html":"partials/shared/node-listed.html"},controller:"NodeCtrl",controllerAs:"nodeCtrl",bindToController:!0,transclude:!0}}]),o.directive("tnNodePath",function(){return{priority:2,restrict:"E",scope:{node:"=",last:"=",openUrl:"&"},templateUrl:"partials/shared/node-path.html",controller:"NodeCtrl",controllerAs:"nodeCtrl",bindToController:!0}}),Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);e.directive("tnTextContainer",["$compile","$interpolate",function(e,t){var n=t("<ng-transclude></ng-transclude><span tn-text='{{property}}'></span>");return{terminal:!0,restrict:"A",link:function(t,r,o,i,a){e(n({property:o.tnTextContainer}))(t,function(e){return r.append(e)},{parentBoundTranscludeFn:a,futureParentElement:r})},transclude:!0}}]),Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);e.directive("tnText",["relativeTimestampFilter","absoluteTimestampFilter","numberAbbreviateFilter","nodes","timestampObserver","nodesConfig","propertyType",function(e,t,n,r,o,i,a){var s=i.type;return{restrict:"A",link:function(t,i,c){function u(){var t,o=r.getNode(l)[d]||"";if(o)switch(p){case a.date:t=e(o);break;case a.count:var s=parseInt(o);s&&(t=n(s));break;default:t=o}t?(i.text(t),i.parent().removeClass("ng-hide")):i.parent().addClass("ng-hide")}var l=t.nodeCtrl.node.data.key,d=c.tnText,p=s[d],m=t.nodeCtrl.dataObserver;m.subscribe(u),p==a.date&&o.subscribe(u),t.$on("$destroy",function(){m.unsubscribe(u),p==a.date&&o.unsubscribe(u)}),u()}}}])}(angular.module("tnNodeDirectives",["tnSharedDirectives"])),function(e){e.directive("tnSecondaryImage",function(){return{scope:{primary:"@",secondary:"@"},restrict:"A",link:function(e,t){var n=t[0],r=!1;n.onerror=function(){e.secondary&&!r?(n.src=e.secondary,r=!0):t.addClass("ng-hide")},n.src=e.primary}}}),Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);e.directive("tnLink",["linkTransition","nodeLinkDefaultColor",function(e,t){return{restrict:"A",link:function(n,r,o){function i(){var t=n.link;t.target.exit||(l&&a(t.source.color),c.call(e,t))}function a(e){u.attr("stroke",e||t)}var s=d3.select(r[0]).datum(n),c=s.selectAll("path"),u=c.filter(".link-visible"),l=!o.tnLink;n.$watchGroup(["link.source.x","link.source.y","link.target.x","link.target.y"],i)},templateUrl:"partials/shared/link.html"}}]),Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);e.directive("tnTreeItemShared",function(){return{priority:1,require:["?tnNode","?tnNodeListed"],restrict:"A",link:function(e,t,n,r){var o=r[0]||r[1],i=e.node.data.key,a=e.treeCtrl;o.treeKey=e.tree.key,o.googleSearch=function(e){a.googleSearch(e,i)},o.showNodeDialog=function(e){a.showNodeDialog(e,i)}}}}),Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);e.directive("tnTreeItem",["$q","$interval","$parse","$timeout","debounce","layoutObservers","nodeSize","util","nodeSearchResultColorExpression","nodeMoveTransition",function(e,t,n,o,i,a,s,c,u,l){var d=n("node | treeNodeFilter: vm.searchText"),p={scrollInertia:100,timeout:0,scrollEasing:"linear"};return{priority:1,require:"?tnNode",restrict:"A",link:function(n,m,f,g){function h(){var e=n.node,t=e.y-e.y0,r=t<0?"+="+Math.abs(t):"-="+t;t&&n.updateTabScroll("scrollTo",r)}function v(){var e=n.node,t=e.data.value.page,r=t*N;e._children&&(g.disableNext=e._children.length<=r+N,g.disablePrev=0==t,g.showNav=!!(e._children.length>N&&e.children&&e.children.length),g.showExpand=!!e._children.length&&!e.children,g.showCollapse=!(!e.children||!e.children.length))}function y(e){e&&d({node:n.node,vm:E})?g.nodeColors=u:g.nodeColors=null}function b(){var e=d3.event,t=e.sourceEvent;if(t.stopPropagation(),t.preventDefault(),3==t.which||2==t.button)return void(T=null);R.node=n.node,D=E.getBoundingClientRect(),T=r.element(M.node()).clone().addClass("node--dragged").removeClass("node--is-open").css("visibility","hidden").css("pointer-events","none").prependTo(document.body)}function k(){if(A&&(t.cancel(A),A=null),T){var e=d3.event,r=e.sourceEvent,o=r.pageX,i=r.pageY,a=R.size,s=R.position,u=E.zoomBehavior.scale();T.css("visibility","visible").css("transform",c.translate(o-.5*u*a.width,i-.5*u*a.height)+c.scale(u));var l=T[0].getBoundingClientRect();s.x=l.left,s.y=l.top,l.top<100?A=t(function(){return n.updateTabScroll("scrollTo","+=50",p)},100):l.bottom>L[0].offsetHeight?A=t(function(){return n.updateTabScroll("scrollTo","-=50",p)},100):l.right>D.right-100?A=t(function(){return E.scrollX(20)},50):l.left-100<D.left&&(A=t(function(){return E.scrollX(-20)},50)),$.notifyObservers(R)}}function C(){A&&(t.cancel(A),A=null),T&&(T.remove(),T=null,R.isDragEnd=!0,$.notifyObservers(R),R.isDragEnd=!1,R.node=null,D=null)}function w(e){if((R.tree!=e.tree||!(R.key==e.key||e.node.parent&&R.key==e.node.parent.data.key))&&E.editable){var t=!1,n=M.node().getBoundingClientRect(),r=E.zoomBehavior.scale();R.position.x=n.left,R.position.y=n.top,R.position.x<e.position.x+.5*r*e.size.width&&R.position.x+.5*r*R.size.width>e.position.x&&R.position.y<e.position.y+.5*r*e.size.height&&.5*r*R.size.height+R.position.y>e.position.y&&(t=!e.isDragEnd,e.isDragEnd&&e.callback(R).then(_)),M.classed("node--is-overlapping",t)}}function _(e){var t=E.pasteBranch(P,e);t&&(t.execute(),E.updateData(t),E.update())}function S(){var e=n.node;e.exit||(M.call(l,e),e.enter=!1,e.exit=!1,e.pageExit=!1,e.pageEnterNext=!1,e.pageEnterPrev=!1)}function x(){var e=n.node,t=O()||U(),r=e.isLeaf;e.size=R.size={width:s.width,height:s.height},M.classed("node--is-root",t).classed("node--is-leaf",r&&!t),v()}var T,A,D,M=d3.select(m[0]).select(".node").datum(n),E=n.treeCtrl,P=n.node.data.key,$=a.nodeDragObserver,I=E.searchTextObserver,O=r.bind(E,E.isFocused,P),U=r.bind(E,E.isRoot,P),L=r.element("#trees-containers"),N=E.maxTreeBreadth,R={tree:E.key,key:P,node:null,isDragEnd:!1,position:{x:0,y:0},size:{width:0,height:0},callback:function(t){var n=E.getTree(),r=n.getBranchCopy(this.key),i=e.when(r);return this.tree==t.tree&&r.hasKey(t.key)?e.reject():E.editable&&n.root!=this.key?E.execute("deleteBranch",this.key,!1).then(function(){return o(500)}).then(function(){return i}):i}};if(L=L[0]?L:r.element("#embedded-tree-container"),n.$watchGroup(["node.x","node.y"],S),g){var j=function(e){e.x0=e.x,e.y0=e.y-(N+1)*s.height,e.pageExit=!0},B=function(e){e.x0=e.x-(N+1)*s.width,e.y0=e.y,e.pageExit=!0},F=function(e){e.x0=e.x,e.y0=e.y+(N+1)*s.height,e.pageExit=!0},q=function(e){e.x0=e.x+(N+1)*s.width,e.y0=e.y,e.pageExit=!0};g.isSelectedPage=P==n.tree.value.meta.selectedPage,g.showNext=i(function(){n.$applyAsync(function(){var e=n.node,t=e.data.value.page+=1,r=t*N;e.descendants().slice(1).forEach(E.treeNodesCtrl.vertical?B:j),e.children=e._children.slice(r,r+N),e.descendants().slice(1).forEach(function(e){return e.pageEnterNext=!0}),v(),E.updateLayout(),h()})},1e3,!0),g.showPrev=i(function(){n.$applyAsync(function(){var e=n.node,t=e.data.value.page-=1,r=t*N;e.descendants().slice(1).forEach(E.treeNodesCtrl.vertical?q:F),e.children=e._children.slice(r,r+N),e.descendants().slice(1).forEach(function(e){return e.pageEnterPrev=!0}),v(),E.updateLayout(),h()})},1e3,!0),g.setChildren=i(function(e){n.$applyAsync(function(){var t=n.node;if(e){var r=t.data.value.page,o=r*N;t.data.value.expanded=!0,t.data.value.collapsed=!1,t.children=t._children.slice(o,o+N),t.isNotEmpty=!1}else t.data.value.expanded=!1,t.data.value.collapsed=!0,t.children=null,t.isNotEmpty=!0;v(),E.updateLayout(),h()})},1e3,!0),g.focus=function(){E.updateFocus(n.node),E.updateLayout()},n.node.data.value.related||(M.classed("node--draggable",!0).call(d3.behavior.drag().on("dragstart",b).on("drag",k).on("dragend",C)),$.subscribe(w),M.selectAll(".node__tools, .node__site-container").call(d3.behavior.drag().on("dragstart",function(){var e=d3.event;e.sourceEvent.stopPropagation(),e.sourceEvent.preventDefault()}))),I.subscribe(y),n.$watch(function(){return O()||U()},x),n.$watchGroup(["node._children.length","node.children.length"],x),n.$on("$destroy",function(){$.unsubscribe(w),I.unsubscribe(y),M.on(".drag",null).on(".click",null),M.selectAll(".node__tools, .node__site-container").on(".drag",null)})}}}}]),Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=e;o.directive("tnTreeMenu",function(){return{restrict:"E",link:function(e){e.treeMenuCtrl.template="partials/shared/tree-menu.html"},template:"<ng-transclude></ng-transclude>",controller:"MenuCtrl",controllerAs:"treeMenuCtrl",transclude:!0}}),o.directive("tnTreeShareMenu",["GData",function(e){return{restrict:"E",link:function(t){var n=t.treeShareMenuCtrl,r=n.open;n.template="partials/shared/tree-share-menu.html",n.open=function(o){if(!e.isLogin()&&t.treeCtrl.editable)return o.preventDefault(),void t.mainCtrl.login();r.call(n,o)}},template:"<ng-transclude></ng-transclude>",controller:"MenuCtrl",controllerAs:"treeShareMenuCtrl",transclude:!0}}]),o.directive("tnTreeSortMenu",function(){return{restrict:"E",link:function(e){e.treeSortMenuCtrl.template="partials/shared/tree-sort-menu.html"},template:"<ng-transclude></ng-transclude>",controller:"MenuCtrl",controllerAs:"treeSortMenuCtrl",transclude:!0}}),Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=e,i=function(e,t,n,o,i){var a=e.nodeMenuCtrl,s=e.treeCtrl;a.nodeCtrl=o[0]||o[1],a.isListed=s.treeNodesCtrl.isListed,a.isFocused=r.bind(s,s.isFocused,e.node.data.key),a.isRoot=r.bind(s,s.isRoot,e.node.data.key),a.editable=s.editable,a.template="partials/shared/tree-node-menu.html",a.includeShare=!!n.includeShare,i&&i(e,function(e){return t.append(e)})};o.directive("tnTreeNodeMenu",function(){return{scope:!0,restrict:"A",link:i,template:"",require:["?^tnNode","?^tnNodeListed"],controller:"NodeMenuCtrl",controllerAs:"nodeMenuCtrl",transclude:!0}}),o.directive("tnTreeNodeTools",function(){return{scope:!0,restrict:"A",link:i,require:["^tnNode"],controller:r.noop,templateUrl:"partials/shared/tree-node-tools.html",controllerAs:"nodeMenuCtrl"}}),Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),a=n(13),o=e,s=function(e){return e.data.key};o.directive("tnTree",["$mdDialog","$timeout","$compile","$parse","$templateCache","$rootScope","Analytics","NodeMeta","Tab","treeLayout","treesConfig","nodeSize","layoutObservers","keysObserver","dialogConfig","relatedDialogConfig","mapDialogConfig","util","animationUtil","animationDuration","animationEase","treeMetaHeight","treeMargin","treesToolbarHeight","treeBodyHorizontalPadding","treeBodyVerticalPadding","treeLegendHeight","propertyType",function(e,t,n,o,i,c,u,l,d,p,m,f,g,h,v,y,b,k,C,w,_,S,x,T,A,D,M,E){var P=f.listed,$=8,I={width:100,height:100},O=r.element(i.get("partials/shared/minimap.html")),U=n(O),L=o("array | listedTreeFilter: vm.searchText | listedTreeSort: vm.treeNodesCtrl"),N=a.stratify().id(function(e){return e.key}).parentId(function(e){return e.value.parent}),R=function(n,o){function i(e){var t=ae.scale(),n=t*fe.height;fe.position.y<n&&(37==e?ee.scrollX(-20):39==e&&ee.scrollX(20))}function a(e){var t=ae.scaleExtent();ee.disableZoomIn=e>=t[1],ee.disableZoomOut=e<=t[0]}function c(e,t){return function(){var n=d3.event;if(n.stopPropagation(),!n.defaultPrevented){var r=d3.mouse(this),o=t.width,i=t.height,a=t.viewportWidth,s=d.height,c=(o-.75*a)*(r[0]/I.width),l=(i-.75*s)*(r[1]/I.height);t.setTreePosition(c,l),e.call(F,t),q(t),u.trackEvent("tree","minimapClick","")}}}function l(){var e=d3.event;e.sourceEvent.stopPropagation(),e.sourceEvent.preventDefault()}function C(){var e=d3.event;e.sourceEvent.stopPropagation(),e.sourceEvent.preventDefault()}function x(e,t){return function(){var n=d3.event,r=n.x,o=n.y,i=B(t),a=r*t.width/I.width,s=o*t.height/I.height;t.setTreePosition(a,Math.min(s,i)),e.call(F,t),q(t)}}function O(e,t){function n(){a(d3.event.scale),t.setTreePosition(t.position.x,t.position.y),e.call(V,t,!0),q(t)}var r=t.width,o=t.height;ae=ae.size([r,o]).on("zoom",n)}function R(e,t){J.call(d3.behavior.drag().on("dragstart",l).on("drag",x(e,t)).on("dragend",function(){C(),u.trackEvent("tree","minimapDrag","")}))}function j(e,t){var n=0;e.call(d3.behavior.drag().on("dragstart",function(){var e=d3.event.sourceEvent;n=e.pageY,l()}).on("drag",function(){var r=d3.event,o=r.dx,i=r.sourceEvent,a=t.position,s=a.x,c=a.y,u=i.pageY,l=u-n,d=B(t),p=s-o,m=c-l;n=u,t.setTreePosition(p,Math.min(m,d)),e.call(F,t),q(t)}).on("dragend",function(){n=0,C(),u.trackEvent("tree","backgroundDrag","")}).origin(function(){return{x:0,y:0}}))}function B(e){return ae.scale()*e.height-d.height+T+S+M+2*D+$}function F(e,t,r){void 0===r&&(r=!0);var i=t.position,a=i.x,s=i.y,c=ae.scale(),u=k.translate(-a,D)+k.scale(c);r&&n.updateTabScroll("scrollTo",s+o[0].offsetTop,{scrollInertia:0,timeout:0,callbacks:!1}),e.style("transform",u)}function q(e){ce.call(K,e),J&&J.call(z,e)}function G(){t(function(){fe.updateViewportWidth(),fe.setTreePosition(fe.position.x,fe.position.y),pe.isListed||le.call(F,fe),q(fe)},500,!1)}function z(e,t){var n=d.height,r=t.width,o=t.height,i=t.position,a=t.viewportWidth,s=i.x,c=i.y,u=ae.scale();r&&(s=Math.max(.5*A,s-.5*A),c=Math.max(.5*D,Math.min(c,u*o-n)),e.attr("width",Math.max(0,Math.min(r,(1-u)*r+a)-A)).attr("height",Math.max(0,Math.min(o,(1-u)*o+n)-.5*D)).attr("transform","translate("+s+", "+c+")"))}function K(e,t){if(!ne){var n=ae.scale(),r=n*t.height,o=t.position.y,i=o>0&&o<r-f.height;e.classed("tree-toolbar--fixed",i).style("width",i?e.node().parentNode.clientWidth+"px":null)}}function V(e,t,n){var r=t.width,o=t.height,i=t.prevHeight,a=t.prevScale,s=t.prevScale=ae.scale(),u=s*o+2*D,l=a*i+2*D,d=d3.interpolateString(l+"px",u+"px");n?ue.style("height",d(1)):ue.call(H,d),Z.call(W,t,n).on("click",c(e,t)),J.call(z,t),t.prevWidth=r,t.prevHeight=o,t.updateViewportWidth(),e.style("height",o+"px").style("width",r+"px").call(j,t).call(R,t).call(O,t)}function Y(e,t,n){var r=t.height,o=t.prevHeight,i=t.prevScale,a=i*o,s=d3.interpolateString(a+"px",r+"px");t.prevScale=1,n?ue.style("height",s(1)):ue.call(H,s),e.on(".drag",null).style("height",null).style("width",null).style("transform",null),t.prevHeight=r}function W(e,t,n){function r(e){var t=this;t.style.setProperty("height",p(e)),t.style.setProperty("width",m(e)),t.style.setProperty("transform",h(e))}var o=t.width,i=t.height,a=t.prevWidth,s=t.prevHeight,c=I.width/o,u=I.height/i,l=k.scale(c,u),p=d3.interpolateString(s+"px",i+"px"),m=d3.interpolateString(a+"px",o+"px"),f=I.width/a,g=I.height/s,h=d3.interpolateString(k.scale(f,g),l);d.active&&!n?e.transition().duration(w).tween("minimap",function(){return r}):r.call(e.node(),1)}function H(e,t){var n=o.parent(),r=parseFloat(t(1))-parseFloat(t(0));if(r){var i=d3.interpolateString(k.translate(0,0),k.translate(0,r));if(e.transition().ease(_).duration(w).styleTween("height",function(){return t}).each("end",function(){return se.style("height",null)}),n.hasClass("tree-meta")){var a=n.parent().nextAll().add(n.nextAll()).add(o.closest(".trees-container").next());se.style("height",o.height()+"px"),d3.selectAll(a).filter(function(){var e=d3.select(this);return e.classed("tree-meta")||e.classed("trees-subhead")||e.classed("trees-list")||e.classed("trees-container")}).classed("container-animated",!0).transition().ease(_).duration(w).styleTween("transform",function(){return i}).each("end",function(){d3.select(this).classed("container-animated",!1).style("transform",null)})}}}function Q(e){fe.setTreePosition(fe.position.x,-e-o[0].offsetTop),q(fe)}var X,Z,J,ee=n.treeCtrl,te=n.userSettings,ne=n.isMobile,re=n.isEmbedded,oe=g.scrollObserver,ie=g.widthObserver,ae=ee.zoomBehavior=d3.behavior.zoom().scaleExtent([.5,1]).scale(te.zoom),se=d3.select(o[0]),ce=se.select(".tree-toolbar"),ue=se.select(".tree-body"),le=ue.select(".tree-nodes"),de=r.element(ce.node()),pe=ee.treeNodesCtrl=r.copy(m.treeCtrl),me=!0,fe={width:0,height:0,prevWidth:0,prevHeight:0,prevScale:ae.scale(),viewportWidth:0,position:{x:-A,y:0},setTreePosition:function(e,t){var n=this,r=n.width,o=n.height,i=n.position,a=n.viewportWidth,s=ae.scale();i.x=Math.max(-A,Math.min(e,s*r-a+A)),i.y=Math.min(Math.max(t,0),s*o)},updateViewportWidth:function(){this.viewportWidth=o.width()||o[0].getBoundingClientRect().width}},ge=te.maxTreeDepth;ne||U(n,function(e){Z=d3.select(e[0]).select(".tree-minimap"),J=Z.select(".frame rect"),de.prepend(e)},{futureParentElement:de}),re&&(T=0),ie.subscribe(G),oe.subscribe(Q),h.subscribe(i),n.$applyAsync(function(){le.node().focus()}),o[0].id=n.tree.key,ee.maxTreeBreadth=te.maxTreeBreadth,ee.searchText="",ee.nodeSize=f,ee.focusedNode=null,ee.updateViewportWidth=function(){return fe.updateViewportWidth()},ee.clear=function(){Z&&Z.on(".zoom",null).on(".click",null),le.on(".drag",null),J&&J.on(".drag",null),ie.unsubscribe(G),oe.unsubscribe(Q),h.unsubscribe(i)},ee.updateLayoutDirection=function(){te.treeLayout=pe.vertical,ee.updateLayout()},ee.updateSort=function(e){if(pe.sortBy!=e){var t=pe.sortBy=e||pe.sortBy,n=pe.sortOrder;switch(pe.type[t]){case E.date:pe.reverse=!n;break;case E.str:pe.reverse=n}te.treeSort=t}},ee.expandTree=function(){function e(t){t._children&&(t.children=t._children,t.children.forEach(e),t.isNotEmpty=!1)}e(ee.focusedNode||X)},ee.updateTree=function(){var e=n.tree.value,t=e.getCompareFunction(pe),r=X&&d3.map(X.descendants(),s),o=e.toArray().filter(function(t){return t.value.isRoot||e.hasKey(t.value.parent)});X=N(o).sort(function(e,n){return t(e.data,n.data)}),r&&X.each(function(e){var t=r.get(e.data.key);t&&(e.x=t.x,e.y=t.y)}),X.each(function(e){var t=e.data.key,n=ee.isRoot(t),r=e.isLeaf=!e.children;e.isDeleteOne=!(e.data.value.related||r||!ee.editable||n||ee.isFocused(t)),e.isDeleteBranch=!e.data.value.related&&ee.editable&&!n&&r,e.isDeleteRoot=ee.editable&&n&&e.children&&1==e.children.length&&!e.children[0].data.value.related})},ee.updateFocus=function(e){ee.focusedNode=e;var t=ee.focusedNode||X,n=t.depth;ee.expandTree(),pe.isExpanded||t.descendants().forEach(function(e){var t=e.depth-n,r=e.data.value;if(!e.isLeaf){if(e._children=e._children||e.children,!r.collapsed&&(r.expanded||t<ge)){var o=r.page*ee.maxTreeBreadth;return e._children[o]||(r.page-=1,o-=ee.maxTreeBreadth),void(e.children=e._children.slice(o,o+ee.maxTreeBreadth))}e.children=null,e.isNotEmpty=!0}})},ee.updateLayout=function(e){var t,r=n.tree.value,o=ee.focusedNode||X,i=pe.vertical,a=pe.isListed;if(fe.prevWidth=fe.width,fe.prevHeight=fe.height,ee.focusedNode?ee.treePath=ee.focusedNode.ancestors().slice(1).reverse():ee.treePath=null,ee.showMinimap=o.descendants().some(function(e){return e.children&&e.children.length>1}),!ee.showMinimap&&me&&(a=pe.isListed=!0),me=!1,a)ee.expandTree(),ee.listedNodes=L({array:o.descendants(),vm:ee}),fe.height=ee.listedNodes.length*P,fe.width=null,ee.nodes=null,ee.links=null,t=Y;else{var s=p.nodes(o,ee.nodes,ee.maxTreeBreadth+1,i);ee.nodes=s.nodes,ee.links=o.links(),fe.height=s.height,fe.width=s.width,ee.listedNodes=null,t=V}ee.hasImages=!!r.getImages().length,ee.hasMap=!!r.getGeo().length,ee.hasYoutubeVideos=!!r.getYoutubeVideos().length,ee.expandTreeDisabled=!pe.isExpanded&&n.tree.value.length==X.descendants().length,fe.updateViewportWidth(),le.call(F,fe,!1).call(t,fe,e)},ee.update=function(e){var t=null;if(ee.updateTree(),ee.focusedNode){var n=ee.focusedNode.data.key;t=X.descendants().filter(function(e){return n==e.data.key})[0]}ee.updateFocus(t),ee.updateLayout(e)},ee.isRoot=function(e){return X.data.key==e},ee.isFocused=function(e){return ee.focusedNode&&ee.focusedNode.data.key==e},ee.openTreeDialog=function(t){var o=r.copy(v);o.targetEvent=t,o.locals={treeMeta:n.tree.value.meta,isOpened:!0},o.scope=n.$new(),e.show(o)},ee.openRelatedDialog=function(t,o,i,a){var s=r.copy(y),c=s.scope=n.$new();return s.targetEvent=t,s.onShowing=function(){o.then(function(t){var n=c.relatedDialogCtrl;n.container=t,n.loading=!1,n.openUrl=function(t){return e.hide(t)},n.title=a,n.node=i})},e.show(s)},ee.showImagesDialog=function(t){e.show({targetEvent:t,hasBackdrop:!0,disableParentScroll:!0,clickOutsideToClose:!0,locals:{treeKey:ee.key},controller:"TreeImagesDialogCtrl",controllerAs:"vm",templateUrl:"partials/shared/images-dialog.html"})},ee.showMapDialog=function(t){var o=r.copy(b);o.targetEvent=t,o.locals={geoNodes:n.tree.value.getGeo(),title:n.tree.value.meta.title},e.show(o)},ee.clickPath=function(e){ee.isRoot(e.data.key)&&(e=null),ee.updateFocus(e),ee.updateLayout()},ee.zoom=function(e){t(function(){var t=+(ae.scale()+.1*(e?1:-1)).toFixed(1),n=ae.scaleExtent();t>=n[0]&&t<=n[1]&&(ae=ee.zoomBehavior=ae.scale(t),ae.event(Z),te.zoom=t),a(t),le.call(F,fe,!1)})},ee.search=function(){var e="treeView";pe.isListed&&(e="treeListView",ee.updateLayout()),ee.searchText&&u.trackEvent("tree","search",e),ee.searchTextObserver.notifyObservers(ee.searchText)},ee.scrollX=function(e){var t=fe.position,n=t.x,r=t.y,o=n+e;fe.setTreePosition(o,r),le.call(F,fe,!1),q(fe)},ee.getBoundingClientRect=function(){return ue.node().getBoundingClientRect()},a(ae.scale()),ee.updateSort(null)};return{restrict:"E",templateUrl:function(){return c.isMobile?"partials/mobile/tree.html":"partials/shared/tree.html"},controller:"TreeCtrl",link:R,controllerAs:"treeCtrl",bindToController:!0}}]),o.service("treeLayout",["nodeSize",function(e){var t=this,n=e.margin,o=e.width,i=e.height,c=function(){return 1},u=function(e){return[e.x,e.y+.5*i]},l=function(e){return e.x},d=function(e){return e.y},p=a.tree().separation(c).nodeSize([i+n.left,o+n.top]),m=a.tree().separation(c).nodeSize([o+n.left,i+n.top]);t.diagonal=d3.svg.diagonal().source(function(e){return{x:e.source.x+o-5,y:e.source.y}}).target(function(e){return{x:e.target.x+5,y:e.target.y}}).projection(u),t.diagonalPrev=d3.svg.diagonal().source(function(e){var t=e.source,n=e.target,r=t.x0+o-5,i=t.y0;return t.x===n.x0&&t.y===n.y0&&(r=t.x+o-5,i=t.y),{x:r,y:i}}).target(function(e){return{x:e.target.x0+5,y:e.target.y0}}).projection(u),t.nodes=function(t,n,a,c){void 0===c&&(c=!1);var u=c?m:p,f=t.parent;t.parent=null;var g,h,v,y,b=u(t.copy()).descendants(),k=t.descendants(),C=d3.map(n||[],s),w=d3.map(k,s),_=d3.map(),S=!!n;if(k.forEach(function(e,t){e.x0=e.x,e.y0=e.y,e.x=b[t].x,e.y=b[t].y}),c){var x=d3.max(k,l),T=d3.min(k,l);h=d3.max(k,d),g=x-T;var A=.5*g;v=function(e){e.x0=A,e.y0=0,_.set(s(e),!0)},y=function(e){return e.x-=T}}else{k.forEach(function(e){return e.x=[e.y,e.y=e.x][0]});var D=d3.max(k,d),M=d3.min(k,d);g=d3.max(k,l),h=D-M;var E=.5*h;v=function(e){e.x0=0,e.y0=E,_.set(s(e),!0)},y=function(e){return e.y-=M}}return w.forEach(function(e,t){if(y(t),C.has(e)){var n=C.get(e);t.size=n.size,t.domain=n.domain,t.favicon=n.favicon,t.color=n.color,n.x=t.x,n.y=t.y}else t.x0=t.x,t.y0=t.y}),S&&(C.forEach(function(e,t){return _.set(s(t),!1)}),w.forEach(function(t,n){if(!C.has(t)&&(n.enter=!0,!_.get(t))){if(n.pageEnterNext)return void(c?(n.x0=n.x+a*e.width,n.y0=n.y):(n.x0=n.x,n.y0=n.y+a*e.height));if(n.pageEnterPrev)return void(c?(n.x0=n.x-a*e.width,n.y0=n.y):(n.x0=n.x,n.y0=n.y-a*e.height));for(var o=n.parent,i=[n];o&&!C.has(s(o));)i.push(o),o=o.parent;o?r.forEach(i,function(e){e.x0=o.x0,e.y0=o.y0,_.set(s(e),!0)}):r.forEach(i,v)}}),C.forEach(function(e,t){if(!w.has(e)&&(t.exit=!0,!t.pageExit&&!_.get(e))){for(var n=t.parent,o=[t];n&&!w.has(s(n));)o.push(n),n=n.parent;n?r.forEach(o,function(e){e.x0=n.x,e.y0=n.y,_.set(s(e),!0)}):r.forEach(o,v)}})),t.parent=f,{nodes:k,height:h+i,width:g+o}}}])}(angular.module("tnTreeDirectives",["tnLayout","tnNodeDirectives","tnUtil"])),function(e){e.controller("AnalyticsDialog",["$element","urlShortener","dialogConfig",function(e,t,n){function r(e){return e.append("div").attr("class","toolTip"),e.append("svg").append("g").attr("transform","translate("+p/2+","+m/2+")").call(i)}function o(e){s.call(a,e.countries),l.call(a,e.referrers),c.call(a,e.browsers),u.call(a,e.platforms)}function i(e){e.append("g").attr("class","slices"),e.append("g").attr("class","labelName"),e.append("g").attr("class","labelValue"),e.append("g").attr("class","lines")}function a(e,t){function n(e){return e.startAngle+(e.endAngle-e.startAngle)/2}var r=d3.select(e.node().parentNode.parentNode);if(!t)return void r.style("display","none");var o=t.map(function(e){return parseInt(e.count)}).reduce(function(e,t){return e+t}),i=r.select(".toolTip"),a=d3.scale.category20(),s=d3.scale.ordinal().range(a.range());t.forEach(function(e){return e.value=Math.round(parseInt(e.count)/o*1e4)/100});var c=0,u=0;t=t.filter(function(e){var t=e.value>=2;return t||(c+=e.value,u+=parseInt(e.count)),t}),c&&t.unshift({value:Math.round(100*c)/100,id:"Others",count:u.toString()});var l=e.select(".slices").selectAll("path.slice").data(g(t),function(e){return e.data.id});l.enter().insert("path").style("fill",function(e){return s(e.data.id)}).attr("class","slice"),l.transition().duration(1e3).attrTween("d",function(e){this._current=this._current||e;var t=d3.interpolate(this._current,e);return this._current=t(0),function(e){return h(t(e))}}),l.on("mousemove",function(e){i.style("left",d3.event.pageX+10+"px"),i.style("top",d3.event.pageY-25+"px"),i.style("display","inline-block"),i.html(e.data.id+"<br>"+e.data.value+"%")}),l.on("mouseout",function(e){i.style("display","none")}),l.exit().remove();var d=s.domain();"Others"==d[0]&&(d.push(d[0]),d.shift());var p=e.selectAll(".legend").data(d).enter().append("g").attr("class","legend").attr("transform",function(e,t){var n=y+b,r=n*d.length/2;return"translate("+-3*y+","+(t*n-r)+")"});p.append("rect").attr("width",y).attr("height",y).style("fill",function(e){return s(e)}).style("stroke",function(e){return s(e)}),p.append("text").attr("x",y+b).attr("y",y-b+2.25).text(function(e){return e});var m=e.select(".labelName").selectAll("text").data(g(t),function(e){return e.data.id});m.enter().append("text").attr("dy",".35em").text(function(e){return e.data.id+": "+e.value+"%"}),m.transition().duration(1e3).attrTween("transform",function(e){this._current=this._current||e;var t=d3.interpolate(this._current,e);return this._current=t(0),function(e){var r=t(e),o=v.centroid(r);return o[0]=f*(n(r)<Math.PI?1:-1),"translate("+o+")"}}).styleTween("text-anchor",function(e){this._current=this._current||e;var t=d3.interpolate(this._current,e);return this._current=t(0),function(e){return n(t(e))<Math.PI?"start":"end"}}).text(function(e){return e.data.id+": "+e.value+"%"}),m.exit().remove();var k=e.select(".lines").selectAll("polyline").data(g(t),function(e){return e.data.id});k.enter().append("polyline"),k.transition().duration(1e3).attrTween("points",function(e){this._current=this._current||e;var t=d3.interpolate(this._current,e);return this._current=t(0),function(e){var r=t(e),o=v.centroid(r);return o[0]=.95*f*(n(r)<Math.PI?1:-1),[h.centroid(r),v.centroid(r),o]}}),k.exit().remove()}var s,c,u,l,d=this,p=960,m=450,f=Math.min(p,m)/2,g=d3.layout.pie().sort(null).value(function(e){return e.value}),h=d3.svg.arc().outerRadius(.8*f).innerRadius(.4*f),v=d3.svg.arc().innerRadius(.9*f).outerRadius(.9*f),y=.05*f,b=.02*f;d.url="https://goo.gl/"+n.key,d.title=n.title,d.onload=function(){s=r(d3.select("#countries")),c=r(d3.select("#browsers")),u=r(d3.select("#platforms")),l=r(d3.select("#referrers")),t.analytics(n.key).then(function(e){o(e.analytics.allTime),d.clicks=e.analytics.allTime.longUrlClicks,d.created=e.created})}}]),e.controller("ArticleDialogCtrl",["$scope","$element","$rootScope","$mdDialog","URI","BASE_URL","nodeKey","treeKey",function(e,t,n,r,o,i,a,s){function c(e){var t=e.data;e.origin==i&&t.isArticle&&!t.len&&(n.openUrl(a,"articleError"),r.hide())}var u={key:a,is_frame:!0},l=t.find("iframe")[0];s&&!parseInt(s)&&(u.tree=s),l.src=o(i).path("/article/").query(u).toString(),l.onload=function(){t.find("#article-dialog-progress").remove()},window.addEventListener("message",c,!1),e.$on("$destroy",function(){return window.removeEventListener("message",c)})}]),e.controller("MapDialogCtrl",["$scope","maps","geolocation","geoNodes",function(e,t,n,o){function i(e){return o.forEach(function(e){var n=t.createNodeMarker(d,e,a);d.getCenter()||d.setCenter(n.marker.getPosition()),u.push(n)}),e}function a(){u.forEach(function(e){return e.infoWindow.value.setZIndex(1)})}function s(e){var t=e.infoWindow.value;t.close(),t.setContent("")}function c(){u.forEach(s)}var u=[],l=r.element("#map-container")[0],d=t.createMap(l,c);n.getCurrentPosition().then(function(e){return t.createUserMarker(d,e)}).then(i,i).then(function(e){e&&t.setUserDistances(e,u)}),e.$on("$destroy",function(){return u.forEach(function(e){t.clearInstanceListeners(e.marker),e.infoWindow.scope.$destroy()})}),r.element("#map-progress").remove()}]),e.controller("MenuCtrl",["$scope","$templateCache","$timeout","$animate","$mdPanel",function(e,t,n,o,i){var a,s=this;s.open=function(n){var c=e.$new(),u=r.element(n.currentTarget),l=i.newPanelPosition().relativeTo(u).addPanelPosition(i.xPosition.ALIGN_START,i.yPosition.ALIGN_TOPS).addPanelPosition(i.xPosition.ALIGN_START,i.yPosition.CENTER).addPanelPosition(i.xPosition.ALIGN_START,i.yPosition.ALIGN_BOTTOMS).addPanelPosition(i.xPosition.ALIGN_END,i.yPosition.ALIGN_TOPS).addPanelPosition(i.xPosition.ALIGN_END,i.yPosition.CENTER).addPanelPosition(i.xPosition.ALIGN_END,i.yPosition.ALIGN_BOTTOMS),d=i.newPanelAnimation().openFrom(u[0]).closeTo(u[0]).withAnimation(i.animation.SCALE),p={scope:c,template:t.get(s.template),position:l,animation:d,targetEvent:n,clickOutsideToClose:!0,escapeToClose:!0,trapFocus:!0,panelClass:"_md md-clickable md-whiteframe-4dp md-open-menu-container",origin:u,onDomAdded:function(){o.addClass(a.panelEl,"md-active").then(function(){a.panelEl.find("md-menu-content").mCustomScrollbar({theme:"minimal-dark"})})},onRemoving:function(){a.panelEl.removeClass("md-active"),o.addClass(a.panelEl,"md-leave"),a.panelEl.find("md-menu-content").mCustomScrollbar("destroy")},onDomRemoved:function(){c.$destroy(),s.destroy&&s.destroy(),a=null}};a=i.create(p),a.open()},s.close=function(){return a&&a.close()}}]),e.controller("NodeDialogCtrl",["URI","nodes","dialogConfig","BASE_URL",function(e,t,n,r){var o=this;o.node=t.getNode(n.key),o.transformTag=function(e){return e},o.domain=e(o.node.url).host(),o.domainUrl=r+"/domain/"+o.domain,o.openUrl=n.openUrl,o.loading=!0,t.linkedNodes(n.key).then(function(e){return o.container=e}).finally(function(){return o.loading=!1})}]),Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);e.controller("NodeMenuCtrl",["$scope","$controller","GData","nodes",function(e,t,n,r){var o=t("MenuCtrl as nodeMenuCtrl",{$scope:e}),i=o.open;o.open=function(e){if(n.isLogin()){var t=o.nodeCtrl;r.hasFavorite(t.node.data.key).then(function(e){t.favorite=e,t.favoriteDisabled=!1})}i.call(o,e)},o.destroy=function(){return o.nodeCtrl.favoriteDisabled=!0}}]),Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);e.controller("NodeCtrl",["$scope","$rootScope","$mdDialog","$q","GData","Analytics","URI","nodes","users","rss","uriParser","Trees","toastObserver","nodeColorExpression","nodeRelatedColorExpression","nodeDialogConfig","mapDialogConfig","reportDialogConfig","userImagesDialogConfig","relatedDialogConfig","analyticsDialog","ObservableClass","BASE_URL",function(e,t,n,o,i,a,s,c,u,l,d,p,m,f,g,h,v,y,b,k,C,w,_){function S(){P.isOpened=P.isSelectedPage||c.openedTabs&&c.openedTabs.any(function(e){return D.equals(e)})}function x(){var e=f,t=c.getNode(A);if(P.node){P.node.data.value.related&&(e=g),P.nodeColors&&(e=P.nodeColors),D=s(t.url||A);var n=D.host();P.node.domain=n,P.node.color=t.color,P.node.favicon=t.favicon,P.colors=e,P.hasGeolocation=!!t.geo,P.isPDF="PDF"==t.type,P.isWebSearch="web search"==t.type,P.hasRSS=!!t.rss,P.isArticle=t.isArticle&&"www.youtube.com"!=n&&"www.netflix.com"!=n&&"twitter.com"!=n,S()}}function T(o,i,a,s,c,u){void 0===c&&(c="related"),void 0===u&&(u=!0);var l=r.copy(k),d=l.scope=e.$new();l.targetEvent=o,l.onShowing=function(){i.then(function(e){var n=d.relatedDialogCtrl;n.container=e,n.loading=!1,n.title=s,n.node=a,n.openUrl=function(e){if(u)return t.openUrl(e,c);t.openLongUrl(e,c)}})},n.show(l)}var A,D,M,E,P=this,$=c.openedTabsObserver,I=P.dataObserver=w();P.favoriteDisabled=!0,P.$onInit=function(){A=P.node.data.key;var t=c.getNode(A);switch(P.nodeShortURL=c.getShortUrl(A),D=s(t.url||A),t.url?P.nodeURL=c.getShortUrl(A,t.isArticle):P.nodeURL=A,M=c.getYoutubeVideoId(t),P.isYoutubeVideo=!!M,D.host()){case"www.facebook.com":E=t.facebook_id||d.getFacebookId(D),P.hasPhotos=!!E}S(),e.$on("update:"+A,function(){I.notifyObservers(),x()}),P.node.title=t.title.slice(0,10)+(t.title.length>10?"...":""),P.favoriteDisabled=!1,P.domainUrl=_+"/domain/"+D.host()},P.showPhotosDialog=function(e){var t=r.copy(b);t.targetEvent=e,t.locals={facebook_id:E,title:c.getNode(A).title},n.show(t)},P.openYoutubeVideo=function(e){var t=o.defer(),r=o.defer();n.show({targetEvent:e,controller:"YoutubeIFrameDialogCtrl",controllerAs:"youtubeIFrameDialogCtrl",templateUrl:"partials/shared/youtube-dialog.html",hasBackdrop:!0,disableParentScroll:!0,clickOutsideToClose:!0,locals:{youtubeDialogData:{videoId:M,onLoad:t.promise,onClose:r.promise,nodeCtrl:P}},onRemoving:function(){return r.resolve()},onShowing:function(){return t.resolve()}}).catch(console.log)},P.showMapDialog=function(e){var t=r.copy(v);t.targetEvent=e,t.locals={geoNodes:[c.getNode(A)],title:c.getNode(A).title},n.show(t)},P.openArticle=function(e){n.show({targetEvent:e,controller:"ArticleDialogCtrl",templateUrl:"partials/shared/article-dialog.html",hasBackdrop:!0,disableParentScroll:!0,clickOutsideToClose:!0,locals:{nodeKey:A,treeKey:P.treeKey}})},P.showReportDialog=function(e){if(!i.isLogin())return t.login();var o=r.copy(y);o.targetEvent=e,o.locals={reportTarget:{node:A}},n.show(o).then(function(e){P.reportDisabled=!0,e?I.notifyObservers():t.userSettings.reportGoogleDisabled||n.show({hasBackdrop:!1,disableParentScroll:!0,clickOutsideToClose:!0,templateUrl:"partials/shared/report-google-dialog.html",controller:function(){var e=this;e.reportUrl="https://goo.gl/"+A,e.showDialogChange=function(){a.trackEvent("reportGoogleDialog","show","")}},controllerAs:"reportGoogleDialog"})})},P.showNodeDialog=function(e){var o=r.copy(h);o.targetEvent=e,o.locals={dialogConfig:{key:A,openUrl:function(){return t.openUrl(A,"linked")}}},n.show(o)},P.showAnalyticsDialog=function(e){var t=c.getNode(A).title,o=r.copy(C);o.targetEvent=e,o.locals={dialogConfig:{key:A,title:t}},n.show(o)},P.related=function(e){T(e,c.related(A),c.getNode(A),"Related")},P.rss=function(e){T(e,l.query(A),c.getNode(A),"RSS","rss",!1)},P.googleSearch=function(e){var t=c.getNode(A);T(e,c.googleSearch(t.title),t,"Search","google",!1)},P.toggleFavorite=function(){var e,n="Added to favorites";if(!i.isLogin())return t.login();P.favorite?(n="Removed from favorites",e=c.removeFavorite(A)):e=c.addFavorite(A),e.then(function(){m.notifyObservers(n),P.favorite=!P.favorite})},P.copyNode=function(e){return p.bufferNode(e)},P.getPreview=function(){return c.getNodePreview(A)},$.subscribe(S),e.$watch("nodeCtrl.nodeColors",x),e.$on("$destroy",function(){I.removeObservers(),$.unsubscribe(S)})}]),e.controller("ReportDialogCtrl",["$mdDialog","nodes","trees","toastObserver","reportTarget",function(e,t,n,r,o){var i=this;i.report=function(){var a;o.node?a=t.report(o.node,i.reason).then(function(e){return e.isBlocked}):o.tree&&(a=n.report(o.tree,i.reason).then(function(){return!1})),a&&a.then(function(t){r.notifyObservers("Content reported"),e.hide(t)})},i.cancel=function(){return e.hide()}}]),e.controller("ShareMenuCtrl",["$rootScope","$mdDialog","GData","users","facebook","bufferService","Analytics","URI","debounce",function(e,t,n,o,i,a,s,c,u){function l(e){var t;g.publish&&(t=g.publish()),t?t.then(e):e()}function d(e){t.show({targetEvent:e,disableParentScroll:!0,clickOutsideToClose:!1,hasBackdrop:!0,controllerAs:"vm",controller:m,templateUrl:"partials/shared/buffer-dialog.html"})}function p(e){t.show({targetEvent:e,disableParentScroll:!0,clickOutsideToClose:!0,hasBackdrop:!0,controllerAs:"vm",controller:f,templateUrl:"partials/shared/facebook-pages-dialog.html",onComplete:function(e,t){t.find("md-dialog-content").mCustomScrollbar({theme:"minimal-dark"})},onRemoving:function(e){e.find("md-dialog-content").mCustomScrollbar("destroy")}})}function m(){var e,t=this;e="node"==g.preview().type?g.containerPreview&&g.containerPreview():g.preview(),t.container=g.container(),e&&t.container.unshift(e),t.container.length||(t.container=[g.preview()]),t.current=t.container.filter(function(e){return e.targetUrl==g.url})[0],t.container.forEach(function(e,n){e.domain=c(e.url).domain(),e.targetUrl==g.url&&(t.current=e,n>0&&(t.container.splice(n,1),t.container.unshift(e)))}),t.publishEvent=[g.category,"share","buffer"],t.publish=function(){if(!t.loading){var e=t.profiles.filter(function(e){return e.selected}).map(function(e){return e.id}),n={photo:t.current.photo||"",link:t.current.targetUrl};t.loading=!0,a.createUpdate({profile_ids:e,media:n,now:t.current.now||!1,top:t.current.top||!1,text:t.current.text||"",shorten:!0}).then(function(e){t.current.isPublished=e.success,t.error=!e.success,t.messeage=e.message},function(){return t.error=!0}).finally(function(){return t.loading=!1})}},t.selectTag=function(e){var n=e.split(" "),e="#"+e[0].toUpperCase()+e.slice(1);n.length>1&&(e="#"+n.map(function(e){return e[0].toUpperCase()+e.slice(1)}).join("")),t.current.text=t.current.text||"",-1===t.current.text.indexOf(e)&&(t.current.text+=" "+e,s.trackEvent("bufferDialog","tag",""))},t.onProfileSelect=function(){t.publishDisabled=!t.profiles.some(function(e){return e.selected}),s.trackEvent("bufferDialog","profile","")},t.trackEvent=function(e){s.trackEvent("bufferDialog",e,"")},a.getProfiles().then(function(e){t.profiles=e,t.profiles.forEach(function(e){e.selected=!0})})}function f(){var e=this,t=[],n=e.preview=g.preview();e.domain=c(n.url).domain(),e.facebook=i,e.publishEvent=[g.category,"share","facebookPages"],e.loginPublisher=u(function(){return i.simple_login(["publish_actions","publish_pages"]).then(function(e){return i.publisherLogin(e)})},5e3,!0,!0),e.publish=function(n){e.loading||(e.loading=!0,i.publish(n,g.url).then(function(){return t.push(n.id)}).finally(function(){return e.loading=!1}))},e.isPagePublished=function(e){return-1!==t.indexOf(e)},i.groups||e.loginPublisher()}var g=this;g.$onInit=function(){g.provider={},g.shareUrlEvent=[g.category,"share","url"],g.shareFacebookPagesEvent=[g.category,"facebookPages"],g.shareBufferEvent=[g.category,"buffer"],g.event={shareFacebook:[g.category,"share","facebook"],shareGoogle:[g.category,"share","google"],shareTwitter:[g.category,"share","twitter"],sharePocket:[g.category,"share","pocket"]},r.forEach(g.event,function(e,t){g.provider[t]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];g.close&&g.close(),l(function(){return o[t].apply(o,e)})}})},g.shareFacebookPages=function(t){if(!n.isLogin())return e.login();l(function(){return p(t)}),g.close()},g.shareBuffer=function(t){return n.isLogin()?a.isLogin()?(l(function(){return d(t)}),void g.close()):a.login():e.login()}}]),e.controller("TreeDialogCtrl",["$mdDialog","Analytics","trees","tagsApi","disqus","treeMeta",function(e,t,n,o,i,a){var s=this,c=a.id,u=!1,l=a.observer;s.commentCount=0,s.treeMeta=r.copy(a),s.save=function(){var t=s.treeMeta.title,r=s.treeMeta.description;t!=a.title||r!=a.description?(a.title=t,a.description=r,n.editTree(c).finally(function(){return e.hide()}),l.notifyObservers()):e.hide()},s.cancel=function(){return e.hide()},s.addTag=function(e){r.copy(s.treeMeta.tags,a.tags),n.addTag(c,e),t.trackEvent("treeInfo","tagAdd",""),l.notifyObservers()},s.removeTag=function(e){r.copy(s.treeMeta.tags,a.tags),n.removeTag(c,e),t.trackEvent("treeInfo","tagRemove",""),l.notifyObservers()},s.transformTag=o.transformTag,s.searchTags=function(){return o.getTags(s.searchText)},s.openComments=function(){u||i.reset(c,a.title),u=!0,t.trackEvent("treeInfo","comments","")},a.editable&&!a.published||i.getCommentCount(c).then(function(e){return s.commentCount=e})}]),e.controller("TreeEditorsDialogCtrl",["$scope","GApi","users","trees","debounce","Analytics","userIds","treeKey",function(e,t,n,r,o,i,a,s){function c(){u.container=l.toArray(),u.container.forEach(function(e){e.value.isEditor=a.indexOf(e.key)>-1}),u.showInvite=n.showInvite()}var u=this,l=u.usersContainer=n.usersContainer;u.container=[],u.disableScroll=function(){return l.loading||!l.more},u.scroll=function(){return l.more&&n.load()},u.canEdit=function(e){var t=e.id;e.isEditor?(a.push(t),r.addEditor(t,s)):(a.splice(a.indexOf(t),1),r.removeEditor(t,s)),u.isMaxEditors=a.length>=10,i.trackEvent("tree","editor","")},u.onload=function(){u.$element.find("md-dialog-content").mCustomScrollbar({theme:"minimal-dark",axis:"y",callbacks:{onTotalScroll:o(function(){u.disableScroll()||u.scroll()},1e3),onOverflowY:function(){u.hasScrollBar=!0},onOverflowYNone:function(){u.hasScrollBar=!1}}})},l.subscribe(c),e.$on("$destroy",function(){l.clear(),l.unsubscribe(c)}),u.scroll()}]),e.controller("TreeImagesDialogCtrl",["$timeout","trees","treeKey",function(e,t,n){var r=this,o=t.treesContainer.getTree(n);o&&(e(function(){return r.imageNodes=o.getImages()},1e3),r.selectImage=function(i){e(function(){return r.currentImage=i}),o.meta.image=i,t.editImage(n)},r.currentImage=o.meta.image,r.title=o.meta.title,r.editable=o.meta.editable&&!o.meta.limitedEdit)}]),Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);e.controller("TreeCtrl",["$rootScope","$scope","$timeout","$mdDialog","GData","trees","nodes","users","Analytics","firebaseService","chromeTabs","rss","toastObserver","Trees","TreeMeta","Nodes","ObservableClass","debounce","treeEditorsDialogConfig","reportDialogConfig","util","deleteTreeConfirmDialog","nodeDialogConfig","nodeUrlDialogConfig","analyticsDialog","BASE_URL","STORAGE_URL","animationDuration",function(e,t,n,o,i,a,s,c,u,l,d,p,m,f,g,h,v,y,b,k,C,w,_,S,x,T,A,D){function M(n){n.name==G.toString()&&n.onMessage.addListener(function(n){"page:close"==n.type?t.$destroy():e.$emit("command:"+G,n)})}function E(n,r){var o,i=moment().day(-1).toDate();return o=n.type=="link:"+G?new Date(n.value.timestamp):new Date(n.value.modified),o.setMilliseconds(0),o<i&&q.editable?void r():n.type=="link:"+G?void e.$emit(n.type,n):void(-1===["store","remove"].indexOf(n.type.split(".")[0])?o>=W&&t.$applyAsync(function(){return P(n)}):o>t.tree.value.meta.modified&&(t.tree.value.meta.modified=o,n.value.nodes&&n.value.nodes.forEach(function(e){return h.addNode(e.value,e)}),t.$applyAsync(function(){return $(n)})))}function P(e){var n;switch(e.type){case"edit.tree":var r=t.tree.value.meta;r.title=e.value.title,r.description=e.value.description,r.observer.notifyObservers();break;case"favorite.tree":n=e.value.favorite,t.tree.value.meta.favorite=n;break;case"publish.tree":n=e.value.published,t.tree.value.meta.published=n}}function $(e){switch(e.type){case"store.links":z.storeLinks(e.value);break;case"remove.links":z.removeLinks(e.value);break;case"store.link":z.storeLink(e.value);break;case"remove.link":z.removeLink(e.value);break;case"store.root":z.storeRoot(e.value);break;case"remove.root":z.removeRoot(e.value)}q.update()}function I(e,r,o){function i(r){var i=t.tree.value,a=i.get(r);!a||a.related?(O(r,e),n(function(){return t.openUrl(r,o,q.windowId)},D)):t.openUrl(r,o,q.windowId)}return void 0===r&&(r=!0),void 0===o&&(o="related"),function(e){if(e)if(r){if(!q.editable)return t.openLongUrl(e,o,q.windowId);s.getNodeRequest(e).then(function(e){return e.value}).then(i)}else{if(!q.editable)return t.openUrl(e,o,q.windowId);i(e)}}}function O(e,n){var r=t.tree.value;r.remove(e);var o=f.newLink(n,e,new Date),i=r.getMerge(o);i.execute(),q.updateData(i),q.update()}function U(e){e&&t.tree.value.hasKey(e)&&(q.updateSort(null),q.update())}function L(e){return e&&e.filter(function(e){return!t.tree.value.hasKey(e.data.key)})}function N(){var e=t.tree.value.keys();return s.getNodes(e).then(function(){if(s.getNodesRequest&&!t.user&&q.editable){var n=e.filter(function(e){return!h.hasKey(e)});if(n.length)return s.getNodesRequest(n)}})}function R(){return h.getByKeys(t.tree.value.keys()).map(function(e){return e.url})}function j(e){q.windowId=e}function B(e){q.windowId==e&&j(null)}var F,q=this,G=q.key=t.tree.key,z=a.treesContainer,K=T+"/embed/?tree="+G,V="trees/"+t.tree.value.meta.shortUrl+"/commands",Y=t.tree.value.meta.modified,W=new Date,H=e.$on("link:"+G,function(e,n,o,i){void 0===i&&(i=r.noop),t.$applyAsync(function(){var e=n.value,r=e.link,o=e.timestamp,i=new Date(o);if(i.setMilliseconds(0),!(i<=t.tree.value.meta.modified)){var a=f.newLink(r.parent,r.child,i),s=t.tree.value.getMerge(a);t.newNode(n.value),s&&(t.tree.value.meta.modified=i,s.execute(),q.update())}}),i()});t.tree.value.isOpened=!0,q.selectedPage=t.tree.value.meta.selectedPage,q.treeUrl=T+"/?tree="+G,q.url=t.tree.value.meta.shortUrl,q.shortUrl=s.getShortUrl(t.tree.value.meta.shortUrl),q.embedCode='<iframe width="400" height="500" frameborder="0" allowfullscreen src="'+K+'"</iframe>',q.editable=t.tree.value.meta.editable,q.limitedEdit=t.tree.value.meta.limitedEdit,q.searchTextObserver=v(),q.add=y(function(){var e=t.tree.value;i.isLogin()||t.isExtension?a.add(e).then(function(){return t.tree.value.meta.isReposted=!0}):t.mainCtrl.login()},1e3,!0,!1),q.toggleFavorite=y(function(){t.tree.value.meta.favorite=!t.tree.value.meta.favorite,a.toggleFavorite(G)},1e3,!0,!1),q.togglePublished=y(function(){return i.isLogin()?(t.tree.value.meta.published=!t.tree.value.meta.published,a.togglePublished(G)):void t.mainCtrl.login()},1e3,!0,!1),q.canShare=function(){return t.tree.value.meta.published||!q.limitedEdit},q.shareUrl=function(){},q.publish=function(){if(!t.tree.value.meta.published&&q.editable){var e=t.tree.value.meta.title,r=e.slice(0,15);return e.length>15&&(r+="..."),q.togglePublished().then(function(){return m.notifyObservers('Tree "'+r+'" is now public')}).then(function(){return n(3e3)})}},q.getPreview=function(){var e=t.tree.value.meta;return{title:e.title+"| Brancher",image:A+"tree_image/"+e.shortUrl,secondaryImage:e.image,url:T,description:e.description,targetUrl:q.shortUrl,type:"tree",tags:e.tags}},q.getNodesPreview=function(){var e=t.tree.value.sortBy(function(e){return e.value.timestamp}).map(function(e){return e.key});return s.getNodesPreview(e)},q.shareYoutube=function(){if(!i.isLogin())return void t.mainCtrl.login();c.loginYoutube().then(function(e){o.show({scope:t,preserveScope:!0,templateUrl:"partials/shared/youtube-tree-dialog.html",controller:"YoutubeTreeDialogCtrl",controllerAs:"youtubeTreeDialog",hasBackdrop:!0,disableParentScroll:!0,clickOutsideToClose:!0,locals:{accessToken:e}})})},q.updateData=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!0),a.commandQueue.enqueue(function(){return a.updateTree(G,e,t,n).then(function(){var n,o=e.getCount();if(e.isMerge?n=!t:e.isRemove&&(n=!!t),r.isDefined(n)){var i=n?o+" node(s) added":o+" node(s) removed";m.notifyObservers(i)}})},null,[])},q.execute=function(e,t,r){return void 0===r&&(r=!0),n(function(){var n=z.method(e)(G,t);if(n)return n.execute(),q.update(),q.updateData(n,!1,r)},0)},q.undo=y(function(){n(function(){var e=t.tree.value.stack;e.undo(),q.updateData(e.getCommand(e.pointer),!0),q.update()},0)},1e3,!0,!1),q.redo=y(function(){n(function(){var e=t.tree.value.stack;e.redo(),q.updateData(e.getCurrent()),q.update()})},1e3,!0,!1),q.updateView=y(function(e){q.treeNodesCtrl.isListed=!q.treeNodesCtrl.isListed,q.update(e)},1e3,!0,!1),q.updateExpandedView=function(){q.treeNodesCtrl.isExpanded=!q.treeNodesCtrl.isExpanded,q.updateFocus(null),q.updateLayout()},q.removeRelated=function(e){t.tree.value.remove(e),q.update()},q.openUrl=function(e){var n=t.tree.value,r=n.get(e);r.related&&n.meta.editable&&O(e,r.parent),t.openUrl(e,q.treeNodesCtrl.isListed?"treeListView":"treeView",q.windowId)},q.related=function(e,t){q.openRelatedDialog(e,s.related(t).then(L),s.getNode(t),"Related").then(I(t,!1))},q.rss=function(e,t){q.openRelatedDialog(e,p.query(t),s.getNode(t),"RSS").then(I(t,!0,"rss"))},q.googleSearch=function(e,t){var n=s.getNode(t),r=s.googleSearch(n.title);q.openRelatedDialog(e,r,n,"Search").then(I(t,!0,"google"))},q.showNodeDialog=function(e,t){var n=r.copy(_);n.targetEvent=e,n.locals={dialogConfig:{key:t,openUrl:function(e){return o.hide(e)}}},o.show(n).then(I(t,!1,"linked"))},q.addUrlDialog=function(e,n){var i=r.copy(S);i.targetEvent=e,i.controller=function(){var e=this;e.getUrl=function(t){e.loading=!0,s.getNodeRequest(t).then(function(e){return o.hide(e.value)}).finally(function(){return e.loading=!1})}},o.show(i).then(function(e){t.tree.value.hasKey(e)||O(e,n)})},q.showEditorsDialog=function(e){if(!i.isLogin())return void t.mainCtrl.login();var n=r.copy(b);n.targetEvent=e,n.locals={userIds:t.tree.value.meta.editors,treeKey:q.key},o.show(n)},q.showReportDialog=function(e){if(!i.isLogin())return t.mainCtrl.login();var n=r.copy(k);n.targetEvent=e,n.locals={reportTarget:{tree:q.key}},o.show(n).then(function(){return q.reportDisabled=!0})},q.buffer=function(){a.treesContainer.bufferTree(G)},q.sync=function(){a.sync(G).then(function(){t.tree.value.meta.sync=0,q.update()})},q.newTree=function(e){var n=s.getNode(e)||{},r=t.tree.value;if(r.hasKey(e)){var o=new Date,i={title:n.title||"Untitled",description:n.description,image:n.image,tags:n.tags,created:o,modified:o},r=r.getBranch(e);r.meta=new g("",i),a.add(r)}},q.getTree=function(){return t.tree.value},q.pasteBranch=function(e,t){return u.trackEvent("node","drag",""),z.pasteBranch(G,e,t)},q.openTabs=function(){function e(e){return d.openTabs(e.slice(0,5).map(function(e){return"https://goo.gl/"+e.value}),q.windowId).then(j)}var n=t.tree.value.sortBy(function(e){return e.value}).map(function(e){return s.getNode(e.key)});q.treeNodesCtrl.reverse&&n.reverse(),r.isNumber(q.windowId)?d.getWindowURIs(q.windowId).then(function(e){return n.filter(function(t){return!e.some(function(e){return e.equals(t.url)})})}).then(e):e(n)},q.closeTabs=function(){d.closeTabs(R()).then(function(){return j(null)})},q.moveTabs=function(){d.moveTabs(R(),q.windowId).then(j)},q.deleteTreeDialog=function(e){o.show(w(e)).then(function(){a.removeTree(G),u.trackEvent("tree","deleteTree","tree")})},q.showAnalyticsDialog=function(e){var n=r.copy(x);n.targetEvent=e,n.locals={dialogConfig:{key:t.tree.value.meta.shortUrl,title:t.tree.value.meta.title}},o.show(n)},q.setUpCommandsListener=function(){i.isLogin()||!q.editable||q.limitedEdit?(l.on(V,"child_added",E),F=function(){return l.off(V,"child_added")}):F=e.$on("command:"+G,function(e,n,o,i){void 0===i&&(i=r.noop);var a,s;if(n.type=="link:"+G){var c=n.value;a=c.tree.id,s=n,t.newNode(c)}else a=n.value.value.id,s=n.value;a==G&&E(s,r.noop),i()})},q.$onInit=function(){t.$emit("tree:init")},q.$postLink=function(){t.$emit("tree:postLink")},q.init=function(){return N().then(function(){return q.update(!0)})},t.isPage&&chrome.runtime.onConnect.addListener(M),t.$on("$destroy",function(){q.clear(),t.tree.value.isOpened=!1,h.unsubscribe(U,q),s.windowCloseObserver.unsubscribe(B,q),H(),F&&F(),t.tree.value.meta.modified>Y&&a.updateContainer(G,["modified"]),t.isPage&&chrome.runtime.onConnect.removeListener(M)}),h.subscribe(U,q),s.windowCloseObserver.subscribe(B,q),q.editable&&!q.limitedEdit||c.getUser(t.tree.value.meta).then(function(e){return t.tree.value.meta.user=e},r.noop)}]),e.controller("UserImagesDialogCtrl",["$scope","$timeout","facebook","facebook_id","title",function(e,t,n,r,o){function i(){return a.loading=!0,n.listUserPhotos(r,c).then(function(e){e&&(e.data=e.data||[],c=e.paging&&e.paging.next,s=!!c,e.data.forEach(function(e){e.link=e.images&&e.images[0]&&e.images[0].source}),a.images=a.images.concat(e.data))}).finally(function(){return a.loading=!1})}var a=this,s=!0,c="";a.images=[],a.loading=!1,a.title=o,e.scrollConfig={theme:"minimal-dark",axis:"y",callbacks:{onTotalScroll:function(){s&&!a.loading&&i()}}},i().then(function(){a.noResults=!a.images.length})}]),Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);e.controller("YoutubeIFrameDialogCtrl",["$rootScope","$element","nodes","youtubeIFrame","BASE_URL","youtubeDialogData",function(e,t,n,r,o,i){function a(e){if(void 0===e&&(e=1),s.autoplay){var t=c.container().map(function(e){return n.getYoutubeVideoId(e)}).filter(function(e){return!!e}),o=t.indexOf(i.videoId);if(o==t.length-1){if(c.scroll&&e>=1){var u=c.scroll();u&&u.then(function(){return a(e-1)})}}else i.videoId=t[o+1],r.loadVideoById(i.videoId)}}var s=this,c=i.nodeCtrl,u=i.videoId,l=e.userSettings;s.autoplay=!l.autoplayOff,s.autoplayChange=function(){l.autoplayOff=!s.autoplay},i.onLoad.then(function(){var e=t.find("iframe")[0];e.src=r.getFrameUrl(i.videoId),e.onload=function(){r.createPlayer(e,function(e){0==e&&a()},function(){i.videoId!=u&&a()})}}),i.onClose.then(function(){return r.destroy()})}]),Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);e.controller("YoutubeTreeDialogCtrl",["$scope","$http","$timeout","$q","URI","accessToken",function(e,t,n,r,o,i){function a(e){var a=r.when();return c.getYoutubeVideos().forEach(function(r){a=a.then(function(){return t.post(u+i,{snippet:{playlistId:e,resourceId:{kind:"youtube#video",videoId:o(r.url).query(!0).v}}}).then(function(){return n(2e3)})})}),a}var s=this,c=e.tree.value,u="https://www.googleapis.com/youtube/v3/playlistItems?part=snippet,status&access_token=";t.post("https://www.googleapis.com/youtube/v3/playlists?part=snippet,status&access_token="+i,{snippet:{title:c.meta.title,description:c.meta.description,tags:c.meta.tags||[]},status:{privacyStatus:"public"}}).then(function(e){var t=e.data.id;return s.playlistUrl="https://www.youtube.com/playlist?list="+t,n(2e3).then(function(){return t})}).then(a).then(function(){s.complete=!0})}])}(angular.module("tnSharedControllers",["tnLayout"])),function(e){e.run(["GAuth","CLIENT_ID","SCOPES",function(e,t,n){e.setClient(t),e.setScope(n.join(" "))}])}(angular.module("tnGapiShared",["angular-google-gapi","tnConfig"])),function(e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(n(0),n(2));n(3),n(4);var o=function(){function e(e){if(this.$q=e,this.firebase=r,this.refs={},r){var t={apiKey:"AIzaSyAVFXhdstGRYa40dbjNhJmzKx4ASVrBpuA",authDomain:"getbrancher.firebaseapp.com",databaseURL:"https://getbrancher.firebaseio.com",storageBucket:"getbrancher.appspot.com",messagingSenderId:"988709185566"};this.firebase.initializeApp(t),this.database=this.firebase.database()}}return e.prototype.getToken=function(e){var t=this.$q.defer();return e?(e.getToken().then(function(e){return t.resolve(e)}).catch(function(){return t.reject()}),t.promise):this.$q.reject()},e.prototype.login=function(e){var t=this,n=this.$q.defer(),r=this.firebase.auth(),o=r.currentUser,i=function(e){return n.resolve(e)};return o?o.providerData.some(function(t){return t.providerId==e.providerId})?i(o):this.link(o,e).then(i,function(){return i(o)}):r.signInWithCredential(e).then(i,function(e){return n.reject(e)}),n.promise.then(function(e){return t.getToken(e)})},e.prototype.signInWithPopup=function(e,t){var n=this,r=this.$q.defer();return this.firebase.auth().signInWithPopup(e).then(function(e){return r.resolve(e.user)}).catch(function(e){return r.reject(e)}),r.promise.then(function(e){return n.link(e,t)}).then(function(e){return n.getToken(e)})},e.prototype.onAuthError=function(e,t){var n=this;return function(r){switch(r.code){case"auth/account-exists-with-different-credential":case"auth/internal-error":return n.signInWithPopup(e,t)}return n.$q.reject()}},e.prototype.link=function(e,t){var n=this.$q.defer();return e.linkWithCredential(t).then(function(e){return n.resolve(e)},function(){return n.reject()}),n.promise},e.prototype.onAuthStateChanged=function(e){this.firebase.auth().onAuthStateChanged(function(t){return e(!!t)})},e.prototype.loginFacebook=function(e){var t=this.firebase.auth.FacebookAuthProvider.credential(e);return this.login(t).then(function(e){return e},this.onAuthError(new this.firebase.auth.GoogleAuthProvider,t))},e.prototype.loginGoogle=function(e){var t=this.firebase.auth.GoogleAuthProvider.credential(null,e);return this.login(t).then(function(e){return e},this.onAuthError(new this.firebase.auth.FacebookAuthProvider,t))},e.prototype.logoutFacebook=function(){return this.logout("facebook.com")},e.prototype.logoutGoogle=function(){return this.logout("google.com")},e.prototype.logout=function(e){var t=this.firebase.auth().currentUser;return t&&t.providerData.some(function(t){return t.providerId==e})?this.unlink(e):this.$q.when()},e.prototype.unlink=function(e){var t=this.$q.defer();return this.firebase.auth().currentUser.unlink(e).then(function(){return t.resolve()},function(){return t.reject()}),t.promise},e.prototype.on=function(t,n,r){var o=this.database.ref(t);o.on(n,function(e){return r(e.val(),function(){return e.ref.remove()})}),this.refs[e.ref_key(t,n)]=o},e.prototype.off=function(t,n){var r=this.refs[e.ref_key(t,n)];r&&r.off()},e.prototype.push=function(e,t){var n=this.$q.defer();return this.database.ref(e).push(JSON.parse(JSON.stringify(t))).then(function(){return n.resolve()}).catch(function(e){return n.reject(e)}),n.promise},e.prototype.update=function(e,t){var n=this.$q.defer();return this.database.ref(e).update(t),n.promise},e.prototype.onDataWithRemove=function(e,t,n,r){if(e<moment().day(-1).toDate())return void r();e>t&&n()},e.ref_key=function(e,t){return e+"_"+t},e}();e.factory("firebaseService",["$q",function(e){return new o(e)}])}(angular.module("tnFirebase",[])),function(e){e.run(["GApi","BASE",function(e,t){e.load("tree","v1",t),e.load("user","v1",t)}]).factory("GApiShared",["GAuth","GApi","GData","firebaseService","SCOPES",function(e,t,n,r,o){var i=this;return i.loginUser=function(o){return void 0===o&&(o=!1),e.getToken().then(function(e){return r.loginGoogle(e.access_token)}).then(function(e){return t.executeAuth("user","store.user",{check_license:o,firebase_token:e})}).then(function(){return n.getUser()})},i.getYoutubeScope=function(){var e=o.slice(0);return e.push("https://www.googleapis.com/auth/youtube","https://www.googleapis.com/auth/youtube"),e},i}])}(angular.module("tnGapi",["tnGapiShared","tnFirebase"])),function(e){e.config(["$mdThemingProvider","$mdIconProvider",function(e,t){t.defaultIconSet("img/icons.svg"),e.theme("default").backgroundPalette("grey",{default:"50"}).primaryPalette("teal",{default:"200"}).accentPalette("pink")}]).run(["$rootScope",function(e){e.theming={topbar:{backgroundColor:"background-300",borderColor:"background-900-.27"}}}]).value("nodeColorExpression",{backgroundColor:"default-background-100"}).value("nodeRelatedColorExpression",{backgroundColor:"default-primary-200"}).value("nodeSearchResultColorExpression",{backgroundColor:"default-accent-300"}).factory("nodeLinkDefaultColor",["$mdColors",function(e){return e.getThemeColor("default-accent-600")}])}(angular.module("tnTheming",["ngMaterial"])),function(e){e.service("tagsApi",["GApi","API_KEY",function(e,t){var n=this;n.getTags=function(n){return e.execute("kgsearch","entities.search",{query:n,prefix:!0,key:t}).then(function(e){return e.itemListElement.map(function(e){var t=e.result,n=t.image;return{name:t.name,image:n&&n.contentUrl,description:t.description}})})},n.transformTag=function(e){return angular.isObject(e)?e.name:angular.isString(e)?e:void 0}}])}(angular.module("tnTags",[])),function(e){e.factory("disqus",["$window","$http","$timeout","DISQUS_API_KEY","DISQUS_FORUM","BASE_URL",function(e,t,n,r,o,i){function a(){return 0}var s={};return $.getScript("https://brancher.disqus.com/embed.js"),e.disqus_config=function(){this.shortname=o},s.reset=function(e,t){return n(function(){DISQUS.reset({reload:!0,config:function(){var n=this;n.page.identifier=e,n.page.url=i+"/?tree="+e,n.page.title=t}})})},s.getCommentCount=function(e){return t.get("https://disqus.com/api/3.0/threads/details.json",{params:{api_key:r,"thread:ident":e,forum:o}}).then(function(e){return e.data.response.posts},a)},s}])}(angular.module("tnDisqus",[])),function(e){e.service("rss",["$q","$http","$cacheFactory","URI","nodes","BASE_URL",function(e,t,r,o,i,a){var s=this,c=r("rss",{capacity:20}),u=n(27);s.query=function(n){var r=i.getNode(n),o=r&&r.rss;if(!o)return e.reject();var s=c.get(o);return s?e.when(s):t.get(a+"/rss",{params:{url:o}}).then(function(t){function n(){var e=angular.element(this),t={},n=e.find("link")[0],r=n&&(n.href||n.getAttribute("href")||n.textContent);if(r){var o=angular.element(e.find("description, summary")[0]).text(),i=t.tags=[];t.value=r,t.title=e.find("title").text(),t.description=o&&u(o).substring(0,500),e.find("category").each(function(e,t){var n=angular.element(t).text()||t.getAttribute("term");n&&i.push(n)}),a.push(t)}}if(200!=t.status)return e.reject();var r=angular.element($.parseXML(t.data)),a=[];r.find("entry").each(n),0==a.length&&r.find("item").each(n),i.addNodesShared(a);var s=i.mapNodesShared(a,!1);return c.put(o,s),e.when(s)})}}])}(angular.module("tnRSS",[])),function(e){e.factory("maps",["$rootScope","$window","$compile","$templateCache","$q","$timeout","API_KEY",function(e,t,n,r,o,i,a){var s,c,u=angular.element("<script>")[0],l=r.get("partials/shared/marker-info-window.html"),d=n(l),p=o.defer(),m={};return m.onLoad=p.promise.catch(angular.noop),u.src="https://maps.googleapis.com/maps/api/js?key="+a+"&callback=initMap&language=en",u.onerror=function(){return p.reject()},t.initMap=function(){p.resolve(),s=new google.maps.Geocoder,c=new google.maps.DistanceMatrixService},document.head.appendChild(u),m.geocodeNode=function(e){var t=o.defer();return s?(s.geocode({address:e.address},function(n,r){if(r===google.maps.GeocoderStatus.OK){var o=n[0],i=o.geometry.location;e.address=o.formatted_address,e.geo=i.lat()+", "+i.lng()}t.resolve()}),t.promise):o.reject()},m.createMap=function(e,t){var n=new google.maps.Map(e,{zoom:10});return n.addListener("click",t),n},m.createUserMarker=function(e,t){return new google.maps.Marker({position:{lat:t.latitude,lng:t.longitude},map:e,title:"My location",icon:"img/my-location.png"})},m.createNodeMarker=function(t,n,r){function o(e){u.setContent(e[0]),i(a,100)}function a(){u.open(t,c)}var s=n.geo.split(","),c=new google.maps.Marker({position:{lat:parseFloat(s[0]),lng:parseFloat(s[1])},map:t,title:n.title}),u=new google.maps.InfoWindow,l=e.$new(!0);return l.node=n,c.addListener("click",function(){if(u.getContent())return u.setContent(""),u.setZIndex(1),void u.close();d(l,o),r(),u.setZIndex(2)}),u.addListener("closeclick",function(){u.setContent(""),u.setZIndex(1)}),{marker:c,infoWindow:{value:u,scope:l}}},m.clearInstanceListeners=function(e){google.maps.event.clearInstanceListeners(e)},m.setUserDistances=function(e,t){c.getDistanceMatrix({origins:[e.getPosition()],destinations:t.map(function(e){return e.marker.getPosition()}),travelMode:google.maps.TravelMode.DRIVING},function(e,n){n==google.maps.DistanceMatrixStatus.OK&&e.rows[0].elements.forEach(function(e,n){if(e.status==google.maps.DistanceMatrixElementStatus.OK){t[n].infoWindow.scope.info={duration:e.duration.text,distance:e.distance.text}}})})},m}])}(angular.module("tnMaps",["tnConfig"])),function(e){e.service("geolocation",["$q","$interval",function(e,t){var n,r=this,o=!("undefined"==typeof navigator||!navigator.geolocation);r.getCurrentPosition=function(){if(!o)return e.reject();if(n)return e.when(n);var t=e.defer();return navigator.geolocation.getCurrentPosition(function(e){n=e.coords,t.resolve(n)},function(){return t.reject()}),t.promise},t(function(){return n=null},6e5)}])}(angular.module("tnGeolocation",[])),function(e){e.service("itunes",["$http","$sce","URI","uriParser",function(e,t,n,r){function o(e){var t=[];if(200==e.status){var o=e.data;o&&angular.isArray(o.results)&&o.results.forEach(function(e){var o=e.trackViewUrl;o&&t.push({url:r.makeAffiliateLink(n(o)).toString(),title:e.trackName,author:e.artistName,category:e.kind,image:e.artworkUrl100})})}return t}this.search=function(n,r){void 0===r&&(r=2);var i={jsonpCallbackParam:"callback",params:{term:n,limit:r,explicit:"No"}};return e.jsonp(t.trustAsResourceUrl("https://itunes.apple.com/search"),i).then(o)}}])}(angular.module("tnITunes",["URIjs"])),function(e){e.config(["$compileProvider","$provide",function(e,t){e.imgSrcSanitizationWhitelist(/^\s*((https?|ftp|file|blob|chrome-extension):|data:image\/)/),e.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|chrome-extension):/),e.debugInfoEnabled(!1),t.factory("toastObserver",["$mdToast","ObservableClass",function(e,t){var n=t();return n.subscribe(function(t){if(t){var n=e.simple().capsule(!0).textContent(t).toastClass("tn-toast").position("top right");e.show(n)}}),n}]),t.factory("keysObserver",["ObservableClass",function(e){var t=e();return window.addEventListener("keydown",function(e){return t.notifyObservers(e.keyCode)},!0),t}]),t.factory("clientInitPromise",["facebookSDK","facebook","users",function(e,t,n){return function(r){return void 0===r&&(r=!1),n.userInfo(r).then(function(){if(!r)return n.getTrending()}).then(function(){return e.then(function(){return t.userSetup()})})}}])}]).run(["$rootScope","$mdDialog","GData","Analytics","trees","nodes","users","Nodes","chromeTabs","URI","uriParser","TreeMeta","buffer","debounce",function(e,t,n,r,o,i,a,s,c,u,l,d,p,m){function f(t){return n.isLogin()?t():e.login()}function g(t){!n.isLogin()||e.isExtension||e.isPage||"undefined"!=typeof chrome&&angular.element("#brancher-extension")[0]||i.addNodeVisit(t)}e.$mdDialog=t,e.buffer=p,e.openUrl=function(t,n,o,a,s){void 0===a&&(a="node"),void 0===s&&(s="open");var d="https://goo.gl/"+t,p=i.getNode(t),m=u(p.url||"");return p.isArticle&&e.isMobile&&(d="https://brancher-io.cdn.ampproject.org/c/s/brancher.io/article/amp/?key="+t),l.isAffiliate(m)&&(d=l.makeAffiliateLink(m).toString()),r.trackEvent(a,s,n),g(t),c.create(d,p.url,o)},e.openLongUrl=function(e,t,n,o,i){void 0===o&&(o="node"),void 0===i&&(i="open");var a=u(e||"");return l.isAffiliate(a)&&(e=l.makeAffiliateLink(a).toString()),r.trackEvent(o,i,t),c.create(e,void 0,n)},e.newNode=function(t){var n=t.link,r=n&&n.value,o=n&&n.child;r&&r.title&&(r.visited&&(r.visited=new Date(r.visited)),s.addNode(o,r),e.$broadcast("update:"+o),s.notifyObservers(o))},e.newImage=function(t){var n=t.link;if(n){var r=n.value,o=n.child,a=i.getNode(o);a&&(angular.merge(a,r),e.$broadcast("update:"+o))}},e.addTree=function(e){var t=new d(e.id,e);t.openOnLoad=!0,t.pinned=e.pinned||o.pinnedTreesContainer.hasKey(t.id),o.TreesMetaContainer.put(t.id,t),o.addTreeObject(t,e)},e.pinning={disabled:!1,togglePin:m(function(e){var t=o.getTreeMeta(e);return t.loading=!0,f(t.pinned?function(){return o.unpin(e)}:function(){return o.pin(e)})},1e3,!0),move:function(e,t){return f(function(){return o.move(e,t)})}},e.$on("pin",function(t,n){e.$applyAsync(function(){var t=n.value.tree.id;o.TreesMetaContainer.hasKey(t)||o.TreesMetaContainer.put(t,new o.TreeMeta(t,n.value.tree)),o.pinTree(t),e.pinning.disabled=o.isPinDisabled()})}),e.$on("unpin",function(t,n){e.$applyAsync(function(){o.unpinTree(n.value.tree),e.pinning.disabled=o.isPinDisabled()})})}]).run(function(){var e=function(e){var t=e.parents(".mCSB_container");return[e.offset().top-t.offset().top,e.offset().left-t.offset().left]};$(".mCustomScrollbar").mCustomScrollbar(),$.extend($.expr[":"],{mcsInView:$.expr[":"].mcsInView||function(t){var n,r,o=$(t),i=o.parents(".mCSB_container");if(i.length)return n=i.parent(),r=[i[0].offsetTop,i[0].offsetLeft],r[0]+e(o)[0]>=0&&r[0]+e(o)[0]<n.height()-o.outerHeight(!1)&&r[1]+e(o)[1]>=0&&r[1]+e(o)[1]<n.width()-o.outerWidth(!1)},mcsInSight:$.expr[":"].mcsInSight||function(t,n,r){var o,i,a,s,c=$(t),u=c.parents(".mCSB_container"),l="exact"===r[3]?[[1,0],[1,0]]:[[.9,.1],[.6,.4]];if(u.length)return o=[c.outerHeight(!1),c.outerWidth(!1)],a=[u[0].offsetTop+e(c)[0],u[0].offsetLeft+e(c)[1]],i=[u.parent()[0].offsetHeight,u.parent()[0].offsetWidth],s=[o[0]<i[0]?l[0]:l[1],o[1]<i[1]?l[0]:l[1]],a[0]-i[0]*s[0][0]<0&&a[0]+o[0]-i[0]*s[0][1]>=0&&a[1]-i[1]*s[1][0]<0&&a[1]+o[1]-i[1]*s[1][1]>=0},mcsOverflow:$.expr[":"].mcsOverflow||function(e){var t=$(e).data("mCS");if(t)return t.overflowed[0]||t.overflowed[1]}})})}(angular.module("tnClientShared",["ngMaterial","URIjs","ngScrollbars","ngQueue","debounce","tnAnalytics","tnBricklayer","tnAnimation","tnTreeDirectives","tnSharedControllers","tnGapi","tnTheming","tnTags","tnConfig","tnDisqus","tnRSS","tnMaps","tnGeolocation","tnITunes","tnUrlShortener","tnFirebase"])),function(e){e.config(["$provide",function(e){e.factory("chromeTabs",["$window",function(e){var t={};return t.create=function(t){e.open(t)},t}]),e.factory("Tab",["$window",function(e){var t={active:!0,width:e.innerWidth,height:e.innerHeight};return e.addEventListener("resize",function(){t.width=e.innerWidth,t.height=e.innerHeight}),t}])}]).run(["$window",function(e){e.onerror=function(e){if("Script error."==e&&!gapi.client){var t=document.createElement("script");t.src="https://apis.google.com/js/client.js?onload=_gapiOnLoad",document.body.appendChild(t)}}}])}(angular.module("tnWebClient",["tnClientShared"])),function(e){e.run(["$rootScope","$window","users","BASE_URL",function(e,t,n,r){e.toggleUser=function(e){t.open(r+"/user/?userId="+(e.id||"")+"&plusId="+(e.plusId||""))},e.toggleTag=function(e){t.open(r+"/tag/"+e)},e.toggleDomain=function(e){t.open(r+"/domain/"+e)},e.mainCtrl={login:function(){return n.login(!0)}},e.tabCtrl={getLoadOptions:function(){return{pinned:!0}}},e.login=e.mainCtrl.login}])}(angular.module("tnTreeWebClient",["tnWebClient"])),function(e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);e.run(["$rootScope","$compile","GData","trees","users","layoutObservers","clientInitPromise",function(e,t,n,o,i,a,s){function c(e){l.append(e)}function u(){n.isLogin()&&i.onLinks(new Date)}var l=r.element("#embedded-tree-container"),d=a.scrollObserver;e.embedTreeScope=e.$new(),e.updateTabScroll=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];l.mCustomScrollbar.apply(l,e)},e.update=function(){var n=e.embedTreeScope;if(!o.treesContainer.isEmpty()){var r=o.treesContainer.keys()[0];n.tree=o.treesContainer.assoc(r),t("<tn-tree></tn-tree>")(n,c)}},e.getTreeCallback=function(t){e.addTree(t),e.$applyAsync(e.update)},e.$on("tree:postLink",function(){e.embedTreeScope.treeCtrl.init(),l.mCustomScrollbar({theme:"minimal-dark",axis:"y",callbacks:{whileScrolling:function(){d.notifyObservers(this.mcs.top)}}})}),e.$on("tree:init",function(){var t=function(){return e.embedTreeScope.treeCtrl.setUpCommandsListener()},a=function(){return i.userSetup().then(function(){return s(!0)}).then(r.noop,r.noop).then(t).catch(r.noop)};n.isLogin()&&(a=t),o.commandQueue.enqueue(a,null,[]),r.element("#init-load").remove()}),i.userLoginObserver.subscribe(u)}]).run(["$rootScope","linkEvent",function(e,t){function n(n){var r=n.value;if(r.linkType===t.image)return void e.newImage(r);e.newNode(r)}e.$on("link",function(t,o,i,a){void 0===a&&(a=r.noop),e.$applyAsync(function(){return n(o)}),a()})}])}(angular.module("tnEmbedClient",["tnTreeWebClient"])),function(e){e.config(["AnalyticsProvider",function(e){e.setHybridMobileSupport(!0)}])}(angular.module("tnExtensionClient",["tnAnalytics"])),function(e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);e.config(["$provide",function(e){e.factory("GApiExtension",["chromeRuntime",function(e){var t={};return t.execute=function(t){return e.sendMessage({type:"GAuth:get",interactive:!1}).then(function(e){return gapi.auth.setToken(e),t()},t)},t}]),e.value("facebookExtensionRedirectURL",function(){return""}),e.value("chromeIdentity",r.noop),e.factory("facebookSDK",["$q",function(e){return e.when()}]),e.factory("trees",["treesPageStatic",function(e){return new e}]),e.factory("nodes",["nodesControlStatic",function(e){return new e}]),e.factory("pocket",["pocketControlStatic",function(e){return new e}]),e.factory("users",["usersPageStatic",function(e){return new e}]),e.factory("facebook",["facebookPageStatic",function(e){return new e}]),e.factory("bufferService",["bufferControlStatic",function(e){return new e}]),e.factory("youtubeIFrame",["youtubeIFrameControlStatic",function(e){return new e}])}]).run(["$rootScope","trees",function(e,t){e.isPage=!0,t.registerTree(e.embedTreeScope)}])}(angular.module("tnPageClient",["tnDataPage","tnEmbedClient","tnExtensionClient"])),function(e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n(0);e.run(["$rootScope","Analytics","chromeRuntime",function(e,t,n){t.set("hostname","page.chrome"),t.trackPage("/last_tree"),e.closePageTree=function(){n.sendMessage({type:"page:close"})},n.sendMessage({type:"page:tree"}).then(function(t){return e.getTreeCallback(t)})}]),deferredBootstrapper.bootstrap({element:document.body,module:"page",injectorModules:["tnIndexedDB"],moduleResolves:[{module:"tnDataControl",resolve:{IndexedDBConfig:["IDB",function(e){return e}]}}]})}(angular.module("page",["tnPageClient"])),angular.module("page").run(["$templateCache",function(e){"use strict";e.put("partials/components/list-node-menu.html",'<md-menu-content><tn-share-menu ng-if=::nodeMenuCtrl.includeShare close=nodeMenuCtrl.close() url="{{ ::nodeMenuCtrl.nodeCtrl.nodeShortURL }}" preview=nodeMenuCtrl.nodeCtrl.getPreview() container=nodeMenuCtrl.nodeCtrl.container() container-preview=nodeMenuCtrl.nodeCtrl.containerPreview() category=node></tn-share-menu><md-menu-item><md-button title=Info ng-click="nodeMenuCtrl.close(); nodeMenuCtrl.nodeCtrl.showNodeDialog($event)" ga-track-event="[\'node\', \'info\']"><md-icon md-svg-icon=info></md-icon>Info</md-button></md-menu-item><md-menu-item><md-button title="Add to favorites" ng-class="{\'md-accent\': nodeMenuCtrl.nodeCtrl.favorite}" ng-disabled=nodeMenuCtrl.nodeCtrl.favoriteDisabled ng-click="nodeMenuCtrl.close(); nodeMenuCtrl.nodeCtrl.toggleFavorite()" ga-track-event="[\'node\', \'favorite\']"><md-icon md-svg-icon=favorite></md-icon>Favorite</md-button></md-menu-item><md-menu-item ng-show=!nodeMenuCtrl.nodeCtrl.isWebSearch><md-button ng-click="nodeMenuCtrl.close(); nodeMenuCtrl.nodeCtrl.related($event)" ga-track-event="[\'node\', \'related\']" aria-label=Related><md-icon>new_releases</md-icon>Related</md-button></md-menu-item><md-menu-item ng-show=nodeMenuCtrl.nodeCtrl.isArticle><md-button ng-click="nodeMenuCtrl.close(); nodeMenuCtrl.nodeCtrl.openArticle($event)" ga-track-event="[\'node\', \'reader\']"><md-icon md-svg-icon=reader></md-icon>Reader</md-button></md-menu-item><md-menu-item ng-if=!$root.isMobile><md-button ng-click="nodeMenuCtrl.close(); nodeMenuCtrl.nodeCtrl.showAnalyticsDialog($event)" ga-track-event="[\'node\', \'analytics\']"><md-icon md-svg-icon=analytics></md-icon>Analytics</md-button></md-menu-item><md-menu-item ng-show=nodeMenuCtrl.nodeCtrl.isWebSearch><md-button ng-click="nodeMenuCtrl.close(); nodeMenuCtrl.nodeCtrl.googleSearch($event)" ga-track-event="[\'node\', \'search\']" aria-label=Other><md-icon md-svg-icon=search></md-icon>Search</md-button></md-menu-item><md-menu-item ng-show=nodeMenuCtrl.nodeCtrl.hasPhotos><md-button ng-click="nodeMenuCtrl.close(); nodeMenuCtrl.nodeCtrl.showPhotosDialog($event)" ga-track-event="[\'node\', \'photos\']" aria-label=Images><md-icon md-svg-icon=images></md-icon>Images</md-button></md-menu-item><md-menu-item ng-show=nodeMenuCtrl.nodeCtrl.hasRSS><md-button ng-click="nodeMenuCtrl.close(); nodeMenuCtrl.nodeCtrl.rss($event)" ga-track-event="[\'node\', \'rss\']" aria-label=RSS><md-icon md-svg-icon=rss></md-icon>RSS</md-button></md-menu-item><md-menu-item ng-show=nodeMenuCtrl.nodeCtrl.hasGeolocation><md-button ng-click="nodeMenuCtrl.close(); nodeMenuCtrl.nodeCtrl.showMapDialog($event)" ga-track-event="[\'node\', \'map\']"><md-icon md-svg-icon=map></md-icon>Map</md-button></md-menu-item><md-menu-item><md-button ng-click="nodeMenuCtrl.close(); nodeMenuCtrl.nodeCtrl.copyNode(node.data.key)" ga-track-event="[\'node\', \'copy\']" aria-label=Copy><md-icon md-svg-icon=copy></md-icon>Copy</md-button></md-menu-item><md-menu-item ng-if="::vm.hasRemove && !node.data.value.related"><md-button ng-click="nodeMenuCtrl.close(); vm.removeNode(node.data.key)" ga-track-event="[\'node\', \'remove\']" aria-label=Remove><md-icon md-svg-icon=remove></md-icon>Remove</md-button></md-menu-item><md-menu-item><md-button ng-click="nodeMenuCtrl.close(); nodeMenuCtrl.nodeCtrl.showReportDialog($event)" ga-track-event="[\'node\', \'report\']" aria-label=Report ng-disabled=nodeMenuCtrl.nodeCtrl.reportDisabled><md-icon md-svg-icon=report></md-icon>Report</md-button></md-menu-item></md-menu-content>'),e.put("partials/shared/analytics-dialog.html","<md-dialog id=analytics-dialog><md-dialog-content><md-content><div id=analytics-dialog-close><img ng-click=$root.$mdDialog.cancel() src=/img/close-black.png ga-track-event=\"['analyticsDialog', 'close']\"></div><div id=analytics-dialog-header><h2 id=analytics-dialog-title class=md-display-1><a ng-href={{analyticsDialog.url}} ga-track-event=\"['analyticsDialog', 'open']\" target=_blank>{{ analyticsDialog.title }}</a></h2><div id=analytics-dialog-info><div id=analytics-total-clicks-num class=md-headline><span>Clicks:</span> {{ analyticsDialog.clicks }}</div><div id=analytics-created-date class=md-subhead><span>Created:</span> {{ analyticsDialog.created | relativeTimestamp }}</div></div></div><div id=analytics-dialog-container><div id=countries class=analytics-pie-chart><h4 class=md-headline>Countries</h4></div><div id=referrers class=analytics-pie-chart><h4 class=md-headline>Referrers</h4></div><div id=browsers class=analytics-pie-chart><h4 class=md-headline>Browsers</h4></div><div id=platforms class=analytics-pie-chart><h4 class=md-headline>Platforms</h4></div></div></md-content></md-dialog-content></md-dialog>"),e.put("partials/shared/article-dialog.html","<md-dialog id=article-dialog><div id=article-dialog-close><img ng-click=$root.$mdDialog.cancel() src=/img/close-black.png ga-track-event=\"['articleDialog', 'close']\"></div><div flex><iframe id=atricle-frame width=100% height=100%></iframe></div><div id=article-dialog-progress layout=column layout-align=\"center center\"><md-progress-circular md-mode=indeterminate></md-progress-circular></div></md-dialog>"),e.put("partials/shared/buffer-dialog.html",'<md-dialog id=buffer-dialog><md-dialog-content md-colors="{backgroundColor: \'default-background-100\'}"><div id=buffer-dialog-close-button><md-button class=md-icon-button ng-click=$root.$mdDialog.cancel() ga-track-event="[\'bufferDialog\', \'close\']"><md-icon md-svg-icon=close></md-icon></md-button></div><div id=buffer-update-container><div class=buffer-update-details><div class=buffer-message><md-input-container><label>Message Text</label><textarea ng-model=vm.current.text max-rows=5></textarea></md-input-container><md-chips ng-model=vm.current.tags ng-show=vm.current.tags.length md-on-select=vm.selectTag($chip) md-removable=false></md-chips></div><div class=buffer-photo><md-input-container><label>Photo URL</label><input ng-model=vm.current.photo></md-input-container></div><md-list><md-list-item class=buffer-profile ng-repeat="profile in vm.profiles track by profile.id"><md-checkbox ng-model=profile.selected ng-change=vm.onProfileSelect()></md-checkbox><img class=md-avatar ng-src="{{ ::profile.avatar }}"><p><span class=buffer-profile__username>{{ ::profile.formatted_username }}</span> <span class=buffer-profile__service>{{ ::profile.service }}</span></p></md-list-item></md-list><div class=buffer-timing><div><md-checkbox ng-model=vm.current.now ng-change="vm.trackEvent(\'now\')" ng-disabled=vm.current.top>Send immediately</md-checkbox></div><div><md-checkbox ng-model=vm.current.top ng-change="vm.trackEvent(\'top\')" ng-disabled=vm.current.now>Add to the top</md-checkbox></div><div><md-button id=buffer-add-button class=md-primary ng-click=vm.publish() ng-disabled="vm.publishDisabled || vm.current.isPublished || vm.loading" ga-track-event=vm.publishEvent><md-icon md-svg-icon=buffer></md-icon>Add to Buffer</md-button><md-progress-circular md-mode=indeterminate ng-show=vm.loading></md-progress-circular></div><div><div ng-show=vm.error><md-icon md-svg-icon=error></md-icon>Error</div><div>{{ vm.messeage }}</div></div></div></div></div><md-content id=content-previews-container><div id=content-previews><md-card class=content-preview ng-repeat="preview in ::vm.container track by preview.targetUrl" ng-click="vm.current = preview; vm.messeage = \'\'" ng-class="{\'content-preview--selected md-whiteframe-10dp\': preview.targetUrl == vm.current.targetUrl, \'content-preview--published\': preview.isPublished}" ga-track-event="[\'bufferDialog\', \'select\']"><img class="md-card-image content-preview-image" primary="{{ ::preview.image }}" secondary="{{ ::preview.secondaryImage }}" tn-secondary-image><md-card-title><md-card-title-text><span class=md-headline>{{ ::preview.title }}</span></md-card-title-text></md-card-title><md-card-content ng-show=preview.description><p>{{ ::preview.description }}</p></md-card-content><md-card-footer>{{ ::preview.domain }}</md-card-footer></md-card></div></md-content></md-dialog-content></md-dialog>'),e.put("partials/shared/domain.html",'<div><a class=domain__link ng-href={{::linkHref}} ng-click="$event.preventDefault(); $event.stopPropagation(); $root.toggleDomain($chip)">{{ $chip }}</a></div>'),e.put("partials/shared/facebook-pages-dialog.html","<md-dialog id=facebook-pages-dialog><md-dialog-content><md-content><div id=facebook-pages-dialog-close-button><md-button class=md-icon-button ng-click=$root.$mdDialog.cancel() ga-track-event=\"['facebookPagesDialog', 'close']\"><md-icon md-svg-icon=close></md-icon></md-button></div><div><md-card><img class=md-card-image primary=\"{{ vm.preview.image }}\" secondary=\"{{ vm.preview.secondaryImage }}\" tn-secondary-image><md-card-title><md-card-title-text><span class=md-headline>{{ vm.preview.title }}</span></md-card-title-text></md-card-title><md-card-content ng-show=vm.preview.description><p>{{ vm.preview.description }}</p></md-card-content><md-card-footer>{{ vm.domain }}</md-card-footer></md-card></div><md-list><md-subheader><span>My pages</span><md-button class=md-icon-button ng-click=vm.loginPublisher() ga-track-event=\"['facebookPagesDialog', 'refresh']\"><md-icon md-svg-icon=refresh></md-icon></md-button><md-progress-circular md-diameter=25 md-mode=indeterminate ng-show=vm.loading></md-progress-circular></md-subheader><div><a href=https://www.facebook.com/pages/create target=_blank ga-track-event=\"['facebookPagesDialog', 'createFacebookPage']\" ng-hide=vm.facebook.groups>Don't have a page yet?</a></div><md-list-item ng-repeat=\"group in vm.facebook.groups track by group.id\" ng-disabled=vm.isPagePublished(group.id) ga-track-event=vm.publishEvent ng-click=vm.publish(group)>{{group.name}}</md-list-item></md-list></md-content></md-dialog-content></md-dialog>"),e.put("partials/shared/images-dialog.html",'<md-dialog class=images-dialog id=tree-images-dialog><md-dialog-content><md-toolbar><div class=md-toolbar-tools><h2 class=md-display-1><span>{{ vm.title }}</span></h2><div flex></div><div><md-button class=md-icon-button ga-track-event="[\'treeImagesDialog\', \'close\']" ng-click=$root.$mdDialog.cancel()><md-icon md-svg-icon=close></md-icon></md-button></div></div></md-toolbar><div class=bricklayer><div class=tree-image-container ng-class="{\'md-whiteframe-10dp tree-image-container--selected\': vm.currentImage == (node.locked_image || node.image)}" bricklayer-append ng-repeat="node in ::vm.imageNodes track by node.value"><img class=tree-image ng-click="$root.openUrl(node.value, \'images\')" ng-src="{{ ::node.locked_image || node.image }}" tn-image-error><div class=tree-image-caption md-colors="::{backgroundColor: \'primary-500\'}">{{ ::node.title }}</div><div class=select-tree-image ng-if=::vm.editable><md-button class=md-icon-button title="Set as tree image" ng-click="vm.selectImage(node.locked_image || node.image)" ng-disabled="vm.currentImage == (node.locked_image || node.image)" ga-track-event="[\'treeImagesDialog\', \'image\']"><md-icon md-svg-icon=add md-colors="{color: \'accent-400\'}"></md-icon></md-button></div></div></div></md-dialog-content></md-dialog>'),e.put("partials/shared/init-load.html",'<div id=init-load><md-backdrop class="md-opaque is-animated"></md-backdrop><md-progress-circular id=init-loader md-diameter=80 md-mode=indeterminate></md-progress-circular></div>'),e.put("partials/shared/invite-friends.html","<div class=invite-friends><div class=\"invite-friends-header md-headline\"><div>Unfortunately none of your friends are on brancher.</div><div>Let them know about us!</div></div><div class=invite-friends-buttons><md-button class=md-icon-button ng-attr-data-clipboard-text=\"{{ inviteFriendsCtrl.inviteUrl }}\" ga-track-event=\"['users', 'share', 'url']\" tn-clipboard><md-icon md-svg-icon=clipboard></md-icon></md-button><md-button class=md-icon-button ng-click=inviteFriendsCtrl.users.shareFacebook(inviteFriendsCtrl.inviteUrl) ga-track-event=\"['users', 'share', 'facebook']\"><md-icon md-svg-icon=facebook></md-icon></md-button><md-button class=md-icon-button ng-click=inviteFriendsCtrl.users.shareGoogle(inviteFriendsCtrl.inviteUrl) ga-track-event=\"['users', 'share', 'google']\"><md-icon md-svg-icon=google-plus></md-icon></md-button><md-button class=md-icon-button ng-click=inviteFriendsCtrl.users.shareTwitter(inviteFriendsCtrl.inviteUrl) ga-track-event=\"['users', 'share', 'twitter']\"><md-icon md-svg-icon=twitter></md-icon></md-button></div></div>"),e.put("partials/shared/link.html","<path class=link-visible></path><path class=link-overlay></path>"),e.put("partials/shared/map-dialog.html","<md-dialog id=map-dialog><md-dialog-content><md-toolbar><div class=md-toolbar-tools><h2 class=md-display-1><span>{{ mapDialogCtrl.title }}</span></h2><div flex></div><div><md-button class=md-icon-button ga-track-event=\"['mapDialog', 'close']\" ng-click=$root.$mdDialog.cancel()><md-icon md-svg-icon=close></md-icon></md-button></div></div></md-toolbar><div id=map-progress layout=column layout-align=\"center center\" flex><md-progress-circular md-mode=indeterminate></md-progress-circular></div><div flex><div id=map-container></div></div></md-dialog-content></md-dialog>"),e.put("partials/shared/marker-info-window.html",'<div class=marker-info-window ng-click="$root.openUrl(node.value, \'map\')" layout=row><div class=marker-info-window__image-container ng-if="::node.locked_image || node.image" flex=33><img class=marker-info-window__image ng-src="{{ ::node.locked_image || node.image }}" ng-attr-alt="{{ ::node.title }}"></div><div><div class="md-title marker-info-window__title">{{ ::node.title }}</div><div class=md-caption ng-if=info><span class=marker-info-window__distance>{{ ::info.distance }}</span> <span class=marker-info-window__duration>({{ ::info.duration }})</span></div><div class="md-body-1 marker-info-window__description" ng-if=::node.description>{{ ::node.description }}</div><div class="md-caption marker-info-window__address" ng-if=::node.address>{{ ::node.address }}</div><div class="md-caption marker-info-window__visited" ng-if=::node.visited ng-attr-title="{{ :: node.visited | absoluteTimestamp}}">Visited {{ ::node.visited | relativeTimestamp }}</div></div></div>'),e.put("partials/shared/minimap.html",'<div class="tree-minimap-container md-whiteframe-1dp" ng-hide="treeCtrl.treeNodesCtrl.isListed || treeCtrl.nodes.length < 4 || !treeCtrl.showMinimap"><div class=tree-minimap><svg class=tree-minimap-svg width=100% height=100%><rect height=100% width=100% md-colors="::{ fill: \'background-50-0.8\' }"></rect><g><g class="link is-animated" ng-repeat="link in treeCtrl.links track by link.target.data.key" tn-link=true></g><g ng-repeat="node in treeCtrl.nodes track by node.data.key" tn-tree-item><g class="node is-animated"><rect stroke=black rx=15% ry=5% width=180 height=200 ng-style="::{ fill: node.color || \'white\' }"><title>{{ ::node.domain }}</title></rect></g></g></g><g class=frame stroke=#111111><rect height=100% width=100% stroke-width=16 rx=15 ry=15 md-colors="::{ fill: \'background-900-0.18\', stroke: \'primary-900-0.44\' }"></rect></g></svg></div></div>'),e.put("partials/shared/node-dialog.html",'<md-dialog id=node-dialog><md-dialog-content><md-content><div class=node-dialog__content><div><h2 class="md-display-1 node-dialog__title"><a ng-href="{{\'https://goo.gl/\' + vm.node.value}}" ga-track-event="[\'nodeDialog\', \'open\']" target=_blank>{{ vm.node.title }}</a></h2><div id=dialog-close-button><md-button class=md-icon-button ga-track-event="[\'nodeDialog\', \'close\']" ng-click=$root.$mdDialog.cancel()><md-icon md-svg-icon=close></md-icon></md-button></div></div><div layout=column><div class=node-dialog__image-container ng-if=::vm.node.image><img class=node-dialog__image ng-src="{{ ::vm.node.image }}" tn-image-error></div><div class=node-dialog__content-section><a class=node-dialog__domain-container ga-track-event="[\'nodeDialog\', \'domain\']" ng-click="$event.preventDefault(); $event.stopPropagation(); $root.toggleDomain(vm.domain)" ng-href={{::vm.domainUrl}}><img ng-src={{::vm.node.favicon}} ng-if=::vm.node.favicon width=24 height=24> <span class="md-caption node-dialog__domain">{{::vm.domain | www}}</span></a><div class=node-dialog__like><tn-like url="{{ ::vm.node.url }}"></tn-like></div></div><div class="node-dialog__content-section node-dialog__tags-container" ng-show=!!vm.node.tags.length><md-chips ng-model=vm.node.tags md-transform-chip=vm.transformTag($chip) readonly=true><md-chip-template tn-tag></md-chip-template></md-chips></div><div class="node-dialog__content-section node-dialog__description-container"><p class=md-body-1>{{ ::vm.node.description }}</p></div></div></div><div><md-subheader>Linked</md-subheader></div><div layout=column flex><div ng-hide=!!vm.container.length flex><div class=dialog-status-component ng-show=vm.loading layout=column layout-align="center center"><md-progress-circular md-mode=indeterminate></md-progress-circular></div><div class="md-body-1 dialog-status-component" ng-show="!(vm.container.length || vm.loading)" layout=column layout-align="center center">No Results</div></div><div ng-show=!!vm.container.length flex><md-list><tn-node-listed ng-repeat="node in vm.container track by node.data.key" node=node open-url=vm.openUrl(key)></tn-node-listed></md-list></div></div></md-content></md-dialog-content></md-dialog>'),e.put("partials/shared/node-listed.html",'<md-list-item class="secondary-button-padding node-listed" ng-class="::{\'node-listed--visited\': nodeCtrl.showVisited, \'node--is-open\': nodeCtrl.isOpened}" md-colors=nodeCtrl.colors ng-href="{{ ::nodeCtrl.nodeURL }}" ng-click="$event.preventDefault(); $event.stopPropagation(); nodeCtrl.openUrl({ \'key\': nodeCtrl.node.data.key})" layout=row layout-align="space-between center" md-no-ink tn-node-tooltip><div class=node__image-container><img tn-image class="md-avatar node__image"></div><div class="md-list-item-text node__container"><div class=node__title-container><span class=node__title-text tn-text=title tn-node-type></span> <span class="md-caption node__description" tn-text-container=description><span>&nbsp; - &nbsp;</span></span></div><div class=node__youtube-button_container ng-if=::nodeCtrl.isYoutubeVideo><img src=img/YouTube-icon-dark.png class="node__youtube-button node__youtube-button--no-hover"> <img src=img/YouTube-icon-full_color.png class="node__youtube-button node__youtube-button--hover" ng-click="$event.preventDefault(); $event.stopPropagation(); nodeCtrl.openYoutubeVideo($event)" ga-track-event="[\'node\', \'youtube\', \'nodeListed\']"></div></div><div class="md-secondary node__count-icon-container"><span class=node__count-icon tn-text-container=views title="Unique views"><i class=material-icons>remove_red_eye</i></span></div><div class="md-secondary node__info-inner"><a class=node__site-container ga-track-event="[\'node\', \'domain\', \'nodeListed\']" ng-href={{::nodeCtrl.domainUrl}} ng-click="$event.preventDefault(); $event.stopPropagation(); $root.toggleDomain(nodeCtrl.node.domain)"><span class=node__favicon-container><img class=node__favicon tn-image-error ng-if=::nodeCtrl.node.favicon ng-src={{::nodeCtrl.node.favicon}}></span><div class=node__site-name-container><p class="node__site-name md-caption">{{ ::nodeCtrl.node.domain | www }}</p></div></a></div><div class="md-secondary node__timestamp-visited"><span><span tn-text=visited></span></span></div><ng-transclude class="md-secondary node__menu"></ng-transclude><md-divider ng-if=!$last></md-divider></md-list-item>'),e.put("partials/shared/node-main-action.html","<div class=node__main-action-container><div class=node__main-action><md-button class=\"md-icon-button node__main-button node__main-button-reader\" title=Reader ng-click=\"$event.preventDefault(); $event.stopPropagation(); nodeMenuCtrl.nodeCtrl.openArticle($event)\" ng-show=nodeMenuCtrl.nodeCtrl.isArticle ga-track-event=\"['node', 'reader', 'nodeCover']\"><md-icon class=node__main-button-icon md-svg-icon=reader></md-icon></md-button><md-button class=\"md-icon-button node__main-button node__main-button-search\" title=Search ng-click=\"$event.preventDefault(); $event.stopPropagation(); nodeMenuCtrl.nodeCtrl.googleSearch($event, node.data.key)\" ng-show=nodeMenuCtrl.nodeCtrl.isWebSearch ga-track-event=\"['node', 'search', 'nodeCover']\" aria-label=Search><md-icon class=node__main-button-icon md-svg-icon=search></md-icon></md-button><md-button class=\"md-icon-button node__main-button node__main-button-images\" title=Images ng-click=\"$event.preventDefault(); $event.stopPropagation(); nodeMenuCtrl.nodeCtrl.showPhotosDialog($event)\" ng-show=nodeMenuCtrl.nodeCtrl.hasPhotos ga-track-event=\"['node', 'photos', 'nodeCover']\" aria-label=Images><md-icon class=node__main-button-icon md-svg-icon=images></md-icon></md-button></div></div>"),e.put("partials/shared/node-path.html","<md-list-item class=\"md-2-line node-path\" ng-click=\"nodeCtrl.openUrl({ 'node': nodeCtrl.node })\" ga-track-event=\"['tree', 'path']\"><img class=md-avatar tn-image><div class=md-list-item-text><div class=node-path__title tn-text=title></div></div><md-icon class=md-secondary md-svg-icon=arrow-right ng-if=!nodeCtrl.last></md-icon></md-list-item>"),e.put("partials/shared/node-share-menu.html",'<md-menu-content><tn-share-menu close=nodeMenuCtrl.close() url="{{ ::nodeMenuCtrl.nodeCtrl.nodeShortURL }}" preview=nodeMenuCtrl.nodeCtrl.getPreview() container=nodeMenuCtrl.nodeCtrl.container() container-preview=nodeMenuCtrl.nodeCtrl.containerPreview() category=node></tn-share-menu></md-menu-content>'),e.put("partials/shared/node-url-dialog.html",'<md-dialog class=node-url-dialog aria-label="New tree"><form name=form><md-dialog-content class=md-dialog-content layout=row><md-input-container flex><label>Url</label><input name=url ng-model=vm.url ng-change=vm.getUrl(vm.url) ng-model-options="::{ debounce: 500 }" md-autofocus minlength=4 required></md-input-container><md-progress-circular ng-show=vm.loading md-mode=indeterminate></md-progress-circular></md-dialog-content></form></md-dialog>'),e.put("partials/shared/node.html",'<div class="node md-whiteframe-1dp" ng-class="{\'node--is-open\': nodeCtrl.isOpened, \'node--no-image\': nodeCtrl.hasNoImage, \'md-whiteframe-10dp\': nodeCtrl.node.isNotEmpty}" tn-node-tooltip><a class=node__url ng-href="{{ ::nodeCtrl.nodeURL }}" ng-click="$event.preventDefault(); $event.stopPropagation(); nodeCtrl.openUrl({ \'key\': nodeCtrl.node.data.key})"></a><div class=node__container><div class=node__menu-container><div class=node__tools ng-transclude=menu></div></div><div class=node__share-menu-container><div class=node__tools ng-transclude=share></div></div><div class=node__tools ng-transclude=tools></div><div class=node__image-container><img class=node__image tn-image><div class=node__image-filter></div><div class=node__youtube-button_container ng-show=::nodeCtrl.isYoutubeVideo><img src=img/YouTube-icon-dark.png class="node__youtube-button node__youtube-button--no-hover"> <img src=img/YouTube-icon-full_color.png class="node__youtube-button node__youtube-button--hover node__tools" ng-click="$event.preventDefault(); $event.stopPropagation(); nodeCtrl.openYoutubeVideo($event)" ga-track-event="[\'node\', \'youtube\', \'nodeCard\']"></div><div class=node__count title="Unique views"><span tn-text=views></span></div><div class=node__tools ng-transclude=main></div></div><div class=node__text-container md-colors=nodeCtrl.colors><div class=node__title-container><div class=node__title-container-inner><div class=node__title-text tn-text=title tn-node-type></div></div></div><div class=node__description-container><div class=node__description><span><span tn-text=description></span></span> <span><span tn-text=address></span></span></div></div><a class=node__site-container ng-href="{{::nodeCtrl.domainUrl }}" ng-click="$event.preventDefault(); $event.stopPropagation(); $root.toggleDomain(nodeCtrl.node.domain)" ga-track-event="[\'node\', \'domain\', \'nodeCard\']" layout=row layout-align="space-between center"><div class=node__site-name-container><div class=node__favicon-container><img class=node__favicon ng-src="{{ ::nodeCtrl.node.favicon }}" ng-if=::nodeCtrl.node.favicon tn-image-error></div><div class="node__site-name md-caption">{{ ::nodeCtrl.node.domain | www }}</div></div></a></div></div></div>'),e.put("partials/shared/privacy-warning-dialog.html","<md-dialog id=privacy-warning-dialog><md-dialog-content><div id=dialog-close-button><md-button class=md-icon-button ga-track-event=\"['privacyDialog', 'close']\" ng-click=$root.$mdDialog.cancel()><md-icon md-svg-icon=close></md-icon></md-button></div><div id=privacy-warning><span id=privacy-warning-title>Privacy:</span> <span>This tree will be available to anyone with a link. If you want to share this tree securely only with select group of people please choose</span><div id=privacy-warning-dialog-editors-button><md-button ng-click=treeCtrl.showEditorsDialog($event) ga-track-event=\"['privacyDialog', 'editors']\"><md-icon md-svg-icon=shared></md-icon><span>Editors</span></md-button></div></div><div id=publish-option><md-button class=md-icon-button title=Publish aria-label=Publish ng-class=\"{ 'md-accent': tree.value.meta.published }\" ng-click=\"$event.stopPropagation(); treeCtrl.togglePublished()\" ga-track-event=\"['privacyDialog', 'publish']\"><md-icon md-svg-icon=public></md-icon></md-button><span id=publish-option-text>Share this tree with brancher community by making it public</span></div><div id=do-not-show-checkbox><md-checkbox ng-model=userSettings.shareUrlWarningDisabled ng-change=privacyDialog.shareUrlWarningChange()>Do not show anymore</md-checkbox></div></md-dialog-content></md-dialog>"),e.put("partials/shared/related-dialog.html",'<md-dialog id=related-dialog><md-dialog-content><md-content><div layout=column flex><div class=related-dialog__title-container><h2 class="md-display-1 related-dialog__title"><span class=related-dialog__title-type>{{ relatedDialogCtrl.title }}:</span> <a ng-href="{{\'https://goo.gl/\' + relatedDialogCtrl.node.value}}" ga-track-event="[\'relatedDialog\', \'open\']" target=_blank>{{ relatedDialogCtrl.node.title }}</a></h2><div id=dialog-close-button><md-button class=md-icon-button ga-track-event="[\'relatedDialog\', \'close\']" ng-click=$root.$mdDialog.cancel()><md-icon md-svg-icon=close></md-icon></md-button></div></div><md-divider></md-divider><div ng-hide=!!relatedDialogCtrl.container.length flex><div class=dialog-status-component ng-show=relatedDialogCtrl.loading layout=column layout-align="center center"><md-progress-circular md-mode=indeterminate></md-progress-circular></div><div class="md-body-1 dialog-status-component" ng-show="!(relatedDialogCtrl.container.length || relatedDialogCtrl.loading)" layout=column layout-align="center center">No Results</div></div><div ng-show=!!relatedDialogCtrl.container.length flex><md-list><tn-node-listed ng-repeat="node in relatedDialogCtrl.container track by node.data.key" node=node open-url=relatedDialogCtrl.openUrl(key)></tn-node-listed></md-list></div></div></md-content></md-dialog-content></md-dialog>'),e.put("partials/shared/report-dialog.html","<md-dialog id=report-dialog><form name=form><md-dialog-content class=md-dialog-content><div><md-radio-group ng-model=vm.reason><md-radio-button value=spam>Spam</md-radio-button><md-radio-button value=adult>Adult</md-radio-button><md-radio-button value=abusive>Abusive</md-radio-button><md-radio-button value=malware>Malware</md-radio-button></md-radio-group></div></md-dialog-content><md-dialog-actions><md-button ng-click=vm.cancel() ga-track-event=\"['report', 'cancelReport']\">Cancel</md-button><md-button class=md-warn ga-track-event=\"['report', 'sendReport']\" ng-click=vm.report() ng-disabled=\"form.$invalid || form.$pristine\">Report</md-button></md-dialog-actions></form></md-dialog>"),e.put("partials/shared/report-google-dialog.html","<md-dialog id=report-google-dialog><md-content><md-dialog-content class=md-dialog-content><div id=dialog-close-button><md-button class=md-icon-button ga-track-event=\"['reportGoogleDialog', 'close']\" ng-click=$root.$mdDialog.cancel()><md-icon md-svg-icon=close></md-icon></md-button></div><div class=md-headline>Google seems to think this URL is fine</div><div><a class=\"md-button md-accent\" href=https://goo.gl/#reportspam target=_blank tn-clipboard ng-attr-data-clipboard-text=\"{{ reportGoogleDialog.reportUrl }}\" ga-track-event=\"['reportGoogleDialog', 'report']\"><md-icon md-svg-icon=report></md-icon><span>Report to google</span></a></div><div class=md-caption>*Short URL will be copied to clipboard when you click report. Just paste it (ctrl + v) in the input field.</div><div id=do-not-show-checkbox><md-checkbox ng-model=$root.userSettings.reportGoogleDisabled ng-change=reportGoogleDialog.showDialogChange()>Do not show anymore</md-checkbox></div></md-dialog-content></md-content></md-dialog>"),e.put("partials/shared/share-menu.html",'<md-menu-item><md-button ng-attr-data-clipboard-text="{{ shareMenuCtrl.url }}" ng-click="shareMenuCtrl.close(); shareMenuCtrl.shareUrl()" ga-track-event=shareMenuCtrl.shareUrlEvent aria-label="Copy url" tn-clipboard><md-icon md-svg-icon=clipboard></md-icon>Copy URL</md-button></md-menu-item><md-menu-item><md-button ng-click=shareMenuCtrl.provider.shareFacebook(shareMenuCtrl.url) ga-track-event=shareMenuCtrl.event.shareFacebook aria-label="Share on facebook"><md-icon md-svg-icon=facebook></md-icon>Facebook</md-button></md-menu-item><md-menu-item><md-button ng-click=shareMenuCtrl.provider.shareTwitter(shareMenuCtrl.url) ga-track-event=shareMenuCtrl.event.shareTwitter aria-label="Share twitter"><md-icon md-svg-icon=twitter></md-icon>Twitter</md-button></md-menu-item><md-menu-item><md-button ng-click=shareMenuCtrl.provider.shareGoogle(shareMenuCtrl.url) ga-track-event=shareMenuCtrl.event.shareGoogle aria-label="Share G+"><md-icon md-svg-icon=google-plus></md-icon>Google</md-button></md-menu-item><md-menu-item><md-button ng-click=shareMenuCtrl.provider.sharePocket(shareMenuCtrl.url) ga-track-event=shareMenuCtrl.event.sharePocket aria-label="Add to Pocket"><md-icon md-svg-icon=pocket></md-icon>Pocket</md-button></md-menu-item><md-menu-item><md-button ng-click=shareMenuCtrl.shareFacebookPages($event) ga-track-event=shareMenuCtrl.shareFacebookPagesEvent aria-label="Share on facebook page"><md-icon md-svg-icon=facebook></md-icon>Pages</md-button></md-menu-item><md-menu-item ng-show=!$root.isMobile><md-button ng-click=shareMenuCtrl.shareBuffer($event) ga-track-event=shareMenuCtrl.shareBufferEvent aria-label="Share with Buffer"><md-icon md-svg-icon=buffer></md-icon>Buffer</md-button></md-menu-item>'),e.put("partials/shared/tag.html",'<div><a class=tag__link ng-href={{::linkHref}} ng-click="$event.preventDefault(); $event.stopPropagation(); $root.toggleTag($chip)">{{ $chip }}</a></div>'),e.put("partials/shared/tree-dialog.html",'<md-dialog id=tree-dialog class=tree-form-dialog aria-label="Edit tree" md-colors="{backgroundColor: \'background-200\'}"><form name=form><md-dialog-content><md-tabs class=tree-dialog__tab-container md-stretch-tabs=always md-no-pagination=true md-no-ink md-no-ink-bar><md-tab class=tree-dialog__tab><md-tab-label>Edit</md-tab-label><md-tab-body class=tree-dialog__tab-body><md-content class=tree-dialog__inner-container ng-show="::vm.treeMeta.editable && !vm.treeMeta.limitedEdit" layout=column><div layout=row flex=66><div class=tree-dialog__input-containers><div><md-input-container class=tree-dialog__input-container><label>Title</label><input name=title ng-model=vm.treeMeta.title md-autofocus md-maxlength=100 required></md-input-container></div><div class=tree-dialog__input-container><div class=md-subhead>Tags</div><md-chips class=tree-dialog-tags ng-model=vm.treeMeta.tags md-autocomplete-snap md-max-chips=10 md-transform-chip=vm.transformTag($chip) md-on-remove=vm.removeTag($chip) md-on-add=vm.addTag($chip)><md-autocomplete md-items="tag in vm.searchTags()" ng-disabled="vm.treeMeta.tags.length >= 10" md-min-length=3 md-delay=1000 md-search-text=vm.searchText md-selected-item=vm.selectedTag md-item-text=tag.name><md-item-template><div class=search-item><img class=search-item-image ng-if=tag.image ng-src="{{ tag.image }}"> <span md-highlight-text=vm.searchText>{{ tag.name }}</span> <span ng-if=tag.description>- {{ tag.description }}</span></div></md-item-template><md-not-found>No matches found.</md-not-found></md-autocomplete><md-chip-template tn-tag></md-chip-template></md-chips></div><div class=tree-dialog__input-container><div class=md-subhead>Domains</div><md-chips class=tree-dialog-tags ng-model=vm.treeMeta.domains readonly=true md-transform-chip=vm.transformTag($chip)><md-chip-template tn-domain></md-chip-template></md-chips></div></div><div flex layout=column><div class=tree-dialog-image-container><img class=tree-dialog-image ng-src="{{ ::vm.treeMeta.image || $root.placeholderImage }}" tn-image-error><div class=tree-dialog-image-edit><md-button class=md-icon-button ga-track-event="[\'treeInfo\', \'image\']" ng-if=treeCtrl ng-click=treeCtrl.showImagesDialog($event)><md-icon md-svg-icon=edit></md-icon></md-button></div></div></div></div><div flex=33><md-input-container class=tree-dialog__input-container><label>Description</label><textarea ng-model=vm.treeMeta.description md-maxlength=500></textarea></md-input-container></div></md-content><md-content class=tree-dialog__inner-container ng-if="::!vm.treeMeta.editable || vm.treeMeta.limitedEdit" layout=column><div layout=row flex=66><div class=tree-dialog__input-containers><div class=tree-dialog__input-container><h3 class=md-headline>{{ vm.treeMeta.title }}</h3></div><div class=tree-dialog__input-container ng-show=!!vm.treeMeta.tags.length><div class=md-subhead>Tags</div><md-chips class=tree-dialog-tags ng-model=vm.treeMeta.tags md-transform-chip=vm.transformTag($chip) readonly=true><md-chip-template tn-tag></md-chip-template></md-chips></div><div class=tree-dialog__input-container><div class=md-subhead>Domains</div><md-chips class=tree-dialog-tags ng-model=vm.treeMeta.domains readonly=true md-transform-chip=vm.transformTag($chip)><md-chip-template tn-domain></md-chip-template></md-chips></div></div><div flex layout=column><div class=tree-dialog-image-container><img class=tree-dialog-image ng-src="{{ vm.treeMeta.image || $root.placeholderImage }}" tn-image-error></div></div></div><div flex=33><p class=md-body-1>{{ vm.treeMeta.description }}</p></div></md-content></md-tab-body></md-tab><md-tab class=tree-dialog__tab ng-disabled="::vm.treeMeta.editable && !vm.treeMeta.published" md-on-select=vm.openComments()><md-tab-label>Comments ({{ ::vm.commentCount }})</md-tab-label><md-tab-body><div id=disqus_thread></div></md-tab-body></md-tab></md-tabs></md-dialog-content><md-dialog-actions class=tree-dialog__actions><md-button ng-click=vm.cancel() ga-track-event="[\'treeInfo\', \'cancel\']">Cancel</md-button><md-button class=md-primary ng-click=vm.save(form) ng-if=::vm.treeMeta.editable ga-track-event="[\'treeInfo\', \'save\']" ng-disabled="form.$invalid || form.$pristine">Save</md-button></md-dialog-actions></form></md-dialog>'),e.put("partials/shared/tree-editors-dialog.html",'<md-dialog id=tree-editors-dialog class=users-dialog><md-dialog-content><md-list><div class=subscription-user ng-repeat="editorUser in vm.container track by editorUser.key"><md-list-item aria-label=User><img class=md-avatar ng-src="{{ ::editorUser.value.picture.data.url }}" alt="{{ ::editorUser.value.name }}"><p>{{ ::editorUser.value.name }}</p><md-checkbox class=md-secondary ng-model-options="::{ debounce: 750 }" ng-disabled=vm.isMaxEditors ng-change=vm.canEdit(editorUser.value) ng-model=editorUser.value.isEditor></md-checkbox></md-list-item></div></md-list><tn-invite-friends ng-show=vm.showInvite></tn-invite-friends><div class="scroll-button scroll-button--subscribers" ng-hide="vm.hasScrollBar || vm.disableScroll()" layout=row layout-align="space-around center"><md-button ng-click=vm.scroll()><md-icon md-svg-icon=arrow-down></md-icon></md-button></div><div ng-show=vm.usersContainer.loading layout=row layout-align="center center"><md-progress-circular md-mode=indeterminate></md-progress-circular></div></md-dialog-content></md-dialog>'),e.put("partials/shared/tree-menu.html",'<md-menu-content><div ng-if=::isExtension class=tree-menu_mass><md-menu-item><md-button ng-click="treeMenuCtrl.close(); treeCtrl.openTabs()" ga-track-event="[\'tree\', \'openTabs\']">Open</md-button></md-menu-item><md-menu-item><md-button ng-click="treeMenuCtrl.close(); treeCtrl.moveTabs()" ga-track-event="[\'tree\', \'moveTabs\']">Move</md-button></md-menu-item><md-menu-item><md-button ng-click="treeMenuCtrl.close(); treeCtrl.closeTabs()" ga-track-event="[\'tree\', \'closeTabs\']">Close</md-button></md-menu-item></div><md-menu-item ng-if="::treeCtrl.editable && !isMobile"><md-button ng-click="treeMenuCtrl.close(); treeCtrl.showAnalyticsDialog($event)" ng-disabled=!tree.value.meta.published ga-track-event="[\'tree\', \'analytics\']" ng-attr-title="{{(!tree.value.meta.published) ? \'Publish this tree to see Analytics\' : \'\' }}"><md-icon md-svg-icon=analytics></md-icon>Analytics</md-button></md-menu-item><md-menu-item ng-if="::treeCtrl.editable && !treeCtrl.limitedEdit"><md-button ng-click="treeMenuCtrl.close(); treeCtrl.showEditorsDialog($event)" ga-track-event="[\'tree\', \'editors\']"><md-icon md-svg-icon=shared></md-icon>Editors</md-button></md-menu-item><md-menu-item><md-button ng-click="treeMenuCtrl.close(); treeCtrl.showImagesDialog($event)" ng-disabled=!treeCtrl.hasImages ga-track-event="[\'tree\', \'images\']"><md-icon md-svg-icon=images></md-icon>Images</md-button></md-menu-item><md-menu-item><md-button ng-click="treeMenuCtrl.close(); treeCtrl.showMapDialog($event)" ng-disabled=!treeCtrl.hasMap ga-track-event="[\'tree\', \'map\']"><md-icon md-svg-icon=map></md-icon>Map</md-button></md-menu-item><md-menu-item ng-if="treeCtrl.editable && tree.value.meta.original"><md-button ng-click="treeMenuCtrl.close(); treeCtrl.sync()" ng-disabled=!tree.value.meta.sync ga-track-event="[\'tree\', \'sync\']" aria-label=Sync><md-icon md-svg-icon=sync></md-icon>Sync <span ng-show=tree.value.meta.sync>({{ tree.value.meta.sync }})</span></md-button></md-menu-item><md-menu-item><md-button ng-click="treeMenuCtrl.close(); treeCtrl.buffer()" ga-track-event="[\'tree\', \'copy\']" aria-label=Copy><md-icon md-svg-icon=copy></md-icon>Copy</md-button></md-menu-item><md-menu-item ng-if=!treeCtrl.editable><md-button ng-click="treeMenuCtrl.close(); treeCtrl.showReportDialog($event)" aria-label=Report ng-disabled=treeCtrl.reportDisabled ga-track-event="[\'tree\', \'report\']"><md-icon md-svg-icon=report></md-icon>Report</md-button></md-menu-item></md-menu-content>'),e.put("partials/shared/tree-node-menu.html",'<md-menu-content><tn-share-menu ng-if=::nodeMenuCtrl.includeShare close=nodeMenuCtrl.close() url="{{ ::nodeMenuCtrl.nodeCtrl.nodeShortURL }}" preview=nodeMenuCtrl.nodeCtrl.getPreview() container=nodeMenuCtrl.nodeCtrl.container() container-preview=nodeMenuCtrl.nodeCtrl.containerPreview() category=node></tn-share-menu><md-menu-item><md-button title=Info ng-click="nodeMenuCtrl.close(); nodeMenuCtrl.nodeCtrl.showNodeDialog($event)" ga-track-event="[\'node\', \'info\']"><md-icon md-svg-icon=info></md-icon>Info</md-button></md-menu-item><md-menu-item><md-button title="Add to favorites" ng-class="{\'md-accent\': nodeMenuCtrl.nodeCtrl.favorite}" ng-disabled=nodeMenuCtrl.nodeCtrl.favoriteDisabled ng-click="nodeMenuCtrl.close(); nodeMenuCtrl.nodeCtrl.toggleFavorite()" ga-track-event="[\'node\', \'favorite\']"><md-icon md-svg-icon=favorite></md-icon>Favorite</md-button></md-menu-item><md-menu-item ng-show="!(node.data.value.related || nodeMenuCtrl.nodeCtrl.isWebSearch)"><md-button ng-click="nodeMenuCtrl.close(); treeCtrl.related($event, node.data.key)" ga-track-event="[\'node\', \'related\']" aria-label=Related><md-icon>new_releases</md-icon>Related</md-button></md-menu-item><md-menu-item ng-show=nodeMenuCtrl.nodeCtrl.isArticle><md-button ng-click="nodeMenuCtrl.close(); nodeMenuCtrl.nodeCtrl.openArticle($event)" ga-track-event="[\'node\', \'reader\', \'nodeMenu\']"><md-icon md-svg-icon=reader></md-icon>Reader</md-button></md-menu-item><md-menu-item ng-show=nodeMenuCtrl.nodeCtrl.isWebSearch><md-button ng-click="nodeMenuCtrl.close(); treeCtrl.googleSearch($event, node.data.key)" ga-track-event="[\'node\', \'search\', \'nodeMenu\']" aria-label=Other><md-icon md-svg-icon=search></md-icon>Search</md-button></md-menu-item><md-menu-item ng-if=!$root.isMobile><md-button ng-click="nodeMenuCtrl.close(); nodeMenuCtrl.nodeCtrl.showAnalyticsDialog($event)" ga-track-event="[\'node\', \'analytics\']"><md-icon md-svg-icon=analytics></md-icon>Analytics</md-button></md-menu-item><md-menu-item ng-show=nodeMenuCtrl.nodeCtrl.hasPhotos><md-button ng-click="nodeMenuCtrl.close(); nodeMenuCtrl.nodeCtrl.showPhotosDialog($event)" ga-track-event="[\'node\', \'photos\', \'nodeMenu\']" aria-label=Images><md-icon md-svg-icon=images></md-icon>Images</md-button></md-menu-item><md-menu-item ng-show=nodeMenuCtrl.nodeCtrl.hasRSS><md-button ng-click="nodeMenuCtrl.close(); treeCtrl.rss($event, node.data.key)" ga-track-event="[\'node\', \'rss\']" aria-label=RSS><md-icon md-svg-icon=rss></md-icon>RSS</md-button></md-menu-item><md-menu-item ng-show=nodeMenuCtrl.nodeCtrl.hasGeolocation><md-button ng-click="nodeMenuCtrl.close(); nodeMenuCtrl.nodeCtrl.showMapDialog($event)" ga-track-event="[\'node\', \'map\']"><md-icon md-svg-icon=map></md-icon>Map</md-button></md-menu-item><md-menu-item ng-show="!(node.data.value.related || nodeMenuCtrl.isListed)"><md-button ng-click="nodeMenuCtrl.close(); nodeMenuCtrl.nodeCtrl.focus()" ng-disabled="nodeMenuCtrl.isFocused()\n                       || treeCtrl.treeNodesCtrl.isExpanded\n                       || nodeMenuCtrl.isRoot()\n                       || node.isLeaf" ga-track-event="[\'node\', \'focus\']" aria-label=Focus><md-icon md-svg-icon=focus></md-icon>Focus</md-button></md-menu-item><md-menu-item ng-show="!nodeMenuCtrl.isListed && !isEmbedded && (user || isExtension)"><md-button ng-click="nodeMenuCtrl.close(); treeCtrl.newTree(node.data.key)" ng-disabled="node.isLeaf || nodeMenuCtrl.isRoot()" ga-track-event="[\'node\', \'newTree\']" aria-label="New tree"><md-icon md-svg-icon=add></md-icon>New Tree</md-button></md-menu-item><md-menu-item ng-show="!nodeMenuCtrl.isListed && nodeMenuCtrl.editable"><md-button ng-click="nodeMenuCtrl.close(); treeCtrl.addUrlDialog($event, node.data.key)" ga-track-event="[\'node\', \'addNode\']" aria-label="Add url"><md-icon md-svg-icon=add-node></md-icon>Add URL</md-button></md-menu-item><md-menu-item ng-if=::!isEmbedded><md-button ng-click="nodeMenuCtrl.close(); nodeMenuCtrl.nodeCtrl.copyNode(node.data.key)" ga-track-event="[\'node\', \'copy\']" aria-label=Copy><md-icon md-svg-icon=copy></md-icon>Copy</md-button></md-menu-item><md-menu-item ng-if=::!isEmbedded ng-show="!(nodeMenuCtrl.isListed || node.isLeaf)"><md-button ng-click="nodeMenuCtrl.close(); treeCtrl.execute(\'buffer\', node.data.key)" ga-track-event="[\'node\', \'copyAll\']" aria-label=Copy><md-icon md-svg-icon=copy-all></md-icon>Copy All</md-button></md-menu-item><md-menu-item ng-show=!node.data.value.related><md-button ng-click="nodeMenuCtrl.close(); treeCtrl.execute(\'paste\', node.data.key)" ng-disabled="!nodeMenuCtrl.editable || buffer.isEmpty()" ga-track-event="[\'node\', \'paste\']" aria-label=Paste><md-icon md-svg-icon=paste></md-icon>Paste</md-button></md-menu-item><md-menu-item ng-if=node.isDeleteOne><md-button ng-click="nodeMenuCtrl.close(); treeCtrl.execute(\'deleteOne\', node.data.key)" ga-track-event="[\'node\', \'remove\', \'menuButton\']" aria-label=Remove><md-icon md-svg-icon=remove></md-icon>Remove</md-button></md-menu-item><md-menu-item ng-if=node.isDeleteBranch><md-button ng-click="nodeMenuCtrl.close(); treeCtrl.execute(\'deleteBranch\', node.data.key)" ga-track-event="[\'node\', \'remove\', \'menuButton\']" aria-label=Remove><md-icon md-svg-icon=remove></md-icon>Remove</md-button></md-menu-item><md-menu-item ng-if=node.isDeleteRoot><md-button ng-click="nodeMenuCtrl.close(); treeCtrl.execute(\'deleteRoot\', node.data.key)" ga-track-event="[\'node\', \'remove\', \'menuButton\']" aria-label=Remove><md-icon md-svg-icon=remove></md-icon>Remove</md-button></md-menu-item><md-menu-item ng-if=node.data.value.related><md-button ng-click="nodeMenuCtrl.close(); treeCtrl.removeRelated(node.data.key)" ga-track-event="[\'node\', \'remove\', \'menuButton\']" aria-label=Remove><md-icon md-svg-icon=remove></md-icon>Remove</md-button></md-menu-item><md-menu-item ng-show="!(node.data.value.related || node.isLeaf || nodeMenuCtrl.isListed)"><md-button ng-click="nodeMenuCtrl.close(); treeCtrl.execute(\'deleteBranch\', node.data.key)" ng-disabled="!nodeMenuCtrl.editable\n                       || nodeMenuCtrl.isRoot()\n                       || nodeMenuCtrl.isFocused()" ga-track-event="[\'node\', \'removeAll\']" aria-label="Remove all"><md-icon md-svg-icon=remove-all></md-icon>Remove All</md-button></md-menu-item><md-menu-item><md-button ng-click="nodeMenuCtrl.close(); nodeMenuCtrl.nodeCtrl.showReportDialog($event)" aria-label=Report ga-track-event="[\'node\', \'report\']" ng-disabled=nodeMenuCtrl.nodeCtrl.reportDisabled><md-icon md-svg-icon=report></md-icon>Report</md-button></md-menu-item></md-menu-content>'),e.put("partials/shared/tree-node-tools.html",'<div class=node__tools-container><md-button class="md-icon-button node__menu-button" ng-click="$event.preventDefault(); $event.stopPropagation(); treeCtrl.execute(\'deleteOne\', node.data.key)" ga-track-event="[\'node\', \'remove\', \'nodeButton\']" ng-if=node.isDeleteOne aria-label=Remove><md-icon class=node__menu-button-icon md-svg-icon=remove></md-icon></md-button><md-button class="md-icon-button node__menu-button" ng-click="$event.preventDefault(); $event.stopPropagation(); treeCtrl.execute(\'deleteBranch\', node.data.key)" ga-track-event="[\'node\', \'remove\', \'nodeButton\']" ng-if=node.isDeleteBranch aria-label=Remove><md-icon class=node__menu-button-icon md-svg-icon=remove></md-icon></md-button><md-button class="md-icon-button node__menu-button" ng-click="$event.preventDefault(); $event.stopPropagation(); treeCtrl.execute(\'deleteRoot\', node.data.key)" ga-track-event="[\'node\', \'remove\', \'nodeButton\']" ng-if=node.isDeleteRoot aria-label=Remove><md-icon class=node__menu-button-icon md-svg-icon=remove></md-icon></md-button><md-button class="md-icon-button node__menu-button" ng-click="$event.preventDefault(); $event.stopPropagation(); treeCtrl.removeRelated(node.data.key)" ga-track-event="[\'node\', \'remove\', \'nodeButton\']" ng-if=node.data.value.related aria-label=Remove><md-icon class=node__menu-button-icon md-svg-icon=remove></md-icon></md-button></div><div ng-show=!treeCtrl.treeNodesCtrl.isExpanded><div class=node__more-button-container ng-show="nodeMenuCtrl.nodeCtrl.showExpand || nodeMenuCtrl.nodeCtrl.showCollapse"><md-button class="node__more-button node__more-button-expand" ng-click="$event.preventDefault(); $event.stopPropagation(); nodeMenuCtrl.nodeCtrl.setChildren(true)" ng-show=nodeMenuCtrl.nodeCtrl.showExpand ga-track-event="[\'node\', \'expand\']" aria-label=More md-no-ink><md-icon class=node__more-button__icon md-svg-icon=arrow-right></md-icon></md-button><md-button class="node__more-button node__more-button-collapse" ng-click="$event.preventDefault(); $event.stopPropagation(); nodeMenuCtrl.nodeCtrl.setChildren()" ng-show=nodeMenuCtrl.nodeCtrl.showCollapse ga-track-event="[\'node\', \'collapse\']" aria-label=More md-no-ink><md-icon class=node__more-button__icon md-svg-icon=arrow-left></md-icon></md-button></div><div class=node__prev-button-container><md-button class=node__nav-button ng-click="$event.preventDefault(); $event.stopPropagation(); nodeMenuCtrl.nodeCtrl.showPrev()" ng-show="nodeMenuCtrl.nodeCtrl.showNav && !nodeMenuCtrl.nodeCtrl.disablePrev" ga-track-event="[\'node\', \'prev\']" md-no-ink><md-icon md-svg-icon=arrow-up class="node__nav-button__next-icon node__nav-button__prev-icon-hide"></md-icon><md-icon md-svg-icon=arrow-up class="node__nav-button__next-icon node__nav-button__prev-icon-hide"></md-icon><md-icon md-svg-icon=arrow-up></md-icon></md-button></div><div class=node__next-button-container><md-button class=node__nav-button ng-click="$event.preventDefault(); $event.stopPropagation(); nodeMenuCtrl.nodeCtrl.showNext()" ng-show="nodeMenuCtrl.nodeCtrl.showNav && !nodeMenuCtrl.nodeCtrl.disableNext" ga-track-event="[\'node\', \'next\']" md-no-ink><md-icon md-svg-icon=arrow-down class="node__nav-button__next-icon node__nav-button__next-icon-hide"></md-icon><md-icon md-svg-icon=arrow-down class="node__nav-button__next-icon node__nav-button__next-icon-hide"></md-icon><md-icon md-svg-icon=arrow-down class=node__nav-button__next-icon></md-icon></md-button></div></div>'),e.put("partials/shared/tree-share-menu.html","<md-menu-content><tn-share-menu share-url=treeCtrl.shareUrl() url={{::treeCtrl.shortUrl}} close=treeShareMenuCtrl.close() publish=treeCtrl.publish() preview=treeCtrl.getPreview() container=treeCtrl.getNodesPreview() category=tree></tn-share-menu><md-menu-item ng-show=treeCtrl.hasYoutubeVideos><md-button title=\"Create a playlist\" ng-click=\"treeShareMenuCtrl.close(); treeCtrl.shareYoutube()\" ga-track-event=\"['tree', 'share', 'youtube']\" aria-label=\"Create playlist\"><md-icon md-svg-icon=youtube></md-icon>Youtube</md-button></md-menu-item><md-menu-item><md-button ng-click=treeShareMenuCtrl.close() ng-attr-data-clipboard-text=\"{{ ::treeCtrl.embedCode }}\" ga-track-event=\"['tree', 'share', 'embed']\" tn-clipboard><md-icon md-svg-icon=embed></md-icon>Embed</md-button></md-menu-item></md-menu-content>"),e.put("partials/shared/tree-sort-menu.html","<md-menu-content><md-subheader class=md-no-sticky>Sort by</md-subheader><md-menu-item><md-button ng-click=\"treeSortMenuCtrl.close(); treeCtrl.updateSort('timestamp'); treeCtrl.update()\" ga-track-event=\"['tree', 'sort', 'added']\"><md-icon md-svg-icon=check ng-style=\"{visibility: (treeCtrl.treeNodesCtrl.sortBy == 'timestamp') ? 'visible' : 'hidden'}\"></md-icon>Added</md-button></md-menu-item><md-menu-item><md-button ng-click=\"treeSortMenuCtrl.close(); treeCtrl.updateSort('visited'); treeCtrl.update()\" ng-disabled=\"::!(isExtension || isPage)\" ga-track-event=\"['tree', 'sort', 'visited']\"><md-icon md-svg-icon=check ng-style=\"{visibility: (treeCtrl.treeNodesCtrl.sortBy == 'visited') ? 'visible' : 'hidden'}\"></md-icon>Visited</md-button></md-menu-item><md-menu-item><md-button ng-click=\"treeSortMenuCtrl.close(); treeCtrl.updateSort('title'); treeCtrl.update()\" ga-track-event=\"['tree', 'sort', 'title']\"><md-icon md-svg-icon=check ng-style=\"{visibility: (treeCtrl.treeNodesCtrl.sortBy == 'title') ? 'visible' : 'hidden'}\"></md-icon>Title</md-button></md-menu-item><md-subheader class=md-no-sticky>Sort order</md-subheader><md-menu-item><md-button ng-click=\"treeSortMenuCtrl.close(); treeCtrl.treeNodesCtrl.sortOrder = !treeCtrl.treeNodesCtrl.sortOrder; treeCtrl.updateSort(); treeCtrl.update()\" ga-track-event=\"['tree', 'sort', 'order']\"><md-icon md-svg-icon=sort-ascending ng-hide=treeCtrl.treeNodesCtrl.sortOrder></md-icon><md-icon md-svg-icon=sort-descending ng-show=treeCtrl.treeNodesCtrl.sortOrder></md-icon>{{ (!treeCtrl.treeNodesCtrl.sortOrder) ? 'Ascending' : 'Descending' }}</md-button></md-menu-item></md-menu-content>"),e.put("partials/shared/tree.html",'<div class=tree-toolbar-outer><div class=tree-toolbar ng-click=treeMetaCtrl.closePreview() ga-track-event="[\'tree\', \'close\']"><div class=tree-avatar-container><img class=tree-avatar__image ng-src="{{ tree.value.meta.image || placeholderImage}}" ng-attr-alt="{{ ::tree.value.meta.title }}" tn-image-error></div><div class=tree-toolbar__search-container><div class=tree-toolbar__search ng-click=$event.stopPropagation() md-colors="::{backgroundColor: \'background-300\'}" layout=row layout-align="start center"><div class=tree-list-search><md-input-container md-no-float><md-icon md-svg-icon=search></md-icon><input type=search placeholder=Search ng-model=treeCtrl.searchText ng-model-options="::{ debounce: 500 }" ng-change=treeCtrl.search()></md-input-container></div><div><tn-tree-sort-menu><md-button class=md-icon-button ng-click="$event.stopPropagation(); treeSortMenuCtrl.open($event)" ga-track-event="[\'tree\', \'sortButton\']" aria-label="Tree sort"><md-tooltip>Sort</md-tooltip><md-icon md-svg-icon=sort></md-icon></md-button></tn-tree-sort-menu></div><div class=tree-legend__user-container ng-click=toggleUser(tree.value.meta.user) ng-if=tree.value.meta.user ga-track-event="[\'tree\', \'user\']" layout=row><div class=tree-legend__user-avatar-container><img class=tree-legend__user-avatar ng-src="{{ tree.value.meta.user.picture.data.url }}" ng-attr-alt="{{ tree.value.meta.user.name }}"></div><div class=tree-legend__user-title>{{ tree.value.meta.user.name }}</div></div></div></div><div class=tree-toolbar__container><div class=tree-toolbar__container-inner><h4 class=tree-toolbar__title>{{ tree.value.meta.title }}</h4><tn-like url="{{ ::treeCtrl.treeUrl }}" ng-if="!treeCtrl.editable || tree.value.meta.published"></tn-like><tn-tree-share-menu ng-show=treeCtrl.canShare()><md-button class="md-icon-button tree-toolbar_button tree-toolbar__share" title=Share ng-click="$event.stopPropagation(); treeShareMenuCtrl.open($event)" ga-track-event="[\'tree\', \'shareMenu\']" aria-label=Share><md-icon md-svg-icon=share></md-icon></md-button></tn-tree-share-menu></div></div><div class=tree-toolbar__tools ng-click="$event.stopPropagation(); treeMetaCtrl.closePreview()"><div class=tree-toolbar__tools-inner><tn-tree-menu><md-button class="md-icon-button tree-toolbar_button tree-toolbar__menu" title=Menu ng-click="$event.stopPropagation(); treeMenuCtrl.open($event)" ga-track-event="[\'tree\', \'menu\']" aria-label="Open menu"><md-icon md-svg-icon=dots></md-icon></md-button></tn-tree-menu><div><md-button class="md-icon-button tree-toolbar_button tree-toolbar__info" title=Info ng-click="$event.stopPropagation(); treeCtrl.openTreeDialog($event)" ga-track-event="[\'tree\', \'info\', \'opened\']" aria-label=Info><md-icon md-svg-icon="{{treeCtrl.editable && !treeCtrl.limitedEdit ? \'edit\' : \'info\'}}"></md-icon></md-button></div><div class=add ng-show="::!treeCtrl.editable || treeCtrl.limitedEdit"><md-button class=md-icon-button title=Add ng-click="$event.stopPropagation(); treeCtrl.add()" ng-disabled=tree.value.meta.isReposted ga-track-event="[\'tree\', \'add\']" aria-label=Add><md-icon md-svg-icon=add></md-icon></md-button></div><div><md-button class="md-icon-button tree__pin-icon-button tree-toolbar_button" ng-class="{\'md-accent\': tree.value.meta.pinned}" title=Pin aria-label="Pin tree" ng-click="$event.stopPropagation(); pinning.togglePin(treeCtrl.key)" ng-disabled="pinning.disabled && !tree.value.meta.pinned" ga-track-event="[\'tree\', \'pin\', \'opened\']"><md-icon md-svg-icon=pin></md-icon></md-button></div><div class=fav ng-if="::treeCtrl.editable && !treeCtrl.limitedEdit"><md-button class=md-icon-button title=Favorite aria-label=Favorite ng-click="$event.stopPropagation(); treeCtrl.toggleFavorite()" ng-class="{ \'md-accent\': tree.value.meta.favorite }" ga-track-event="[\'tree\', \'favorite\']"><md-icon md-svg-icon=favorite></md-icon></md-button></div><md-button class="md-icon-button pub" title=Publish ng-if="treeCtrl.editable && !treeCtrl.limitedEdit" aria-label=Publish ng-click="$event.stopPropagation(); treeCtrl.togglePublished()" ng-class="{ \'md-accent\': tree.value.meta.published }" ga-track-event="[\'tree\', \'publish\']"><md-icon md-svg-icon=public></md-icon></md-button><div class=list><md-button class=md-icon-button title=Expand ng-class="{ \'md-accent\': treeCtrl.treeNodesCtrl.isExpanded}" ng-click="$event.stopPropagation(); treeCtrl.updateExpandedView()" ng-disabled="treeCtrl.expandTreeDisabled || treeCtrl.treeNodesCtrl.isListed" ga-track-event="[\'tree\', \'expand\']"><md-icon md-svg-icon=fullscreen></md-icon></md-button><md-button class=md-icon-button title=List aria-label=List ng-class="{ \'md-accent\': treeCtrl.treeNodesCtrl.isListed }" ng-click="$event.stopPropagation(); treeCtrl.updateView(true)" ga-track-event="[\'tree\', \'list\']"><md-icon md-svg-icon=list></md-icon></md-button></div><div ng-hide=::!treeCtrl.editable><md-button class="md-icon-button undo" title=Undo ng-click="$event.stopPropagation(); treeCtrl.undo()" ng-disabled="tree.value.stack.pointer == 0" ga-track-event="[\'tree\', \'undo\']" aria-label=Undo><md-icon md-svg-icon=undo></md-icon></md-button><div class=redo><md-button class="md-icon-button redo" title=Redo ng-click="$event.stopPropagation(); treeCtrl.redo()" ng-disabled="tree.value.stack.pointer == tree.value.stack.length" ga-track-event="[\'tree\', \'redo\']" aria-label=Redo><md-icon md-svg-icon=redo></md-icon></md-button></div></div><md-button class="md-icon-button zoomin" title="Zoom in" ng-click="$event.stopPropagation(); treeCtrl.zoom(true)" ng-disabled="treeCtrl.treeNodesCtrl.isListed || treeCtrl.disableZoomIn" ga-track-event="[\'tree\', \'zoom-in\']" aria-label="Zoom in"><md-icon md-svg-icon=zoom-in></md-icon></md-button><div class=zoomout><md-button class="md-icon-button zoomout" title="Zoom out" ng-disabled="treeCtrl.treeNodesCtrl.isListed || treeCtrl.disableZoomOut" ng-click="$event.stopPropagation(); treeCtrl.zoom()" ga-track-event="[\'tree\', \'zoom-out\']" aria-label="Zoom out"><md-icon md-svg-icon=zoom-out></md-icon></md-button></div><md-button class="md-icon-button md-warn tree-toolbar__delete" aria-label="Delete tree" title="Delete tree" ng-click="$event.stopPropagation(); treeCtrl.deleteTreeDialog($event)" ng-if="::treeCtrl.editable && !treeCtrl.limitedEdit" ga-track-event="[\'tree\', \'delete\', \'opened\']"><md-icon md-svg-icon=delete></md-icon></md-button><div class=tree-page-close title=Close><img ng-click=closePageTree() src=/img/close-black.png></div></div></div></div></div><md-content class=tree-path ng-show=treeCtrl.treePath.length md-colors="::{backgroundColor: \'background-100\'}"><md-list class=md-dense flex layout=row layout-align="start center" layout-wrap><tn-node-path ng-repeat="node in treeCtrl.treePath track by node.data.key" flex=50 node=node last=$last open-url=treeCtrl.clickPath(node)></tn-node-path></md-list></md-content><md-content class=tree-body ng-class="{\'tree-body--vertical-layout\': treeCtrl.treeNodesCtrl.vertical}" style="height: 0"><div class=tree-nodes tabindex=0><div class="tree-nodes-inner is-animated" ng-hide="treeCtrl.treeNodesCtrl.isListed || !treeCtrl.nodes.length"><svg class=tree-svg width=100% height=100%><g class="link is-animated" ng-repeat="link in treeCtrl.links track by link.target.data.key" tn-link></g></svg><tn-node class="tree-node is-animated" ng-repeat="node in treeCtrl.nodes track by node.data.key" node=node open-url=treeCtrl.openUrl(key) container=treeCtrl.getNodesPreview() container-preview=treeCtrl.getPreview() tn-tree-item tn-tree-item-shared><node-menu tn-tree-node-menu><md-button class="md-icon-button node__menu-button" ng-click="$event.preventDefault(); $event.stopPropagation(); nodeMenuCtrl.open($event)" ga-track-event="[\'node\', \'menu\', \'treeView\']" md-no-ink aria-label="Open menu"><md-icon class=node__menu-button-icon md-svg-icon=dots-white-small></md-icon></md-button></node-menu><node-share tn-share-node-menu><md-button class="md-icon-button node__menu-button" ng-click="$event.preventDefault(); $event.stopPropagation(); nodeMenuCtrl.open($event)" ga-track-event="[\'node\', \'shareMenu\', \'treeView\']" md-no-ink aria-label="Open menu"><md-icon class=node__menu-button-icon md-svg-icon=share></md-icon></md-button></node-share><node-tools tn-tree-node-tools></node-tools><node-main tn-node-main-action></node-main></tn-node></div><md-list ng-show=treeCtrl.treeNodesCtrl.isListed><tn-node-listed class=is-animated ng-repeat="node in treeCtrl.listedNodes track by node.data.key" node=node open-url=treeCtrl.openUrl(key) container=treeCtrl.getNodesPreview() container-preview=treeCtrl.getPreview() tn-list-item tn-tree-item-shared><div tn-tree-node-menu include-share=true><md-button class="md-icon-button node__menu-button" ng-click="$event.preventDefault(); $event.stopPropagation(); nodeMenuCtrl.open($event)" ga-track-event="[\'node\', \'menu\', \'treeListView\']" md-no-ink aria-label="Open menu"><md-icon class=node__menu-button-icon md-svg-icon=dots></md-icon></md-button></div></tn-node-listed></md-list></div></md-content>'),e.put("partials/shared/user-images-dialog.html",'<md-dialog class=images-dialog id=user-images-dialog><md-dialog-content><md-toolbar><div class=md-toolbar-tools><h2 class=md-display-1><span>{{ userImagesDialog.title }}</span></h2><div flex></div><div><md-button class=md-icon-button ga-track-event="[\'userImagesDialog\', \'close\']" ng-click=$root.$mdDialog.cancel()><md-icon md-svg-icon=close></md-icon></md-button></div></div></md-toolbar><div layout=column flex><md-content ng-hide=!!userImagesDialog.images.length flex><div class=dialog-status-component ng-show=userImagesDialog.loading layout=column layout-align="center center"><md-progress-circular md-mode=indeterminate></md-progress-circular></div><div class="md-body-1 dialog-status-component" ng-show=userImagesDialog.noResults layout=column layout-align="center center">No Results</div></md-content><md-content id=dialog-container ng-show=!!userImagesDialog.images.length flex><div class=bricklayer><div class=tree-image-container bricklayer-append ng-repeat="image in userImagesDialog.images track by image.link"><img class=tree-image ng-src="{{ ::image.link }}" tn-image-error><div class=tree-image-caption ng-if=::image.name md-colors="::{backgroundColor: \'primary-500\'}">{{ ::image.name }}</div></div></div></md-content></div></md-dialog-content></md-dialog>'),e.put("partials/shared/youtube-dialog.html","<md-dialog id=youtube-dialog aria-label=Edit><md-dialog-content><div id=autoplay-youtube-dialog><md-switch ng-model=youtubeIFrameDialogCtrl.autoplay ng-change=youtubeIFrameDialogCtrl.autoplayChange() md-invert>autoplay</md-switch></div><div id=close-youtube-dialog><md-button class=md-icon-button ng-click=$root.$mdDialog.cancel() ga-track-event=\"['youtube', 'close']\"><md-icon md-svg-icon=close></md-icon></md-button></div><iframe id=ytplayer width=560 height=315 frameborder=0 allowfullscreen></iframe></md-dialog-content></md-dialog>"),e.put("partials/shared/youtube-tree-dialog.html","<md-dialog id=youtube-tree-dialog><md-dialog-content><md-content><div id=youtube-tree-dialog-close-button><md-button class=md-icon-button ng-click=$root.$mdDialog.cancel() ga-track-event=\"['youtubeTreeDialog', 'close']\"><md-icon md-svg-icon=close></md-icon></md-button></div><div id=youtube-tree-dialog-complete ng-show=youtubeTreeDialog.complete><md-button href={{youtubeTreeDialog.playlistUrl}} target=_blank ga-track-event=\"['youtubeTreeDialog', 'openPlaylistUrl']\"><md-icon md-svg-icon=youtube></md-icon>Go to playlist</md-button><md-button ng-attr-data-clipboard-text={{youtubeTreeDialog.playlistUrl}} tn-clipboard ga-track-event=\"['youtubeTreeDialog', 'copyPlaylistUrl']\"><md-icon md-svg-icon=clipboard></md-icon>Copy Url</md-button></div><div id=youtube-tree-dialog-progress ng-hide=youtubeTreeDialog.complete><div>Processing...</div><md-progress-circular></md-progress-circular></div></md-content></md-dialog-content></md-dialog>")}])},function(e,t,n){e.exports=n(1)(33)},function(e,t,n){e.exports=n(1)(11)},function(e,t,n){e.exports=n(1)(17)},function(e,t,n){e.exports=n(1)(18)},function(e,t,n){e.exports=n(1)(25)},function(e,t,n){e.exports=n(1)(44)},function(e,t,n){e.exports=n(1)(46)},function(e,t,n){e.exports=n(1)(48)},function(e,t,n){e.exports=n(1)(53)},function(e,t,n){e.exports=n(1)(54)},function(e,t,n){e.exports=n(1)(52)},function(e,t,n){e.exports=n(1)(55)}]);